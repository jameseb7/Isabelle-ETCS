%
\begin{isabellebody}%
\setisabellecontext{Exponential{\isacharunderscore}{\kern0pt}Objects}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Exponential Objects, Transposes and Evaluation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Exponential{\isacharunderscore}{\kern0pt}Objects\isanewline
\ \ \isakeyword{imports}\ Initial\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
The axiomatization below corresponds to Axiom 9 (Exponential Objects) in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{axiomatization}\isamarkupfalse%
\isanewline
\ \ exp{\isacharunderscore}{\kern0pt}set\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsup {\isacharunderscore}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{and}\isanewline
\ \ eval{\isacharunderscore}{\kern0pt}func\ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isakeyword{where}\isanewline
\ \ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\isactrlbsup A\isactrlesup \ {\isacharequal}{\kern0pt}\ Y\isactrlbsup B\isactrlesup \ {\isasymLongrightarrow}\ X\ {\isacharequal}{\kern0pt}\ Y\ {\isasymand}\ A\ {\isacharequal}{\kern0pt}\ B{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub c\ X\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub cZ\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ g{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymLongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}surj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ codomain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ a\ \isakeyword{where}\ a{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ nonempty{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ needed{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isasymrangle}\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ a{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ comp{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}y{\isachardot}{\kern0pt}\ y\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymand}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ y\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ needed{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to a note above Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}injective{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Lifting Functions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlbsup {\isacharunderscore}{\kern0pt}\isactrlesup \isactrlsub f{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}func\ g\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}func\ g\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharcolon}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to a note below Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}square{\isacharunderscore}{\kern0pt}diagram{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.2 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y\ {\isasymand}\ g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\ \ {\isasymLongrightarrow}\ \ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ right{\isacharunderscore}{\kern0pt}eq\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharequal}{\kern0pt}\ id\isactrlsub c{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to comments below Proposition 2.5.2 and above Definition 2.5.3 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}x{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isacharcomma}{\kern0pt}x{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{1}}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}type\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Inverse Transpose Function (flat)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.3 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlsup {\isasymflat}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ g{\isachardot}{\kern0pt}\ {\isasymexists}\ Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}Z\ Y\ B{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ Y\isactrlbsup B\isactrlesup \ {\isasymand}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ f{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.4 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.5 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.6 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}\ g{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ {\isasymlongrightarrow}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ f{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ uniqueness\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ f\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X{\isacharequal}{\kern0pt}X{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A{\isacharequal}{\kern0pt}A{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}epimorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ equals{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}surj\ epi{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}surj\ id{\isacharunderscore}{\kern0pt}isomorphism\ id{\isacharunderscore}{\kern0pt}type\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}surj\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}codomain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ domain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ composition{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epi\ equals\ eval{\isacharunderscore}{\kern0pt}epi\ idA{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}epi{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}injective\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}injective{\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mono{\isacharunderscore}{\kern0pt}g{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}monomorphism\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ CollectI\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ \ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ \ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ x{\isacharunderscore}{\kern0pt}type\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ presburger\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ assms\ eqs\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ force\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ eqs\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ flat{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ mono{\isacharunderscore}{\kern0pt}g\ flat{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}injective{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isasymexists}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlesub {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ x\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlesub {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ evals{\isacharunderscore}{\kern0pt}equal{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ a\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\isactrlbsup {\isasymone}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ A\ \isakeyword{where}\ a{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymand}\ a\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ A{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ a{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ eval{\isacharunderscore}{\kern0pt}dom\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ B\ \isakeyword{where}\ b{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymand}\ b\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ B{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ b{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ eval{\isacharunderscore}{\kern0pt}dom\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}\ {\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}A\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ evals{\isacharunderscore}{\kern0pt}equal{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}B\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ b{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ swap{\isacharunderscore}{\kern0pt}def\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ diagonal{\isacharunderscore}{\kern0pt}def\ diagonal{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ swap{\isacharunderscore}{\kern0pt}idempotent\ swap{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ injective{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
In the lemma below, the nonempty assumption is required.
      Consider, for example, \isa{X\ {\isacharequal}{\kern0pt}\ {\isasymOmega}} and \isa{A\ {\isacharequal}{\kern0pt}\ {\isasymemptyset}}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ \ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\ h\ U\ Y\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ equals{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Y\ {\isacharequal}{\kern0pt}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}XA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ g{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ h{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idg{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ U\ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idh{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ U\ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ epic{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ nonempty{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \isacommand{have}\isamarkupfalse%
\ fIdg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fIdh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ equals\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\ \ \ \isanewline
\ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ idg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}idh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ fIdg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fIdh\ idg{\isacharunderscore}{\kern0pt}type\ idh{\isacharunderscore}{\kern0pt}type\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ epic\ epimorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Metafunctions and their Inverses (Cnufatems)%
}
\isamarkuptrue%
%
\isamarkupsubsubsection{Metafunctions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ metafunc\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}metafunc\ f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ \ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Inverse Metafunctions (Cnufatems)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ cnufatem\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}cnufatem\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ g{\isachardot}{\kern0pt}\ {\isasymforall}\ Y\ X{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ theI{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isacharcolon}{\kern0pt}\ X\ \ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}metafunc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ \ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}lemma\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ X{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isasymin}\isactrlsub c\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}lemma\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X\ {\isasymcirc}\isactrlsub c\ x\ {\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymbeta}\isactrlbsub X\isactrlesub \ {\isasymcirc}\isactrlsub c\ x{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}elem{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X\ {\isasymcirc}\isactrlsub c\ x\ {\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}elem\ x{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Metafunction Composition%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymbox}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ f\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ h{\isachardot}{\kern0pt}\ {\isasymexists}\ W\ X\ Y{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup \ {\isasymand}\ h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ the{\isacharunderscore}{\kern0pt}equality{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}elements{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharequal}{\kern0pt}\ \ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharequal}{\kern0pt}\ metafunc\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}cnufatem\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Z{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ \ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ id{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}elements{\isacharunderscore}{\kern0pt}aux\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\ \ \ \ \ \ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}type\ domain{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{4}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ \ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ \ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ \ {\isasymtimes}\isactrlsub f\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ \ {\isasymin}\isactrlsub c\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ id{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\ {\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ \ f\ {\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}{\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}{\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}{\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}\ x\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}{\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}\ x\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ x{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\isanewline
\ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ \ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ sharp{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}type\ domain{\isacharunderscore}{\kern0pt}comp\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}els{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}w\ {\isasymin}\isactrlsub c\ W{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ \ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isanewline
\ \ \ \ \ \ \ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub cw{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub cw{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{5}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ \ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ W{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ w\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\isactrlsub c\ W{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ w{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ w{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}els{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ X\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isasymbox}\ metafunc\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ cnufatem{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ X\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc{\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isasymbox}\ g\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ cnufatem{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}metacomp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ cnufatem{\isacharparenleft}{\kern0pt}metafunc\ f\ {\isasymbox}\ metafunc\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metacomp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isasymcirc}\isactrlsub c\ cnufatem\ g\ {\isacharequal}{\kern0pt}\ cnufatem{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}metacomp\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ A\isactrlbsup Z\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymbox}\ f{\isacharparenright}{\kern0pt}\ {\isasymbox}\ \ g\ \ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymbox}\ f{\isacharparenright}{\kern0pt}\ {\isasymbox}\ \ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymbox}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\ \ \ \ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}\ {\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Partially Parameterized Functions on Pairs%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}param\ k\ p\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}THE\ f{\isachardot}{\kern0pt}\ \ {\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ f\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ left{\isacharunderscore}{\kern0pt}param\ k\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ the{\isadigit{1}}I{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ assms{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isacharcolon}{\kern0pt}\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}el{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}right\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}param\ k\ q\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}THE\ f{\isachardot}{\kern0pt}\ \ {\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ f\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}param\ k\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ insert\ assms{\isacharcomma}{\kern0pt}\ auto{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ P{\isacharcomma}{\kern0pt}q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isacharcolon}{\kern0pt}\ P\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}el{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ p{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Exponential Set Facts%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.7 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}defn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ e{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ i{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}inv\ \isakeyword{where}\ i{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharunderscore}{\kern0pt}inv{\isacharcolon}{\kern0pt}\ {\isasymone}{\isasymrightarrow}\ \ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymand}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i{\isacharunderscore}{\kern0pt}inv\ {\isasymcirc}\isactrlsub c\ i\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}diagonal\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ diagonal{\isacharunderscore}{\kern0pt}def\ i{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharunderscore}{\kern0pt}inv{\isacharcolon}{\kern0pt}\ {\isasymone}{\isasymrightarrow}\ \ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ inj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}injective{\isacharparenleft}{\kern0pt}e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ e{\isacharunderscore}{\kern0pt}defn\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}injective{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ surj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ codomain\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ e{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ witness{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv\ {\isasymin}\isactrlsub c\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ square{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ y\ {\isasymcirc}\isactrlsub c\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}defn\ i{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ y{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ domain\ e\ {\isasymand}\ e\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}type\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ i{\isacharunderscore}{\kern0pt}iso\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ inj\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism\ surj\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ one{\isacharunderscore}{\kern0pt}x{\isacharunderscore}{\kern0pt}A{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.8 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isasymalpha}\isactrlbsub X\isactrlesub {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymemptyset}\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}z{\isachardot}{\kern0pt}\ z\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymlongrightarrow}\ z{\isacharequal}{\kern0pt}f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ z{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ j{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}j{\isacharcolon}{\kern0pt}{\isasymemptyset}\ {\isasymrightarrow}\ {\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ empty{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}X\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ psi{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharcolon}{\kern0pt}\ {\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ {\isasymemptyset}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ j\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ j{\isacharunderscore}{\kern0pt}iso\ \isacommand{by}\isamarkupfalse%
\ fastforce\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ z\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}type\ emptyset{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ fsharp{\isacharunderscore}{\kern0pt}type\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ z{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}{\kern0pt}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ ex{\isadigit{1}}I{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymone}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ nonempty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}{\isasymone}\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ nonempty{\isacharunderscore}{\kern0pt}def\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}defn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ {\isasymone}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ e{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isasymin}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ \ {\isasymrightarrow}\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniquess{\isacharunderscore}{\kern0pt}form{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isasymin}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymbeta}\isactrlbsub X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlesub {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique\ uniqueness\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ ex{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}{\isacharbang}{\kern0pt}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ e{\isacharunderscore}{\kern0pt}defn\ nonempty\ nonempty{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique\ uniqueness{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymone}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ex{\isadigit{1}}\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.9 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}rule{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymcong}\ X\isactrlbsup A\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ Z\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymand}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ safe{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ projection{\isacharunderscore}{\kern0pt}property{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ projection{\isacharunderscore}{\kern0pt}property{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ f\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ g\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ h\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ computation{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ unqiueness{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ \ f\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ computation{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}g\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isacartoucheclose}\ {\isacartoucheopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ unqiueness{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ \ g\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ computation{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}flat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ g\isactrlsup {\isasymflat}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ unqiueness{\isadigit{1}}\ unqiueness{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}fflat{\isacharunderscore}{\kern0pt}gflat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}\ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymcong}\ X\isactrlbsup A\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ cart{\isacharunderscore}{\kern0pt}prods{\isacharunderscore}{\kern0pt}isomorphic\ fst{\isacharunderscore}{\kern0pt}conv\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}distribution{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymcong}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ H\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ safe{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ h\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Z{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}xyh{\isachardot}{\kern0pt}\ xyh\ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ xyh\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ l{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xyh\ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ xy\ \isakeyword{and}\ z\ \isakeyword{where}\ xy{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isasymin}\isactrlsub c\ X\ {\isasymCoprod}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ z{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\isactrlsub c\ H{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isakeyword{and}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xyh\ {\isacharequal}{\kern0pt}\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ \ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ xy{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isacharequal}{\kern0pt}\ \ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharunderscore}{\kern0pt}left\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ \ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isacharcomma}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ xy{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isacharequal}{\kern0pt}\ \ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ coprojs{\isacharunderscore}{\kern0pt}jointly{\isacharunderscore}{\kern0pt}surj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharunderscore}{\kern0pt}right\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ \ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}eqs\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isacharcomma}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymamalg}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs\ g{\isacharunderscore}{\kern0pt}eqs\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ cart{\isacharunderscore}{\kern0pt}prods{\isacharunderscore}{\kern0pt}isomorphic\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ prod{\isachardot}{\kern0pt}sel{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ j{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}j{\isacharcolon}{\kern0pt}\ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymone}{\isasymtimes}\isactrlsub c\ {\isasymemptyset}\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\ j{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ one{\isacharunderscore}{\kern0pt}x{\isacharunderscore}{\kern0pt}A{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ nonempty{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e{\isacharcolon}{\kern0pt}\ X{\isasymtimes}\isactrlsub c\ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ iso{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymcirc}\isactrlsub c\ y\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ j\ {\isacharcolon}{\kern0pt}\ \ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}A\isactrlbsup Y\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ A\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}{\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ X\isactrlbsup Y\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ A\isactrlbsup Y\isactrlesup \ {\isasymrightarrow}\ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idXY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idAY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\ A{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ idA{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ \ {\isachardoublequoteopen}A\isactrlbsup Y\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ idAY\ idXY\ id{\isacharunderscore}{\kern0pt}isomorphism\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ expset{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}tower{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup \ {\isasymcong}\ A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ B\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}dbsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasympsi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharcolon}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasympsi}sharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup \ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}C{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}B{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ \ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacartoucheopen}{\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacartoucheclose}\ {\isacartoucheopen}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacartoucheclose}\ {\isasymphi}dbsharp{\isacharunderscore}{\kern0pt}type\ {\isasympsi}sharp{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup A\isactrlesup \ {\isasymcong}\ \ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ A\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}{\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ g\ \isakeyword{where}\ g{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ \ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ X{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ gsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}gsharp{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ A{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ f{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ g{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ idA\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ gsharp{\isacharunderscore}{\kern0pt}fsharp{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ X{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ fsharp{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ fsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ fsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ fsharp{\isacharunderscore}{\kern0pt}gsharp{\isacharunderscore}{\kern0pt}id\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}fsharp{\isacharunderscore}{\kern0pt}id\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}isomorphism\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}B\ {\isasymcong}\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}A\isactrlbsup B\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ empty{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}nonempty{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ exp{\isacharunderscore}{\kern0pt}empty\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nonempty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}nonempty\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ nonempty{\isacharunderscore}{\kern0pt}def\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharunderscore}{\kern0pt}converse{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y\ {\isasymand}\ nonempty\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ assms\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ nonempty{\isacharunderscore}{\kern0pt}def\ nonempty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.11 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ powerset\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymP}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}{\isasymP}\ X\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sets{\isacharunderscore}{\kern0pt}squared{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}A\isactrlbsup {\isasymOmega}\isactrlesup \ {\isasymcong}\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharcolon}{\kern0pt}\ A\isactrlbsup {\isasymOmega}\isactrlesup \ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isasymphi}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ {\isasymone}\ {\isasymLongrightarrow}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ A{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isasymOmega}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isakeyword{where}\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isasymand}\ a{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\ {\isasymand}\ a{\isadigit{2}}\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ eqs\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ g{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ g{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ g\ {\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{1}}\ equation{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ \ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ w\ i\ \isakeyword{where}\ \ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}w\ {\isasymin}\isactrlsub c\ {\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}i\ {\isasymin}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}w{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}w\ {\isacharequal}{\kern0pt}\ {\isasymf}{\isacharparenright}{\kern0pt}\ {\isasymor}\ {\isacharparenleft}{\kern0pt}w\ {\isacharequal}{\kern0pt}\ {\isasymt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ true{\isacharunderscore}{\kern0pt}false{\isacharunderscore}{\kern0pt}only{\isacharunderscore}{\kern0pt}truth{\isacharunderscore}{\kern0pt}values\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymor}\ {\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ case{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{1}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymf}{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ false{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymf}{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{1}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ case{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}eq\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymt}{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ true{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymt}{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}eq\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ codomain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isasymand}\ a{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\ {\isasymand}\ a{\isadigit{2}}\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ aua{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymCoprod}\ {\isasymone}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ aua\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ a{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ true{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ aua\ f{\isacharunderscore}{\kern0pt}def\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ {\isasymt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}type\ aua\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ {\isasymone}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}true{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ a{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ false{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymf}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ aua\ f{\isacharunderscore}{\kern0pt}def\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ {\isasymf}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ aua\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ {\isasymone}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}false{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ \ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ a{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}is\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}\ {\isasymand}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}monomorphism\ {\isasymphi}{\isacartoucheclose}\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/ETCS/Category_Set/Exponential_Objects.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%39=7%:%
%:%41=8%:%
%:%42=8%:%
%:%43=9%:%
%:%44=10%:%
%:%45=11%:%
%:%46=12%:%
%:%47=13%:%
%:%48=14%:%
%:%49=15%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=19%:%
%:%54=20%:%
%:%55=20%:%
%:%56=21%:%
%:%57=22%:%
%:%60=23%:%
%:%64=23%:%
%:%65=23%:%
%:%66=24%:%
%:%67=24%:%
%:%68=25%:%
%:%69=25%:%
%:%70=26%:%
%:%71=26%:%
%:%72=27%:%
%:%73=27%:%
%:%74=27%:%
%:%75=28%:%
%:%76=28%:%
%:%77=28%:%
%:%78=29%:%
%:%79=29%:%
%:%80=30%:%
%:%81=30%:%
%:%82=30%:%
%:%83=31%:%
%:%84=31%:%
%:%85=32%:%
%:%86=32%:%
%:%87=32%:%
%:%88=33%:%
%:%89=33%:%
%:%90=34%:%
%:%91=35%:%
%:%92=35%:%
%:%93=36%:%
%:%94=36%:%
%:%95=36%:%
%:%96=37%:%
%:%97=37%:%
%:%98=38%:%
%:%99=38%:%
%:%100=38%:%
%:%101=39%:%
%:%102=39%:%
%:%103=40%:%
%:%104=40%:%
%:%105=40%:%
%:%106=41%:%
%:%107=41%:%
%:%108=41%:%
%:%109=42%:%
%:%110=42%:%
%:%111=42%:%
%:%112=43%:%
%:%113=43%:%
%:%114=43%:%
%:%115=44%:%
%:%116=44%:%
%:%117=44%:%
%:%118=45%:%
%:%119=45%:%
%:%120=45%:%
%:%121=46%:%
%:%131=48%:%
%:%133=49%:%
%:%134=49%:%
%:%135=50%:%
%:%138=51%:%
%:%142=51%:%
%:%143=51%:%
%:%148=51%:%
%:%151=52%:%
%:%152=53%:%
%:%153=53%:%
%:%154=54%:%
%:%155=55%:%
%:%158=56%:%
%:%162=56%:%
%:%163=56%:%
%:%164=57%:%
%:%165=57%:%
%:%179=59%:%
%:%191=61%:%
%:%193=62%:%
%:%194=62%:%
%:%195=63%:%
%:%196=64%:%
%:%197=65%:%
%:%198=65%:%
%:%199=66%:%
%:%200=67%:%
%:%203=68%:%
%:%207=68%:%
%:%208=68%:%
%:%209=68%:%
%:%214=68%:%
%:%217=69%:%
%:%218=70%:%
%:%219=70%:%
%:%220=71%:%
%:%221=72%:%
%:%224=73%:%
%:%228=73%:%
%:%229=73%:%
%:%230=73%:%
%:%235=73%:%
%:%238=74%:%
%:%239=75%:%
%:%240=75%:%
%:%241=76%:%
%:%244=77%:%
%:%248=77%:%
%:%249=77%:%
%:%258=79%:%
%:%260=80%:%
%:%261=80%:%
%:%262=81%:%
%:%263=82%:%
%:%266=83%:%
%:%270=83%:%
%:%271=83%:%
%:%272=83%:%
%:%281=85%:%
%:%283=86%:%
%:%284=86%:%
%:%285=87%:%
%:%286=88%:%
%:%293=89%:%
%:%294=89%:%
%:%295=90%:%
%:%296=90%:%
%:%297=91%:%
%:%298=91%:%
%:%299=91%:%
%:%300=92%:%
%:%301=92%:%
%:%302=93%:%
%:%303=93%:%
%:%304=94%:%
%:%305=94%:%
%:%306=95%:%
%:%307=96%:%
%:%308=96%:%
%:%309=97%:%
%:%310=97%:%
%:%311=97%:%
%:%312=98%:%
%:%313=98%:%
%:%314=99%:%
%:%315=99%:%
%:%316=99%:%
%:%317=100%:%
%:%318=100%:%
%:%319=101%:%
%:%320=101%:%
%:%321=101%:%
%:%322=101%:%
%:%323=102%:%
%:%324=102%:%
%:%325=103%:%
%:%326=103%:%
%:%327=104%:%
%:%328=104%:%
%:%329=104%:%
%:%330=105%:%
%:%336=105%:%
%:%339=106%:%
%:%340=107%:%
%:%341=107%:%
%:%342=108%:%
%:%345=109%:%
%:%349=109%:%
%:%350=109%:%
%:%359=111%:%
%:%361=112%:%
%:%362=112%:%
%:%363=113%:%
%:%366=114%:%
%:%370=114%:%
%:%371=114%:%
%:%372=114%:%
%:%377=114%:%
%:%380=115%:%
%:%381=115%:%
%:%382=116%:%
%:%383=117%:%
%:%386=118%:%
%:%390=118%:%
%:%391=118%:%
%:%396=118%:%
%:%399=119%:%
%:%400=120%:%
%:%401=120%:%
%:%402=121%:%
%:%403=122%:%
%:%404=123%:%
%:%407=124%:%
%:%411=124%:%
%:%412=124%:%
%:%413=124%:%
%:%427=126%:%
%:%439=128%:%
%:%441=129%:%
%:%442=129%:%
%:%443=130%:%
%:%444=131%:%
%:%445=132%:%
%:%446=132%:%
%:%447=133%:%
%:%448=134%:%
%:%451=135%:%
%:%455=135%:%
%:%456=135%:%
%:%457=136%:%
%:%458=136%:%
%:%459=137%:%
%:%460=137%:%
%:%461=138%:%
%:%462=138%:%
%:%463=138%:%
%:%464=139%:%
%:%465=139%:%
%:%466=140%:%
%:%467=140%:%
%:%468=141%:%
%:%469=141%:%
%:%470=142%:%
%:%471=142%:%
%:%472=142%:%
%:%473=143%:%
%:%474=143%:%
%:%475=144%:%
%:%481=144%:%
%:%484=145%:%
%:%485=146%:%
%:%486=146%:%
%:%487=147%:%
%:%488=148%:%
%:%491=149%:%
%:%495=149%:%
%:%496=149%:%
%:%501=149%:%
%:%504=150%:%
%:%505=151%:%
%:%506=151%:%
%:%507=152%:%
%:%508=153%:%
%:%511=154%:%
%:%515=154%:%
%:%516=154%:%
%:%525=156%:%
%:%527=157%:%
%:%528=157%:%
%:%529=158%:%
%:%530=159%:%
%:%533=160%:%
%:%537=160%:%
%:%538=160%:%
%:%539=161%:%
%:%540=161%:%
%:%549=163%:%
%:%551=164%:%
%:%552=164%:%
%:%553=165%:%
%:%556=166%:%
%:%560=166%:%
%:%561=166%:%
%:%562=166%:%
%:%571=168%:%
%:%573=169%:%
%:%574=169%:%
%:%575=170%:%
%:%582=171%:%
%:%583=171%:%
%:%584=172%:%
%:%585=172%:%
%:%586=173%:%
%:%587=173%:%
%:%588=173%:%
%:%589=174%:%
%:%590=174%:%
%:%591=175%:%
%:%592=175%:%
%:%593=176%:%
%:%594=176%:%
%:%595=177%:%
%:%596=177%:%
%:%597=177%:%
%:%598=178%:%
%:%599=178%:%
%:%600=178%:%
%:%601=179%:%
%:%607=179%:%
%:%610=180%:%
%:%611=181%:%
%:%612=181%:%
%:%613=182%:%
%:%614=183%:%
%:%617=184%:%
%:%621=184%:%
%:%622=184%:%
%:%627=184%:%
%:%630=185%:%
%:%631=186%:%
%:%632=186%:%
%:%633=187%:%
%:%634=188%:%
%:%641=189%:%
%:%642=189%:%
%:%643=190%:%
%:%644=191%:%
%:%645=191%:%
%:%646=192%:%
%:%647=192%:%
%:%648=192%:%
%:%649=193%:%
%:%650=193%:%
%:%651=193%:%
%:%652=194%:%
%:%653=194%:%
%:%654=194%:%
%:%655=195%:%
%:%656=195%:%
%:%657=195%:%
%:%658=196%:%
%:%659=196%:%
%:%660=196%:%
%:%661=197%:%
%:%662=197%:%
%:%663=197%:%
%:%664=197%:%
%:%665=198%:%
%:%671=198%:%
%:%674=199%:%
%:%675=200%:%
%:%676=200%:%
%:%677=201%:%
%:%678=202%:%
%:%679=203%:%
%:%680=204%:%
%:%687=205%:%
%:%688=205%:%
%:%689=206%:%
%:%690=206%:%
%:%691=207%:%
%:%692=207%:%
%:%693=207%:%
%:%694=208%:%
%:%695=208%:%
%:%696=209%:%
%:%697=209%:%
%:%698=209%:%
%:%699=210%:%
%:%700=210%:%
%:%701=211%:%
%:%702=211%:%
%:%703=212%:%
%:%704=212%:%
%:%705=213%:%
%:%706=213%:%
%:%707=213%:%
%:%708=214%:%
%:%709=214%:%
%:%710=214%:%
%:%711=215%:%
%:%712=215%:%
%:%713=216%:%
%:%719=216%:%
%:%722=217%:%
%:%723=218%:%
%:%724=218%:%
%:%725=219%:%
%:%726=220%:%
%:%727=221%:%
%:%730=222%:%
%:%734=222%:%
%:%735=222%:%
%:%736=223%:%
%:%737=223%:%
%:%738=224%:%
%:%739=224%:%
%:%740=225%:%
%:%741=225%:%
%:%742=226%:%
%:%743=226%:%
%:%744=227%:%
%:%745=227%:%
%:%746=228%:%
%:%747=228%:%
%:%748=229%:%
%:%749=229%:%
%:%750=230%:%
%:%751=230%:%
%:%752=231%:%
%:%753=231%:%
%:%754=231%:%
%:%755=232%:%
%:%756=232%:%
%:%757=233%:%
%:%758=233%:%
%:%759=233%:%
%:%760=234%:%
%:%761=234%:%
%:%762=235%:%
%:%763=235%:%
%:%764=235%:%
%:%765=235%:%
%:%766=236%:%
%:%767=236%:%
%:%768=236%:%
%:%769=237%:%
%:%770=237%:%
%:%771=238%:%
%:%772=238%:%
%:%773=238%:%
%:%774=239%:%
%:%775=239%:%
%:%776=240%:%
%:%777=240%:%
%:%778=240%:%
%:%779=241%:%
%:%780=241%:%
%:%781=242%:%
%:%787=242%:%
%:%790=243%:%
%:%791=244%:%
%:%792=244%:%
%:%793=245%:%
%:%800=246%:%
%:%801=246%:%
%:%802=247%:%
%:%803=247%:%
%:%804=248%:%
%:%805=248%:%
%:%806=248%:%
%:%807=249%:%
%:%808=249%:%
%:%809=250%:%
%:%810=250%:%
%:%811=250%:%
%:%812=251%:%
%:%813=251%:%
%:%814=251%:%
%:%815=252%:%
%:%816=253%:%
%:%817=253%:%
%:%818=254%:%
%:%819=254%:%
%:%820=255%:%
%:%821=255%:%
%:%822=256%:%
%:%823=256%:%
%:%824=257%:%
%:%825=257%:%
%:%826=258%:%
%:%827=258%:%
%:%828=259%:%
%:%829=259%:%
%:%830=260%:%
%:%831=261%:%
%:%832=261%:%
%:%833=262%:%
%:%834=262%:%
%:%835=262%:%
%:%836=263%:%
%:%837=264%:%
%:%838=264%:%
%:%839=265%:%
%:%840=265%:%
%:%841=266%:%
%:%842=267%:%
%:%843=267%:%
%:%844=268%:%
%:%845=268%:%
%:%846=269%:%
%:%847=270%:%
%:%848=270%:%
%:%849=271%:%
%:%850=271%:%
%:%851=272%:%
%:%852=272%:%
%:%853=273%:%
%:%854=273%:%
%:%855=274%:%
%:%856=274%:%
%:%857=274%:%
%:%858=275%:%
%:%859=275%:%
%:%860=275%:%
%:%861=276%:%
%:%862=276%:%
%:%863=276%:%
%:%864=277%:%
%:%865=277%:%
%:%866=278%:%
%:%867=278%:%
%:%868=278%:%
%:%869=279%:%
%:%870=279%:%
%:%871=279%:%
%:%872=280%:%
%:%873=280%:%
%:%874=280%:%
%:%875=281%:%
%:%876=281%:%
%:%877=282%:%
%:%878=282%:%
%:%879=282%:%
%:%880=282%:%
%:%881=283%:%
%:%882=283%:%
%:%883=284%:%
%:%884=284%:%
%:%885=284%:%
%:%886=285%:%
%:%887=285%:%
%:%888=286%:%
%:%889=286%:%
%:%890=286%:%
%:%891=287%:%
%:%892=287%:%
%:%893=288%:%
%:%894=288%:%
%:%895=288%:%
%:%896=289%:%
%:%897=289%:%
%:%898=290%:%
%:%899=290%:%
%:%900=291%:%
%:%901=291%:%
%:%902=292%:%
%:%903=292%:%
%:%904=293%:%
%:%905=293%:%
%:%906=293%:%
%:%907=294%:%
%:%908=294%:%
%:%909=295%:%
%:%919=297%:%
%:%920=298%:%
%:%922=299%:%
%:%923=299%:%
%:%924=300%:%
%:%925=301%:%
%:%926=302%:%
%:%927=303%:%
%:%930=304%:%
%:%934=304%:%
%:%935=304%:%
%:%936=305%:%
%:%937=305%:%
%:%938=306%:%
%:%939=306%:%
%:%940=307%:%
%:%941=307%:%
%:%942=308%:%
%:%943=308%:%
%:%944=309%:%
%:%945=309%:%
%:%946=310%:%
%:%947=310%:%
%:%948=311%:%
%:%949=312%:%
%:%950=312%:%
%:%951=313%:%
%:%952=313%:%
%:%953=314%:%
%:%954=314%:%
%:%955=315%:%
%:%956=315%:%
%:%957=315%:%
%:%958=316%:%
%:%959=316%:%
%:%960=317%:%
%:%961=317%:%
%:%962=317%:%
%:%963=318%:%
%:%964=318%:%
%:%965=319%:%
%:%966=319%:%
%:%967=319%:%
%:%968=320%:%
%:%969=320%:%
%:%970=321%:%
%:%971=321%:%
%:%972=321%:%
%:%973=322%:%
%:%974=322%:%
%:%975=323%:%
%:%976=323%:%
%:%977=324%:%
%:%978=324%:%
%:%979=325%:%
%:%980=325%:%
%:%981=326%:%
%:%982=327%:%
%:%983=327%:%
%:%984=327%:%
%:%985=328%:%
%:%986=328%:%
%:%987=328%:%
%:%988=329%:%
%:%989=330%:%
%:%990=330%:%
%:%991=331%:%
%:%992=331%:%
%:%993=332%:%
%:%994=332%:%
%:%995=333%:%
%:%996=333%:%
%:%997=333%:%
%:%998=334%:%
%:%999=334%:%
%:%1000=334%:%
%:%1001=335%:%
%:%1002=335%:%
%:%1003=336%:%
%:%1004=336%:%
%:%1005=336%:%
%:%1006=337%:%
%:%1007=337%:%
%:%1008=337%:%
%:%1009=338%:%
%:%1010=338%:%
%:%1011=338%:%
%:%1012=338%:%
%:%1013=339%:%
%:%1014=339%:%
%:%1015=340%:%
%:%1016=340%:%
%:%1017=340%:%
%:%1018=341%:%
%:%1019=341%:%
%:%1020=341%:%
%:%1021=342%:%
%:%1022=342%:%
%:%1023=342%:%
%:%1024=343%:%
%:%1025=343%:%
%:%1026=344%:%
%:%1027=344%:%
%:%1028=344%:%
%:%1029=345%:%
%:%1030=345%:%
%:%1031=345%:%
%:%1032=346%:%
%:%1047=348%:%
%:%1051=350%:%
%:%1061=352%:%
%:%1062=352%:%
%:%1063=353%:%
%:%1064=354%:%
%:%1065=355%:%
%:%1066=355%:%
%:%1067=356%:%
%:%1068=357%:%
%:%1071=358%:%
%:%1075=358%:%
%:%1076=358%:%
%:%1077=358%:%
%:%1078=358%:%
%:%1083=358%:%
%:%1086=359%:%
%:%1087=360%:%
%:%1088=360%:%
%:%1089=361%:%
%:%1090=362%:%
%:%1093=363%:%
%:%1097=363%:%
%:%1098=363%:%
%:%1099=363%:%
%:%1104=363%:%
%:%1107=364%:%
%:%1108=365%:%
%:%1109=365%:%
%:%1110=366%:%
%:%1111=367%:%
%:%1112=368%:%
%:%1119=369%:%
%:%1120=369%:%
%:%1121=370%:%
%:%1122=370%:%
%:%1123=371%:%
%:%1124=371%:%
%:%1125=372%:%
%:%1126=372%:%
%:%1127=372%:%
%:%1128=373%:%
%:%1129=373%:%
%:%1130=373%:%
%:%1131=374%:%
%:%1132=374%:%
%:%1133=374%:%
%:%1134=375%:%
%:%1135=375%:%
%:%1136=376%:%
%:%1137=376%:%
%:%1138=376%:%
%:%1139=377%:%
%:%1140=377%:%
%:%1141=378%:%
%:%1142=378%:%
%:%1143=378%:%
%:%1144=378%:%
%:%1145=379%:%
%:%1160=381%:%
%:%1170=383%:%
%:%1171=383%:%
%:%1172=384%:%
%:%1173=385%:%
%:%1174=386%:%
%:%1175=386%:%
%:%1176=387%:%
%:%1177=388%:%
%:%1180=389%:%
%:%1184=389%:%
%:%1185=389%:%
%:%1186=389%:%
%:%1187=390%:%
%:%1188=390%:%
%:%1193=390%:%
%:%1196=391%:%
%:%1197=392%:%
%:%1198=392%:%
%:%1199=393%:%
%:%1200=394%:%
%:%1203=395%:%
%:%1207=395%:%
%:%1208=395%:%
%:%1209=396%:%
%:%1210=396%:%
%:%1215=396%:%
%:%1218=397%:%
%:%1219=398%:%
%:%1220=398%:%
%:%1221=399%:%
%:%1222=400%:%
%:%1229=401%:%
%:%1230=401%:%
%:%1231=402%:%
%:%1232=402%:%
%:%1233=403%:%
%:%1234=403%:%
%:%1235=404%:%
%:%1236=405%:%
%:%1237=405%:%
%:%1238=406%:%
%:%1239=406%:%
%:%1240=406%:%
%:%1241=407%:%
%:%1242=407%:%
%:%1243=407%:%
%:%1244=408%:%
%:%1245=408%:%
%:%1246=409%:%
%:%1247=409%:%
%:%1248=409%:%
%:%1249=410%:%
%:%1250=410%:%
%:%1251=410%:%
%:%1252=411%:%
%:%1253=411%:%
%:%1254=411%:%
%:%1255=411%:%
%:%1256=412%:%
%:%1262=412%:%
%:%1265=413%:%
%:%1266=414%:%
%:%1267=414%:%
%:%1268=415%:%
%:%1269=416%:%
%:%1276=417%:%
%:%1277=417%:%
%:%1278=418%:%
%:%1279=418%:%
%:%1280=419%:%
%:%1281=419%:%
%:%1282=420%:%
%:%1283=420%:%
%:%1284=420%:%
%:%1285=421%:%
%:%1286=421%:%
%:%1287=422%:%
%:%1288=422%:%
%:%1289=423%:%
%:%1290=424%:%
%:%1291=424%:%
%:%1292=425%:%
%:%1293=425%:%
%:%1294=425%:%
%:%1295=426%:%
%:%1296=426%:%
%:%1297=426%:%
%:%1298=427%:%
%:%1299=427%:%
%:%1300=427%:%
%:%1301=428%:%
%:%1302=428%:%
%:%1303=428%:%
%:%1304=429%:%
%:%1305=429%:%
%:%1306=429%:%
%:%1307=430%:%
%:%1308=430%:%
%:%1309=431%:%
%:%1310=431%:%
%:%1311=431%:%
%:%1312=432%:%
%:%1313=432%:%
%:%1314=433%:%
%:%1315=433%:%
%:%1316=433%:%
%:%1317=434%:%
%:%1318=434%:%
%:%1319=435%:%
%:%1320=435%:%
%:%1321=435%:%
%:%1322=436%:%
%:%1323=436%:%
%:%1324=436%:%
%:%1325=437%:%
%:%1326=437%:%
%:%1327=437%:%
%:%1328=438%:%
%:%1329=438%:%
%:%1330=439%:%
%:%1331=439%:%
%:%1332=439%:%
%:%1333=440%:%
%:%1334=440%:%
%:%1335=440%:%
%:%1336=441%:%
%:%1351=443%:%
%:%1361=445%:%
%:%1362=445%:%
%:%1363=446%:%
%:%1364=447%:%
%:%1365=448%:%
%:%1366=448%:%
%:%1367=449%:%
%:%1370=450%:%
%:%1374=450%:%
%:%1375=450%:%
%:%1376=450%:%
%:%1381=450%:%
%:%1384=451%:%
%:%1385=452%:%
%:%1386=452%:%
%:%1387=453%:%
%:%1388=454%:%
%:%1389=455%:%
%:%1390=455%:%
%:%1391=456%:%
%:%1392=457%:%
%:%1393=458%:%
%:%1396=459%:%
%:%1400=459%:%
%:%1401=459%:%
%:%1402=459%:%
%:%1403=460%:%
%:%1404=460%:%
%:%1409=460%:%
%:%1412=461%:%
%:%1413=462%:%
%:%1414=462%:%
%:%1415=463%:%
%:%1416=464%:%
%:%1417=465%:%
%:%1424=466%:%
%:%1425=466%:%
%:%1426=467%:%
%:%1427=467%:%
%:%1428=468%:%
%:%1429=468%:%
%:%1430=468%:%
%:%1431=469%:%
%:%1432=469%:%
%:%1433=469%:%
%:%1434=470%:%
%:%1435=470%:%
%:%1436=470%:%
%:%1437=471%:%
%:%1443=471%:%
%:%1446=472%:%
%:%1447=473%:%
%:%1448=473%:%
%:%1449=474%:%
%:%1450=475%:%
%:%1451=476%:%
%:%1452=477%:%
%:%1459=478%:%
%:%1460=478%:%
%:%1461=479%:%
%:%1462=479%:%
%:%1463=480%:%
%:%1464=480%:%
%:%1465=480%:%
%:%1466=481%:%
%:%1467=481%:%
%:%1468=481%:%
%:%1469=482%:%
%:%1470=482%:%
%:%1471=482%:%
%:%1472=483%:%
%:%1473=483%:%
%:%1474=483%:%
%:%1475=484%:%
%:%1476=484%:%
%:%1477=484%:%
%:%1478=485%:%
%:%1479=485%:%
%:%1480=485%:%
%:%1481=486%:%
%:%1482=486%:%
%:%1483=486%:%
%:%1484=487%:%
%:%1485=487%:%
%:%1486=487%:%
%:%1487=488%:%
%:%1488=488%:%
%:%1489=488%:%
%:%1490=489%:%
%:%1491=489%:%
%:%1492=489%:%
%:%1493=490%:%
%:%1494=490%:%
%:%1495=490%:%
%:%1496=491%:%
%:%1497=491%:%
%:%1498=491%:%
%:%1499=492%:%
%:%1500=492%:%
%:%1501=492%:%
%:%1502=493%:%
%:%1503=493%:%
%:%1504=493%:%
%:%1505=493%:%
%:%1506=494%:%
%:%1512=494%:%
%:%1515=495%:%
%:%1516=496%:%
%:%1517=496%:%
%:%1518=497%:%
%:%1519=498%:%
%:%1520=499%:%
%:%1523=500%:%
%:%1527=500%:%
%:%1528=500%:%
%:%1529=501%:%
%:%1530=501%:%
%:%1531=502%:%
%:%1532=502%:%
%:%1533=503%:%
%:%1534=503%:%
%:%1535=504%:%
%:%1536=504%:%
%:%1537=505%:%
%:%1538=505%:%
%:%1539=505%:%
%:%1540=506%:%
%:%1541=506%:%
%:%1542=507%:%
%:%1543=507%:%
%:%1544=507%:%
%:%1545=508%:%
%:%1546=508%:%
%:%1547=509%:%
%:%1548=509%:%
%:%1549=510%:%
%:%1550=510%:%
%:%1551=511%:%
%:%1552=511%:%
%:%1553=511%:%
%:%1554=512%:%
%:%1555=512%:%
%:%1556=513%:%
%:%1557=513%:%
%:%1558=513%:%
%:%1559=514%:%
%:%1560=514%:%
%:%1561=514%:%
%:%1562=515%:%
%:%1563=515%:%
%:%1564=515%:%
%:%1565=516%:%
%:%1566=516%:%
%:%1567=516%:%
%:%1568=517%:%
%:%1569=517%:%
%:%1570=517%:%
%:%1571=518%:%
%:%1572=518%:%
%:%1573=518%:%
%:%1574=519%:%
%:%1575=519%:%
%:%1576=519%:%
%:%1577=520%:%
%:%1578=520%:%
%:%1579=520%:%
%:%1580=521%:%
%:%1581=521%:%
%:%1582=521%:%
%:%1583=522%:%
%:%1584=522%:%
%:%1585=522%:%
%:%1586=523%:%
%:%1587=523%:%
%:%1588=523%:%
%:%1589=524%:%
%:%1590=524%:%
%:%1591=524%:%
%:%1592=525%:%
%:%1593=525%:%
%:%1594=525%:%
%:%1595=525%:%
%:%1596=526%:%
%:%1597=526%:%
%:%1598=527%:%
%:%1599=527%:%
%:%1600=527%:%
%:%1601=528%:%
%:%1602=528%:%
%:%1603=528%:%
%:%1604=529%:%
%:%1610=529%:%
%:%1613=530%:%
%:%1614=531%:%
%:%1615=531%:%
%:%1616=532%:%
%:%1617=533%:%
%:%1620=534%:%
%:%1624=534%:%
%:%1625=534%:%
%:%1626=535%:%
%:%1627=535%:%
%:%1628=536%:%
%:%1629=536%:%
%:%1630=537%:%
%:%1631=538%:%
%:%1632=538%:%
%:%1633=539%:%
%:%1634=539%:%
%:%1635=540%:%
%:%1636=540%:%
%:%1637=541%:%
%:%1638=541%:%
%:%1639=541%:%
%:%1640=542%:%
%:%1641=542%:%
%:%1642=543%:%
%:%1643=543%:%
%:%1644=544%:%
%:%1645=545%:%
%:%1646=545%:%
%:%1647=546%:%
%:%1648=546%:%
%:%1649=546%:%
%:%1650=547%:%
%:%1651=547%:%
%:%1652=547%:%
%:%1653=548%:%
%:%1654=548%:%
%:%1655=548%:%
%:%1656=549%:%
%:%1657=549%:%
%:%1658=550%:%
%:%1659=550%:%
%:%1660=550%:%
%:%1661=551%:%
%:%1662=551%:%
%:%1663=552%:%
%:%1664=552%:%
%:%1665=552%:%
%:%1666=553%:%
%:%1667=553%:%
%:%1668=554%:%
%:%1669=554%:%
%:%1670=554%:%
%:%1671=555%:%
%:%1672=555%:%
%:%1673=556%:%
%:%1674=556%:%
%:%1675=556%:%
%:%1676=557%:%
%:%1677=557%:%
%:%1678=558%:%
%:%1679=558%:%
%:%1680=558%:%
%:%1681=559%:%
%:%1682=559%:%
%:%1683=560%:%
%:%1684=560%:%
%:%1685=560%:%
%:%1686=561%:%
%:%1687=561%:%
%:%1688=561%:%
%:%1689=562%:%
%:%1690=562%:%
%:%1691=562%:%
%:%1692=563%:%
%:%1693=563%:%
%:%1694=563%:%
%:%1695=564%:%
%:%1696=564%:%
%:%1697=564%:%
%:%1698=565%:%
%:%1699=565%:%
%:%1700=565%:%
%:%1701=566%:%
%:%1702=566%:%
%:%1703=566%:%
%:%1704=567%:%
%:%1705=567%:%
%:%1706=567%:%
%:%1707=568%:%
%:%1708=568%:%
%:%1709=568%:%
%:%1710=569%:%
%:%1711=569%:%
%:%1712=569%:%
%:%1713=570%:%
%:%1714=570%:%
%:%1715=570%:%
%:%1716=571%:%
%:%1717=571%:%
%:%1718=571%:%
%:%1719=572%:%
%:%1720=572%:%
%:%1721=572%:%
%:%1722=573%:%
%:%1723=573%:%
%:%1724=573%:%
%:%1725=574%:%
%:%1726=574%:%
%:%1727=574%:%
%:%1728=575%:%
%:%1729=575%:%
%:%1730=576%:%
%:%1731=576%:%
%:%1732=576%:%
%:%1733=577%:%
%:%1734=577%:%
%:%1735=578%:%
%:%1736=578%:%
%:%1737=579%:%
%:%1738=579%:%
%:%1739=579%:%
%:%1741=581%:%
%:%1742=582%:%
%:%1743=582%:%
%:%1744=582%:%
%:%1745=583%:%
%:%1746=583%:%
%:%1747=583%:%
%:%1748=584%:%
%:%1749=585%:%
%:%1750=585%:%
%:%1751=585%:%
%:%1752=586%:%
%:%1758=586%:%
%:%1761=587%:%
%:%1762=588%:%
%:%1763=588%:%
%:%1764=589%:%
%:%1765=590%:%
%:%1766=591%:%
%:%1767=592%:%
%:%1774=593%:%
%:%1775=593%:%
%:%1776=594%:%
%:%1777=594%:%
%:%1778=595%:%
%:%1779=595%:%
%:%1780=595%:%
%:%1781=596%:%
%:%1782=596%:%
%:%1783=596%:%
%:%1784=597%:%
%:%1785=597%:%
%:%1786=597%:%
%:%1787=598%:%
%:%1788=598%:%
%:%1789=598%:%
%:%1790=599%:%
%:%1791=599%:%
%:%1792=599%:%
%:%1793=600%:%
%:%1794=600%:%
%:%1795=600%:%
%:%1796=601%:%
%:%1797=601%:%
%:%1798=602%:%
%:%1799=602%:%
%:%1800=603%:%
%:%1801=604%:%
%:%1802=604%:%
%:%1803=605%:%
%:%1804=605%:%
%:%1805=606%:%
%:%1806=607%:%
%:%1807=607%:%
%:%1808=607%:%
%:%1809=608%:%
%:%1810=608%:%
%:%1811=608%:%
%:%1812=609%:%
%:%1813=609%:%
%:%1814=609%:%
%:%1815=610%:%
%:%1816=610%:%
%:%1817=610%:%
%:%1818=611%:%
%:%1819=611%:%
%:%1820=611%:%
%:%1821=612%:%
%:%1822=612%:%
%:%1823=612%:%
%:%1824=613%:%
%:%1825=613%:%
%:%1826=613%:%
%:%1827=614%:%
%:%1828=614%:%
%:%1829=615%:%
%:%1830=615%:%
%:%1831=615%:%
%:%1832=616%:%
%:%1833=616%:%
%:%1834=616%:%
%:%1835=617%:%
%:%1836=618%:%
%:%1837=618%:%
%:%1838=619%:%
%:%1839=619%:%
%:%1840=619%:%
%:%1841=620%:%
%:%1842=620%:%
%:%1843=620%:%
%:%1844=621%:%
%:%1845=621%:%
%:%1846=621%:%
%:%1847=622%:%
%:%1848=622%:%
%:%1849=622%:%
%:%1850=623%:%
%:%1851=623%:%
%:%1852=623%:%
%:%1853=624%:%
%:%1854=624%:%
%:%1855=624%:%
%:%1856=625%:%
%:%1857=625%:%
%:%1858=625%:%
%:%1859=626%:%
%:%1860=626%:%
%:%1861=626%:%
%:%1862=627%:%
%:%1863=627%:%
%:%1864=627%:%
%:%1865=628%:%
%:%1866=628%:%
%:%1867=628%:%
%:%1868=629%:%
%:%1869=629%:%
%:%1870=629%:%
%:%1871=630%:%
%:%1872=630%:%
%:%1873=630%:%
%:%1874=631%:%
%:%1875=631%:%
%:%1876=631%:%
%:%1877=631%:%
%:%1878=632%:%
%:%1884=632%:%
%:%1887=633%:%
%:%1888=634%:%
%:%1889=634%:%
%:%1890=635%:%
%:%1891=636%:%
%:%1892=637%:%
%:%1899=638%:%
%:%1900=638%:%
%:%1901=639%:%
%:%1902=639%:%
%:%1903=640%:%
%:%1904=640%:%
%:%1905=640%:%
%:%1906=641%:%
%:%1907=641%:%
%:%1908=642%:%
%:%1909=642%:%
%:%1910=642%:%
%:%1911=643%:%
%:%1912=643%:%
%:%1913=644%:%
%:%1914=644%:%
%:%1915=645%:%
%:%1916=645%:%
%:%1917=646%:%
%:%1918=646%:%
%:%1919=647%:%
%:%1920=647%:%
%:%1921=647%:%
%:%1922=648%:%
%:%1923=648%:%
%:%1924=648%:%
%:%1925=649%:%
%:%1926=649%:%
%:%1927=649%:%
%:%1928=650%:%
%:%1929=650%:%
%:%1930=650%:%
%:%1931=651%:%
%:%1932=651%:%
%:%1933=651%:%
%:%1934=652%:%
%:%1935=652%:%
%:%1936=652%:%
%:%1937=653%:%
%:%1938=653%:%
%:%1939=653%:%
%:%1940=654%:%
%:%1941=654%:%
%:%1942=654%:%
%:%1943=655%:%
%:%1944=655%:%
%:%1945=656%:%
%:%1951=656%:%
%:%1954=657%:%
%:%1955=658%:%
%:%1956=658%:%
%:%1957=659%:%
%:%1958=660%:%
%:%1961=661%:%
%:%1965=661%:%
%:%1966=661%:%
%:%1967=661%:%
%:%1972=661%:%
%:%1975=662%:%
%:%1976=663%:%
%:%1977=663%:%
%:%1978=664%:%
%:%1979=665%:%
%:%1982=666%:%
%:%1986=666%:%
%:%1987=666%:%
%:%1988=666%:%
%:%1993=666%:%
%:%1996=667%:%
%:%1997=668%:%
%:%1998=668%:%
%:%1999=669%:%
%:%2000=670%:%
%:%2001=671%:%
%:%2004=672%:%
%:%2008=672%:%
%:%2009=672%:%
%:%2010=672%:%
%:%2015=672%:%
%:%2018=673%:%
%:%2019=674%:%
%:%2020=674%:%
%:%2021=675%:%
%:%2022=676%:%
%:%2023=677%:%
%:%2026=678%:%
%:%2030=678%:%
%:%2031=678%:%
%:%2032=678%:%
%:%2037=678%:%
%:%2040=679%:%
%:%2041=680%:%
%:%2042=680%:%
%:%2043=681%:%
%:%2044=682%:%
%:%2045=683%:%
%:%2046=684%:%
%:%2053=685%:%
%:%2054=685%:%
%:%2055=686%:%
%:%2056=686%:%
%:%2057=687%:%
%:%2058=687%:%
%:%2059=687%:%
%:%2060=688%:%
%:%2061=688%:%
%:%2062=688%:%
%:%2063=689%:%
%:%2064=689%:%
%:%2065=689%:%
%:%2066=690%:%
%:%2067=690%:%
%:%2068=690%:%
%:%2069=691%:%
%:%2070=691%:%
%:%2071=691%:%
%:%2072=692%:%
%:%2073=692%:%
%:%2074=692%:%
%:%2075=693%:%
%:%2076=693%:%
%:%2077=693%:%
%:%2078=694%:%
%:%2079=694%:%
%:%2080=694%:%
%:%2081=695%:%
%:%2082=695%:%
%:%2083=695%:%
%:%2084=696%:%
%:%2085=696%:%
%:%2086=696%:%
%:%2087=697%:%
%:%2088=697%:%
%:%2089=697%:%
%:%2090=698%:%
%:%2091=698%:%
%:%2092=698%:%
%:%2093=699%:%
%:%2094=699%:%
%:%2095=699%:%
%:%2096=700%:%
%:%2097=700%:%
%:%2098=700%:%
%:%2099=700%:%
%:%2100=701%:%
%:%2115=703%:%
%:%2125=705%:%
%:%2126=705%:%
%:%2127=706%:%
%:%2128=707%:%
%:%2129=708%:%
%:%2130=708%:%
%:%2131=709%:%
%:%2132=710%:%
%:%2139=711%:%
%:%2140=711%:%
%:%2141=712%:%
%:%2142=712%:%
%:%2143=713%:%
%:%2144=713%:%
%:%2145=713%:%
%:%2146=714%:%
%:%2147=714%:%
%:%2148=714%:%
%:%2149=715%:%
%:%2150=715%:%
%:%2151=716%:%
%:%2157=716%:%
%:%2160=717%:%
%:%2161=718%:%
%:%2162=718%:%
%:%2163=719%:%
%:%2164=720%:%
%:%2165=721%:%
%:%2168=722%:%
%:%2172=722%:%
%:%2173=722%:%
%:%2174=722%:%
%:%2179=722%:%
%:%2182=723%:%
%:%2183=724%:%
%:%2184=724%:%
%:%2185=725%:%
%:%2186=726%:%
%:%2187=727%:%
%:%2188=728%:%
%:%2195=729%:%
%:%2196=729%:%
%:%2197=730%:%
%:%2198=730%:%
%:%2199=731%:%
%:%2200=731%:%
%:%2201=731%:%
%:%2202=732%:%
%:%2203=732%:%
%:%2204=732%:%
%:%2205=733%:%
%:%2206=733%:%
%:%2207=733%:%
%:%2208=734%:%
%:%2209=734%:%
%:%2210=734%:%
%:%2211=734%:%
%:%2212=735%:%
%:%2218=735%:%
%:%2221=736%:%
%:%2222=737%:%
%:%2223=737%:%
%:%2224=738%:%
%:%2225=739%:%
%:%2226=740%:%
%:%2227=740%:%
%:%2228=741%:%
%:%2229=742%:%
%:%2236=743%:%
%:%2237=743%:%
%:%2238=744%:%
%:%2239=744%:%
%:%2240=745%:%
%:%2241=745%:%
%:%2242=745%:%
%:%2243=746%:%
%:%2244=746%:%
%:%2245=746%:%
%:%2246=747%:%
%:%2247=747%:%
%:%2248=748%:%
%:%2254=748%:%
%:%2257=749%:%
%:%2258=750%:%
%:%2259=750%:%
%:%2260=751%:%
%:%2261=752%:%
%:%2262=753%:%
%:%2265=754%:%
%:%2269=754%:%
%:%2270=754%:%
%:%2271=754%:%
%:%2276=754%:%
%:%2279=755%:%
%:%2280=756%:%
%:%2281=756%:%
%:%2282=757%:%
%:%2283=758%:%
%:%2284=759%:%
%:%2285=760%:%
%:%2292=761%:%
%:%2293=761%:%
%:%2294=762%:%
%:%2295=762%:%
%:%2296=763%:%
%:%2297=763%:%
%:%2298=763%:%
%:%2299=764%:%
%:%2300=764%:%
%:%2301=764%:%
%:%2302=765%:%
%:%2303=765%:%
%:%2304=765%:%
%:%2305=766%:%
%:%2306=766%:%
%:%2307=766%:%
%:%2308=766%:%
%:%2309=767%:%
%:%2324=769%:%
%:%2336=771%:%
%:%2338=772%:%
%:%2339=772%:%
%:%2340=773%:%
%:%2347=774%:%
%:%2348=774%:%
%:%2349=775%:%
%:%2350=775%:%
%:%2351=776%:%
%:%2352=776%:%
%:%2353=776%:%
%:%2354=777%:%
%:%2355=777%:%
%:%2356=778%:%
%:%2357=778%:%
%:%2358=778%:%
%:%2359=779%:%
%:%2360=779%:%
%:%2362=781%:%
%:%2363=782%:%
%:%2364=782%:%
%:%2365=783%:%
%:%2366=783%:%
%:%2367=783%:%
%:%2368=784%:%
%:%2369=784%:%
%:%2370=785%:%
%:%2371=786%:%
%:%2372=786%:%
%:%2373=787%:%
%:%2374=787%:%
%:%2375=788%:%
%:%2376=789%:%
%:%2377=789%:%
%:%2378=790%:%
%:%2379=790%:%
%:%2380=791%:%
%:%2381=791%:%
%:%2382=792%:%
%:%2383=792%:%
%:%2384=793%:%
%:%2385=793%:%
%:%2386=794%:%
%:%2387=794%:%
%:%2388=794%:%
%:%2389=795%:%
%:%2390=795%:%
%:%2391=795%:%
%:%2392=796%:%
%:%2393=797%:%
%:%2394=797%:%
%:%2395=798%:%
%:%2396=798%:%
%:%2397=798%:%
%:%2398=799%:%
%:%2399=800%:%
%:%2400=800%:%
%:%2401=801%:%
%:%2402=801%:%
%:%2403=801%:%
%:%2404=802%:%
%:%2405=802%:%
%:%2406=802%:%
%:%2407=803%:%
%:%2408=803%:%
%:%2409=803%:%
%:%2410=804%:%
%:%2411=804%:%
%:%2412=805%:%
%:%2413=805%:%
%:%2414=806%:%
%:%2415=807%:%
%:%2416=807%:%
%:%2417=808%:%
%:%2418=808%:%
%:%2419=808%:%
%:%2420=809%:%
%:%2421=809%:%
%:%2422=809%:%
%:%2423=810%:%
%:%2424=810%:%
%:%2425=810%:%
%:%2426=811%:%
%:%2436=813%:%
%:%2438=814%:%
%:%2439=814%:%
%:%2440=815%:%
%:%2447=816%:%
%:%2448=816%:%
%:%2449=817%:%
%:%2450=817%:%
%:%2451=818%:%
%:%2452=818%:%
%:%2453=818%:%
%:%2454=819%:%
%:%2455=819%:%
%:%2456=820%:%
%:%2457=820%:%
%:%2458=821%:%
%:%2459=821%:%
%:%2460=822%:%
%:%2461=822%:%
%:%2462=823%:%
%:%2463=823%:%
%:%2464=824%:%
%:%2465=824%:%
%:%2466=824%:%
%:%2467=825%:%
%:%2468=825%:%
%:%2469=826%:%
%:%2470=827%:%
%:%2471=827%:%
%:%2472=827%:%
%:%2473=828%:%
%:%2474=828%:%
%:%2475=828%:%
%:%2476=829%:%
%:%2477=829%:%
%:%2478=830%:%
%:%2479=830%:%
%:%2480=830%:%
%:%2481=831%:%
%:%2482=831%:%
%:%2483=831%:%
%:%2484=832%:%
%:%2485=832%:%
%:%2486=833%:%
%:%2487=833%:%
%:%2488=833%:%
%:%2489=834%:%
%:%2490=834%:%
%:%2491=835%:%
%:%2492=835%:%
%:%2493=835%:%
%:%2494=836%:%
%:%2495=836%:%
%:%2496=836%:%
%:%2497=837%:%
%:%2503=837%:%
%:%2506=838%:%
%:%2507=839%:%
%:%2508=839%:%
%:%2509=840%:%
%:%2516=841%:%
%:%2517=841%:%
%:%2518=842%:%
%:%2519=842%:%
%:%2520=843%:%
%:%2521=843%:%
%:%2522=843%:%
%:%2523=844%:%
%:%2524=844%:%
%:%2525=845%:%
%:%2526=845%:%
%:%2527=846%:%
%:%2528=846%:%
%:%2529=847%:%
%:%2530=847%:%
%:%2531=848%:%
%:%2532=848%:%
%:%2533=849%:%
%:%2534=849%:%
%:%2535=849%:%
%:%2536=850%:%
%:%2537=850%:%
%:%2538=850%:%
%:%2539=851%:%
%:%2540=851%:%
%:%2541=852%:%
%:%2542=852%:%
%:%2543=853%:%
%:%2544=853%:%
%:%2545=853%:%
%:%2546=854%:%
%:%2556=856%:%
%:%2558=857%:%
%:%2559=857%:%
%:%2560=858%:%
%:%2567=859%:%
%:%2568=859%:%
%:%2569=860%:%
%:%2570=860%:%
%:%2571=861%:%
%:%2572=861%:%
%:%2573=862%:%
%:%2574=862%:%
%:%2575=863%:%
%:%2576=863%:%
%:%2577=864%:%
%:%2578=864%:%
%:%2579=865%:%
%:%2580=866%:%
%:%2581=866%:%
%:%2585=870%:%
%:%2586=871%:%
%:%2587=871%:%
%:%2588=872%:%
%:%2589=872%:%
%:%2590=873%:%
%:%2591=873%:%
%:%2592=874%:%
%:%2593=874%:%
%:%2594=874%:%
%:%2595=875%:%
%:%2596=875%:%
%:%2597=876%:%
%:%2598=876%:%
%:%2599=876%:%
%:%2600=877%:%
%:%2601=877%:%
%:%2602=878%:%
%:%2603=878%:%
%:%2604=878%:%
%:%2605=878%:%
%:%2606=879%:%
%:%2607=879%:%
%:%2608=880%:%
%:%2609=880%:%
%:%2610=881%:%
%:%2611=881%:%
%:%2614=884%:%
%:%2615=885%:%
%:%2616=885%:%
%:%2617=886%:%
%:%2618=886%:%
%:%2619=887%:%
%:%2620=887%:%
%:%2621=888%:%
%:%2622=888%:%
%:%2623=889%:%
%:%2624=889%:%
%:%2625=890%:%
%:%2626=891%:%
%:%2627=891%:%
%:%2628=892%:%
%:%2629=892%:%
%:%2630=893%:%
%:%2631=893%:%
%:%2632=893%:%
%:%2633=894%:%
%:%2634=894%:%
%:%2635=895%:%
%:%2636=895%:%
%:%2637=895%:%
%:%2638=896%:%
%:%2639=896%:%
%:%2640=897%:%
%:%2641=897%:%
%:%2642=897%:%
%:%2643=898%:%
%:%2644=898%:%
%:%2645=899%:%
%:%2646=899%:%
%:%2647=900%:%
%:%2648=900%:%
%:%2649=901%:%
%:%2650=901%:%
%:%2651=902%:%
%:%2652=902%:%
%:%2653=903%:%
%:%2654=903%:%
%:%2655=904%:%
%:%2656=904%:%
%:%2657=905%:%
%:%2658=905%:%
%:%2659=905%:%
%:%2660=906%:%
%:%2661=906%:%
%:%2662=906%:%
%:%2663=907%:%
%:%2664=907%:%
%:%2665=907%:%
%:%2666=908%:%
%:%2667=908%:%
%:%2668=909%:%
%:%2669=909%:%
%:%2670=909%:%
%:%2671=910%:%
%:%2672=910%:%
%:%2673=911%:%
%:%2674=911%:%
%:%2675=911%:%
%:%2676=912%:%
%:%2677=912%:%
%:%2678=912%:%
%:%2679=913%:%
%:%2680=913%:%
%:%2681=914%:%
%:%2682=914%:%
%:%2683=915%:%
%:%2684=915%:%
%:%2685=916%:%
%:%2686=916%:%
%:%2687=916%:%
%:%2688=917%:%
%:%2689=917%:%
%:%2690=917%:%
%:%2691=918%:%
%:%2697=918%:%
%:%2700=919%:%
%:%2701=920%:%
%:%2702=920%:%
%:%2703=921%:%
%:%2710=922%:%
%:%2711=922%:%
%:%2712=923%:%
%:%2713=923%:%
%:%2714=924%:%
%:%2715=924%:%
%:%2716=925%:%
%:%2717=925%:%
%:%2718=926%:%
%:%2719=926%:%
%:%2720=927%:%
%:%2721=927%:%
%:%2722=928%:%
%:%2723=928%:%
%:%2729=934%:%
%:%2730=935%:%
%:%2731=935%:%
%:%2732=936%:%
%:%2733=936%:%
%:%2734=937%:%
%:%2735=938%:%
%:%2736=938%:%
%:%2737=938%:%
%:%2738=939%:%
%:%2739=939%:%
%:%2740=939%:%
%:%2741=940%:%
%:%2742=940%:%
%:%2743=941%:%
%:%2744=941%:%
%:%2745=941%:%
%:%2746=942%:%
%:%2747=942%:%
%:%2748=943%:%
%:%2749=943%:%
%:%2750=943%:%
%:%2751=944%:%
%:%2752=944%:%
%:%2753=944%:%
%:%2754=945%:%
%:%2755=945%:%
%:%2756=945%:%
%:%2757=946%:%
%:%2758=946%:%
%:%2759=947%:%
%:%2760=947%:%
%:%2761=947%:%
%:%2762=948%:%
%:%2763=948%:%
%:%2764=949%:%
%:%2765=949%:%
%:%2766=949%:%
%:%2767=949%:%
%:%2768=950%:%
%:%2769=950%:%
%:%2770=951%:%
%:%2771=951%:%
%:%2772=952%:%
%:%2773=953%:%
%:%2774=953%:%
%:%2775=953%:%
%:%2776=954%:%
%:%2777=954%:%
%:%2778=954%:%
%:%2779=955%:%
%:%2780=955%:%
%:%2781=956%:%
%:%2782=956%:%
%:%2783=956%:%
%:%2784=957%:%
%:%2785=957%:%
%:%2786=958%:%
%:%2787=958%:%
%:%2788=958%:%
%:%2789=959%:%
%:%2790=959%:%
%:%2791=959%:%
%:%2792=960%:%
%:%2793=960%:%
%:%2794=960%:%
%:%2795=961%:%
%:%2796=961%:%
%:%2797=962%:%
%:%2798=962%:%
%:%2799=962%:%
%:%2800=963%:%
%:%2801=963%:%
%:%2802=964%:%
%:%2803=964%:%
%:%2804=964%:%
%:%2805=964%:%
%:%2806=965%:%
%:%2807=965%:%
%:%2808=966%:%
%:%2809=966%:%
%:%2810=967%:%
%:%2811=967%:%
%:%2812=968%:%
%:%2813=968%:%
%:%2814=969%:%
%:%2815=969%:%
%:%2816=970%:%
%:%2817=970%:%
%:%2818=971%:%
%:%2819=971%:%
%:%2820=972%:%
%:%2821=972%:%
%:%2822=973%:%
%:%2823=973%:%
%:%2824=974%:%
%:%2825=974%:%
%:%2826=975%:%
%:%2827=975%:%
%:%2828=976%:%
%:%2829=976%:%
%:%2830=976%:%
%:%2831=977%:%
%:%2832=978%:%
%:%2833=978%:%
%:%2834=978%:%
%:%2835=979%:%
%:%2836=979%:%
%:%2837=980%:%
%:%2838=980%:%
%:%2839=981%:%
%:%2840=981%:%
%:%2841=982%:%
%:%2842=982%:%
%:%2843=982%:%
%:%2844=983%:%
%:%2845=983%:%
%:%2846=984%:%
%:%2847=984%:%
%:%2848=985%:%
%:%2849=985%:%
%:%2850=986%:%
%:%2851=986%:%
%:%2852=986%:%
%:%2853=987%:%
%:%2854=987%:%
%:%2855=987%:%
%:%2856=988%:%
%:%2857=988%:%
%:%2858=988%:%
%:%2859=989%:%
%:%2860=989%:%
%:%2861=989%:%
%:%2862=990%:%
%:%2863=990%:%
%:%2864=990%:%
%:%2865=991%:%
%:%2866=991%:%
%:%2867=992%:%
%:%2868=992%:%
%:%2869=992%:%
%:%2870=993%:%
%:%2871=993%:%
%:%2872=993%:%
%:%2873=994%:%
%:%2874=994%:%
%:%2875=994%:%
%:%2876=995%:%
%:%2877=995%:%
%:%2878=995%:%
%:%2879=996%:%
%:%2880=996%:%
%:%2881=996%:%
%:%2882=997%:%
%:%2883=997%:%
%:%2884=998%:%
%:%2885=998%:%
%:%2886=998%:%
%:%2887=999%:%
%:%2888=999%:%
%:%2889=1000%:%
%:%2890=1000%:%
%:%2891=1000%:%
%:%2892=1001%:%
%:%2893=1001%:%
%:%2894=1002%:%
%:%2895=1002%:%
%:%2896=1002%:%
%:%2897=1003%:%
%:%2898=1003%:%
%:%2899=1004%:%
%:%2900=1004%:%
%:%2901=1004%:%
%:%2902=1005%:%
%:%2903=1005%:%
%:%2904=1006%:%
%:%2905=1006%:%
%:%2906=1006%:%
%:%2907=1006%:%
%:%2908=1007%:%
%:%2909=1007%:%
%:%2910=1008%:%
%:%2911=1008%:%
%:%2912=1009%:%
%:%2913=1009%:%
%:%2914=1009%:%
%:%2915=1010%:%
%:%2916=1010%:%
%:%2917=1010%:%
%:%2918=1011%:%
%:%2919=1011%:%
%:%2920=1012%:%
%:%2921=1012%:%
%:%2922=1013%:%
%:%2923=1013%:%
%:%2924=1013%:%
%:%2925=1014%:%
%:%2926=1014%:%
%:%2927=1014%:%
%:%2928=1015%:%
%:%2929=1015%:%
%:%2930=1015%:%
%:%2931=1016%:%
%:%2932=1016%:%
%:%2933=1016%:%
%:%2934=1017%:%
%:%2935=1017%:%
%:%2936=1017%:%
%:%2937=1018%:%
%:%2938=1018%:%
%:%2939=1019%:%
%:%2940=1019%:%
%:%2941=1019%:%
%:%2942=1020%:%
%:%2943=1020%:%
%:%2944=1020%:%
%:%2945=1021%:%
%:%2946=1021%:%
%:%2947=1021%:%
%:%2948=1022%:%
%:%2949=1022%:%
%:%2950=1022%:%
%:%2951=1023%:%
%:%2952=1023%:%
%:%2953=1023%:%
%:%2954=1024%:%
%:%2955=1024%:%
%:%2956=1025%:%
%:%2957=1025%:%
%:%2958=1025%:%
%:%2959=1026%:%
%:%2960=1026%:%
%:%2961=1027%:%
%:%2962=1027%:%
%:%2963=1027%:%
%:%2964=1028%:%
%:%2965=1028%:%
%:%2966=1029%:%
%:%2967=1029%:%
%:%2968=1029%:%
%:%2969=1030%:%
%:%2970=1030%:%
%:%2971=1031%:%
%:%2972=1031%:%
%:%2973=1031%:%
%:%2974=1032%:%
%:%2975=1032%:%
%:%2976=1033%:%
%:%2977=1033%:%
%:%2978=1033%:%
%:%2979=1033%:%
%:%2980=1034%:%
%:%2981=1034%:%
%:%2982=1035%:%
%:%2983=1035%:%
%:%2984=1036%:%
%:%2985=1036%:%
%:%2986=1037%:%
%:%2987=1037%:%
%:%2988=1037%:%
%:%2990=1039%:%
%:%2991=1040%:%
%:%2992=1040%:%
%:%2993=1040%:%
%:%2994=1041%:%
%:%2995=1041%:%
%:%2996=1042%:%
%:%2997=1042%:%
%:%2998=1043%:%
%:%2999=1043%:%
%:%3000=1043%:%
%:%3001=1044%:%
%:%3002=1044%:%
%:%3003=1045%:%
%:%3009=1045%:%
%:%3012=1046%:%
%:%3013=1047%:%
%:%3014=1047%:%
%:%3015=1048%:%
%:%3016=1049%:%
%:%3023=1050%:%
%:%3024=1050%:%
%:%3025=1051%:%
%:%3026=1051%:%
%:%3027=1052%:%
%:%3028=1052%:%
%:%3029=1052%:%
%:%3030=1053%:%
%:%3031=1053%:%
%:%3032=1054%:%
%:%3033=1054%:%
%:%3034=1054%:%
%:%3035=1055%:%
%:%3036=1055%:%
%:%3037=1056%:%
%:%3038=1056%:%
%:%3039=1056%:%
%:%3040=1057%:%
%:%3041=1057%:%
%:%3042=1058%:%
%:%3043=1058%:%
%:%3044=1059%:%
%:%3045=1059%:%
%:%3046=1060%:%
%:%3047=1060%:%
%:%3048=1060%:%
%:%3049=1061%:%
%:%3055=1061%:%
%:%3058=1062%:%
%:%3059=1063%:%
%:%3060=1063%:%
%:%3061=1064%:%
%:%3062=1065%:%
%:%3069=1066%:%
%:%3070=1066%:%
%:%3071=1067%:%
%:%3072=1067%:%
%:%3073=1068%:%
%:%3074=1068%:%
%:%3075=1068%:%
%:%3076=1069%:%
%:%3077=1069%:%
%:%3078=1070%:%
%:%3079=1070%:%
%:%3080=1070%:%
%:%3081=1071%:%
%:%3082=1071%:%
%:%3083=1072%:%
%:%3084=1072%:%
%:%3085=1073%:%
%:%3086=1073%:%
%:%3087=1074%:%
%:%3088=1074%:%
%:%3089=1074%:%
%:%3090=1075%:%
%:%3091=1075%:%
%:%3092=1076%:%
%:%3093=1076%:%
%:%3094=1076%:%
%:%3095=1077%:%
%:%3096=1078%:%
%:%3097=1078%:%
%:%3098=1079%:%
%:%3099=1079%:%
%:%3100=1080%:%
%:%3101=1080%:%
%:%3102=1081%:%
%:%3103=1081%:%
%:%3104=1081%:%
%:%3105=1082%:%
%:%3106=1082%:%
%:%3107=1082%:%
%:%3108=1083%:%
%:%3109=1083%:%
%:%3110=1084%:%
%:%3111=1084%:%
%:%3112=1084%:%
%:%3113=1085%:%
%:%3114=1085%:%
%:%3115=1086%:%
%:%3116=1086%:%
%:%3117=1086%:%
%:%3118=1087%:%
%:%3119=1087%:%
%:%3120=1088%:%
%:%3121=1088%:%
%:%3122=1088%:%
%:%3123=1088%:%
%:%3124=1089%:%
%:%3125=1089%:%
%:%3126=1090%:%
%:%3127=1090%:%
%:%3128=1091%:%
%:%3129=1091%:%
%:%3130=1092%:%
%:%3131=1092%:%
%:%3132=1093%:%
%:%3133=1093%:%
%:%3134=1093%:%
%:%3135=1094%:%
%:%3136=1094%:%
%:%3137=1094%:%
%:%3138=1095%:%
%:%3139=1095%:%
%:%3140=1096%:%
%:%3141=1096%:%
%:%3142=1096%:%
%:%3143=1097%:%
%:%3144=1097%:%
%:%3145=1098%:%
%:%3146=1098%:%
%:%3147=1098%:%
%:%3148=1099%:%
%:%3149=1099%:%
%:%3150=1100%:%
%:%3151=1100%:%
%:%3152=1100%:%
%:%3153=1100%:%
%:%3154=1101%:%
%:%3155=1101%:%
%:%3156=1102%:%
%:%3157=1102%:%
%:%3158=1103%:%
%:%3159=1103%:%
%:%3160=1104%:%
%:%3166=1104%:%
%:%3169=1105%:%
%:%3170=1106%:%
%:%3171=1106%:%
%:%3172=1107%:%
%:%3179=1108%:%
%:%3180=1108%:%
%:%3181=1109%:%
%:%3182=1109%:%
%:%3183=1110%:%
%:%3184=1111%:%
%:%3185=1112%:%
%:%3186=1112%:%
%:%3187=1112%:%
%:%3188=1113%:%
%:%3189=1114%:%
%:%3190=1114%:%
%:%3191=1115%:%
%:%3192=1116%:%
%:%3193=1117%:%
%:%3194=1117%:%
%:%3195=1117%:%
%:%3196=1118%:%
%:%3197=1119%:%
%:%3198=1119%:%
%:%3199=1120%:%
%:%3200=1120%:%
%:%3201=1121%:%
%:%3202=1121%:%
%:%3203=1122%:%
%:%3204=1123%:%
%:%3205=1123%:%
%:%3206=1124%:%
%:%3207=1124%:%
%:%3208=1125%:%
%:%3209=1126%:%
%:%3210=1126%:%
%:%3211=1127%:%
%:%3212=1127%:%
%:%3213=1128%:%
%:%3214=1129%:%
%:%3215=1129%:%
%:%3216=1130%:%
%:%3217=1130%:%
%:%3218=1130%:%
%:%3219=1131%:%
%:%3220=1131%:%
%:%3221=1132%:%
%:%3222=1132%:%
%:%3223=1132%:%
%:%3224=1133%:%
%:%3225=1133%:%
%:%3226=1134%:%
%:%3227=1134%:%
%:%3228=1134%:%
%:%3229=1135%:%
%:%3230=1135%:%
%:%3231=1135%:%
%:%3232=1136%:%
%:%3233=1136%:%
%:%3234=1136%:%
%:%3235=1137%:%
%:%3236=1137%:%
%:%3237=1137%:%
%:%3238=1138%:%
%:%3239=1138%:%
%:%3240=1138%:%
%:%3241=1139%:%
%:%3242=1139%:%
%:%3243=1140%:%
%:%3244=1140%:%
%:%3245=1140%:%
%:%3246=1141%:%
%:%3247=1141%:%
%:%3248=1142%:%
%:%3249=1142%:%
%:%3250=1142%:%
%:%3251=1143%:%
%:%3252=1143%:%
%:%3253=1143%:%
%:%3254=1144%:%
%:%3255=1144%:%
%:%3256=1144%:%
%:%3257=1145%:%
%:%3258=1145%:%
%:%3259=1146%:%
%:%3260=1146%:%
%:%3261=1146%:%
%:%3262=1147%:%
%:%3263=1147%:%
%:%3264=1148%:%
%:%3265=1148%:%
%:%3266=1148%:%
%:%3267=1149%:%
%:%3268=1149%:%
%:%3269=1150%:%
%:%3270=1150%:%
%:%3271=1150%:%
%:%3272=1151%:%
%:%3273=1151%:%
%:%3274=1152%:%
%:%3275=1152%:%
%:%3276=1152%:%
%:%3277=1153%:%
%:%3278=1153%:%
%:%3279=1154%:%
%:%3280=1154%:%
%:%3281=1154%:%
%:%3282=1155%:%
%:%3283=1155%:%
%:%3284=1156%:%
%:%3285=1156%:%
%:%3286=1156%:%
%:%3287=1157%:%
%:%3288=1157%:%
%:%3289=1158%:%
%:%3290=1158%:%
%:%3291=1158%:%
%:%3292=1158%:%
%:%3293=1159%:%
%:%3294=1159%:%
%:%3295=1160%:%
%:%3296=1160%:%
%:%3297=1161%:%
%:%3298=1161%:%
%:%3299=1162%:%
%:%3300=1162%:%
%:%3301=1163%:%
%:%3302=1163%:%
%:%3303=1164%:%
%:%3304=1164%:%
%:%3305=1165%:%
%:%3306=1166%:%
%:%3307=1166%:%
%:%3308=1167%:%
%:%3309=1167%:%
%:%3310=1168%:%
%:%3311=1169%:%
%:%3312=1169%:%
%:%3313=1170%:%
%:%3314=1170%:%
%:%3315=1170%:%
%:%3316=1171%:%
%:%3317=1171%:%
%:%3318=1171%:%
%:%3319=1172%:%
%:%3320=1172%:%
%:%3321=1172%:%
%:%3322=1173%:%
%:%3323=1173%:%
%:%3324=1174%:%
%:%3325=1174%:%
%:%3326=1174%:%
%:%3327=1175%:%
%:%3328=1175%:%
%:%3329=1176%:%
%:%3330=1176%:%
%:%3331=1176%:%
%:%3332=1177%:%
%:%3333=1177%:%
%:%3334=1178%:%
%:%3335=1178%:%
%:%3336=1178%:%
%:%3337=1179%:%
%:%3338=1179%:%
%:%3339=1179%:%
%:%3340=1180%:%
%:%3341=1180%:%
%:%3342=1180%:%
%:%3343=1181%:%
%:%3344=1181%:%
%:%3345=1182%:%
%:%3346=1182%:%
%:%3347=1182%:%
%:%3348=1183%:%
%:%3349=1183%:%
%:%3350=1183%:%
%:%3351=1184%:%
%:%3352=1184%:%
%:%3353=1184%:%
%:%3354=1185%:%
%:%3355=1185%:%
%:%3356=1186%:%
%:%3357=1186%:%
%:%3358=1186%:%
%:%3359=1187%:%
%:%3360=1187%:%
%:%3361=1187%:%
%:%3362=1188%:%
%:%3363=1188%:%
%:%3364=1188%:%
%:%3365=1189%:%
%:%3366=1189%:%
%:%3367=1190%:%
%:%3368=1190%:%
%:%3369=1190%:%
%:%3370=1191%:%
%:%3371=1191%:%
%:%3372=1192%:%
%:%3373=1192%:%
%:%3374=1192%:%
%:%3375=1193%:%
%:%3376=1193%:%
%:%3377=1194%:%
%:%3378=1194%:%
%:%3379=1194%:%
%:%3380=1195%:%
%:%3381=1195%:%
%:%3382=1196%:%
%:%3383=1196%:%
%:%3384=1196%:%
%:%3385=1196%:%
%:%3386=1197%:%
%:%3387=1197%:%
%:%3388=1198%:%
%:%3389=1198%:%
%:%3390=1199%:%
%:%3391=1199%:%
%:%3392=1200%:%
%:%3393=1200%:%
%:%3394=1201%:%
%:%3400=1201%:%
%:%3403=1202%:%
%:%3404=1203%:%
%:%3405=1203%:%
%:%3406=1204%:%
%:%3407=1205%:%
%:%3414=1206%:%
%:%3415=1206%:%
%:%3416=1207%:%
%:%3417=1207%:%
%:%3418=1208%:%
%:%3419=1208%:%
%:%3420=1208%:%
%:%3421=1209%:%
%:%3422=1209%:%
%:%3423=1210%:%
%:%3424=1210%:%
%:%3425=1210%:%
%:%3426=1211%:%
%:%3427=1211%:%
%:%3428=1212%:%
%:%3429=1212%:%
%:%3430=1213%:%
%:%3431=1213%:%
%:%3432=1214%:%
%:%3433=1214%:%
%:%3434=1214%:%
%:%3435=1215%:%
%:%3436=1215%:%
%:%3437=1216%:%
%:%3438=1216%:%
%:%3439=1216%:%
%:%3440=1217%:%
%:%3441=1218%:%
%:%3442=1218%:%
%:%3443=1219%:%
%:%3444=1219%:%
%:%3445=1220%:%
%:%3446=1220%:%
%:%3447=1221%:%
%:%3448=1221%:%
%:%3449=1221%:%
%:%3450=1222%:%
%:%3451=1222%:%
%:%3452=1222%:%
%:%3453=1223%:%
%:%3454=1223%:%
%:%3455=1223%:%
%:%3456=1224%:%
%:%3457=1224%:%
%:%3458=1224%:%
%:%3459=1225%:%
%:%3460=1225%:%
%:%3461=1226%:%
%:%3462=1226%:%
%:%3463=1226%:%
%:%3464=1227%:%
%:%3465=1227%:%
%:%3466=1228%:%
%:%3467=1228%:%
%:%3468=1228%:%
%:%3469=1229%:%
%:%3470=1229%:%
%:%3471=1230%:%
%:%3472=1230%:%
%:%3473=1230%:%
%:%3474=1231%:%
%:%3475=1231%:%
%:%3476=1231%:%
%:%3477=1232%:%
%:%3478=1232%:%
%:%3479=1232%:%
%:%3480=1233%:%
%:%3481=1233%:%
%:%3482=1233%:%
%:%3483=1234%:%
%:%3484=1234%:%
%:%3485=1234%:%
%:%3486=1234%:%
%:%3487=1235%:%
%:%3488=1235%:%
%:%3489=1236%:%
%:%3490=1237%:%
%:%3491=1237%:%
%:%3492=1238%:%
%:%3493=1238%:%
%:%3494=1239%:%
%:%3495=1239%:%
%:%3496=1240%:%
%:%3497=1240%:%
%:%3498=1240%:%
%:%3499=1241%:%
%:%3500=1241%:%
%:%3501=1241%:%
%:%3502=1242%:%
%:%3503=1242%:%
%:%3504=1242%:%
%:%3505=1243%:%
%:%3506=1243%:%
%:%3507=1243%:%
%:%3508=1244%:%
%:%3509=1244%:%
%:%3510=1245%:%
%:%3511=1245%:%
%:%3512=1245%:%
%:%3513=1246%:%
%:%3514=1246%:%
%:%3515=1247%:%
%:%3516=1247%:%
%:%3517=1247%:%
%:%3518=1248%:%
%:%3519=1248%:%
%:%3520=1249%:%
%:%3521=1249%:%
%:%3522=1249%:%
%:%3523=1250%:%
%:%3524=1250%:%
%:%3525=1250%:%
%:%3526=1251%:%
%:%3527=1251%:%
%:%3528=1251%:%
%:%3529=1252%:%
%:%3530=1252%:%
%:%3531=1252%:%
%:%3532=1253%:%
%:%3533=1253%:%
%:%3534=1253%:%
%:%3535=1253%:%
%:%3536=1254%:%
%:%3537=1254%:%
%:%3538=1255%:%
%:%3539=1255%:%
%:%3540=1256%:%
%:%3541=1256%:%
%:%3542=1257%:%
%:%3548=1257%:%
%:%3551=1258%:%
%:%3552=1259%:%
%:%3553=1259%:%
%:%3554=1260%:%
%:%3555=1261%:%
%:%3558=1262%:%
%:%3562=1262%:%
%:%3563=1262%:%
%:%3568=1262%:%
%:%3571=1263%:%
%:%3572=1264%:%
%:%3573=1264%:%
%:%3574=1265%:%
%:%3575=1266%:%
%:%3578=1267%:%
%:%3582=1267%:%
%:%3583=1267%:%
%:%3588=1267%:%
%:%3591=1268%:%
%:%3592=1269%:%
%:%3593=1269%:%
%:%3594=1270%:%
%:%3595=1271%:%
%:%3598=1272%:%
%:%3602=1272%:%
%:%3603=1272%:%
%:%3604=1272%:%
%:%3609=1272%:%
%:%3612=1273%:%
%:%3613=1274%:%
%:%3614=1274%:%
%:%3615=1275%:%
%:%3616=1276%:%
%:%3619=1277%:%
%:%3623=1277%:%
%:%3624=1277%:%
%:%3629=1277%:%
%:%3632=1278%:%
%:%3633=1279%:%
%:%3634=1279%:%
%:%3635=1280%:%
%:%3636=1281%:%
%:%3639=1282%:%
%:%3643=1282%:%
%:%3644=1282%:%
%:%3653=1284%:%
%:%3655=1285%:%
%:%3656=1285%:%
%:%3657=1286%:%
%:%3658=1287%:%
%:%3659=1288%:%
%:%3660=1288%:%
%:%3661=1289%:%
%:%3668=1290%:%
%:%3669=1290%:%
%:%3670=1291%:%
%:%3671=1291%:%
%:%3672=1292%:%
%:%3673=1293%:%
%:%3674=1294%:%
%:%3675=1294%:%
%:%3676=1295%:%
%:%3677=1295%:%
%:%3678=1296%:%
%:%3679=1296%:%
%:%3680=1297%:%
%:%3681=1297%:%
%:%3682=1298%:%
%:%3683=1298%:%
%:%3684=1299%:%
%:%3685=1299%:%
%:%3686=1299%:%
%:%3687=1299%:%
%:%3688=1300%:%
%:%3689=1300%:%
%:%3690=1300%:%
%:%3691=1301%:%
%:%3692=1301%:%
%:%3693=1301%:%
%:%3694=1301%:%
%:%3695=1302%:%
%:%3696=1302%:%
%:%3697=1302%:%
%:%3698=1303%:%
%:%3699=1303%:%
%:%3700=1304%:%
%:%3701=1304%:%
%:%3702=1305%:%
%:%3703=1305%:%
%:%3704=1306%:%
%:%3705=1306%:%
%:%3706=1307%:%
%:%3707=1307%:%
%:%3708=1308%:%
%:%3709=1308%:%
%:%3710=1309%:%
%:%3711=1309%:%
%:%3712=1310%:%
%:%3713=1310%:%
%:%3714=1310%:%
%:%3715=1311%:%
%:%3716=1311%:%
%:%3717=1311%:%
%:%3718=1312%:%
%:%3719=1313%:%
%:%3720=1313%:%
%:%3721=1314%:%
%:%3722=1314%:%
%:%3723=1314%:%
%:%3724=1315%:%
%:%3725=1315%:%
%:%3726=1316%:%
%:%3727=1317%:%
%:%3728=1317%:%
%:%3729=1318%:%
%:%3730=1318%:%
%:%3731=1319%:%
%:%3732=1320%:%
%:%3733=1320%:%
%:%3734=1320%:%
%:%3735=1321%:%
%:%3736=1321%:%
%:%3737=1321%:%
%:%3738=1322%:%
%:%3739=1323%:%
%:%3740=1323%:%
%:%3741=1324%:%
%:%3742=1324%:%
%:%3743=1324%:%
%:%3744=1325%:%
%:%3745=1326%:%
%:%3746=1326%:%
%:%3747=1327%:%
%:%3748=1327%:%
%:%3749=1327%:%
%:%3750=1328%:%
%:%3751=1329%:%
%:%3752=1329%:%
%:%3753=1330%:%
%:%3754=1330%:%
%:%3755=1330%:%
%:%3756=1330%:%
%:%3757=1331%:%
%:%3758=1331%:%
%:%3759=1332%:%
%:%3760=1332%:%
%:%3761=1333%:%
%:%3762=1334%:%
%:%3763=1334%:%
%:%3764=1335%:%
%:%3765=1335%:%
%:%3766=1336%:%
%:%3767=1337%:%
%:%3768=1337%:%
%:%3769=1337%:%
%:%3770=1338%:%
%:%3771=1338%:%
%:%3772=1338%:%
%:%3773=1339%:%
%:%3774=1340%:%
%:%3775=1340%:%
%:%3776=1341%:%
%:%3777=1341%:%
%:%3778=1341%:%
%:%3779=1342%:%
%:%3780=1343%:%
%:%3781=1343%:%
%:%3782=1344%:%
%:%3783=1344%:%
%:%3784=1344%:%
%:%3785=1345%:%
%:%3786=1346%:%
%:%3787=1346%:%
%:%3788=1347%:%
%:%3789=1347%:%
%:%3790=1347%:%
%:%3791=1347%:%
%:%3792=1348%:%
%:%3793=1348%:%
%:%3794=1349%:%
%:%3795=1349%:%
%:%3796=1350%:%
%:%3797=1351%:%
%:%3798=1351%:%
%:%3799=1351%:%
%:%3800=1352%:%
%:%3801=1352%:%
%:%3802=1352%:%
%:%3803=1353%:%
%:%3804=1354%:%
%:%3805=1354%:%
%:%3806=1354%:%
%:%3807=1355%:%
%:%3808=1355%:%
%:%3809=1356%:%
%:%3810=1356%:%
%:%3811=1357%:%
%:%3812=1357%:%
%:%3813=1358%:%
%:%3814=1358%:%
%:%3815=1359%:%
%:%3816=1359%:%
%:%3817=1359%:%
%:%3818=1360%:%
%:%3819=1360%:%
%:%3820=1360%:%
%:%3821=1361%:%
%:%3822=1361%:%
%:%3823=1361%:%
%:%3824=1362%:%
%:%3825=1362%:%
%:%3826=1362%:%
%:%3827=1363%:%
%:%3828=1363%:%
%:%3829=1364%:%
%:%3830=1364%:%
%:%3831=1365%:%
%:%3832=1365%:%
%:%3833=1365%:%
%:%3834=1366%:%
%:%3835=1366%:%
%:%3836=1366%:%
%:%3837=1367%:%
%:%3838=1367%:%
%:%3839=1368%:%
%:%3840=1368%:%
%:%3841=1369%:%
%:%3842=1369%:%
%:%3843=1370%:%
%:%3844=1370%:%
%:%3845=1371%:%
%:%3846=1371%:%
%:%3847=1371%:%
%:%3848=1372%:%
%:%3849=1372%:%
%:%3850=1372%:%
%:%3851=1373%:%
%:%3852=1373%:%
%:%3853=1373%:%
%:%3854=1374%:%
%:%3855=1374%:%
%:%3856=1374%:%
%:%3857=1375%:%
%:%3858=1375%:%
%:%3859=1375%:%
%:%3860=1376%:%
%:%3861=1376%:%
%:%3862=1376%:%
%:%3863=1377%:%
%:%3864=1377%:%
%:%3865=1377%:%
%:%3866=1378%:%
%:%3867=1378%:%
%:%3868=1378%:%
%:%3869=1379%:%
%:%3870=1379%:%
%:%3871=1380%:%
%:%3872=1380%:%
%:%3873=1380%:%
%:%3874=1381%:%
%:%3875=1381%:%
%:%3876=1381%:%
%:%3877=1382%:%
%:%3878=1382%:%
%:%3879=1382%:%
%:%3880=1383%:%
%:%3881=1383%:%
%:%3882=1383%:%
%:%3883=1384%:%
%:%3884=1384%:%
%:%3885=1384%:%
%:%3886=1384%:%
%:%3887=1385%:%
%:%3888=1385%:%
%:%3889=1386%:%
%:%3890=1386%:%
%:%3891=1387%:%
%:%3892=1387%:%
%:%3893=1387%:%
%:%3894=1388%:%
%:%3895=1388%:%
%:%3896=1388%:%
%:%3897=1389%:%
%:%3898=1389%:%
%:%3899=1390%:%
%:%3900=1390%:%
%:%3901=1390%:%
%:%3902=1391%:%
%:%3903=1391%:%
%:%3904=1391%:%
%:%3905=1392%:%
%:%3906=1392%:%
%:%3907=1392%:%
%:%3908=1393%:%
%:%3909=1393%:%
%:%3910=1393%:%
%:%3911=1394%:%
%:%3912=1394%:%
%:%3913=1394%:%
%:%3914=1395%:%
%:%3915=1395%:%
%:%3916=1395%:%
%:%3917=1396%:%
%:%3918=1396%:%
%:%3919=1396%:%
%:%3920=1397%:%
%:%3921=1397%:%
%:%3922=1397%:%
%:%3923=1398%:%
%:%3924=1398%:%
%:%3925=1399%:%
%:%3926=1399%:%
%:%3927=1399%:%
%:%3928=1400%:%
%:%3929=1400%:%
%:%3930=1400%:%
%:%3931=1401%:%
%:%3932=1401%:%
%:%3933=1401%:%
%:%3934=1402%:%
%:%3935=1402%:%
%:%3936=1402%:%
%:%3937=1403%:%
%:%3938=1403%:%
%:%3939=1403%:%
%:%3940=1404%:%
%:%3941=1404%:%
%:%3942=1405%:%
%:%3943=1405%:%
%:%3944=1406%:%
%:%3945=1406%:%
%:%3946=1407%:%
%:%3947=1407%:%
%:%3948=1407%:%
%:%3949=1408%:%
%:%3950=1408%:%
%:%3951=1408%:%
%:%3952=1409%:%
%:%3953=1409%:%
%:%3954=1410%:%
%:%3955=1410%:%
%:%3956=1411%:%
%:%3957=1411%:%
%:%3958=1412%:%
%:%3959=1412%:%
%:%3960=1412%:%
%:%3961=1413%:%
%:%3962=1413%:%
%:%3963=1413%:%
%:%3964=1414%:%
%:%3965=1414%:%
%:%3966=1415%:%
%:%3967=1415%:%
%:%3968=1416%:%
%:%3969=1416%:%
%:%3970=1417%:%
%:%3971=1417%:%
%:%3972=1418%:%
%:%3973=1418%:%
%:%3974=1418%:%
%:%3975=1418%:%
%:%3976=1419%:%
%:%3977=1419%:%
%:%3978=1419%:%
%:%3979=1420%:%
%:%3980=1420%:%
%:%3981=1420%:%
%:%3982=1421%:%
%:%3983=1421%:%
%:%3984=1421%:%
%:%3985=1422%:%
%:%3986=1422%:%
%:%3987=1422%:%
%:%3988=1423%:%
%:%3989=1423%:%
%:%3990=1424%:%
%:%3991=1425%:%
%:%3992=1425%:%
%:%3993=1426%:%
%:%3994=1427%:%
%:%3995=1427%:%
%:%3996=1428%:%
%:%3997=1428%:%
%:%3998=1429%:%
%:%3999=1429%:%
%:%4000=1430%:%
%:%4001=1430%:%
%:%4002=1431%:%
%:%4003=1431%:%
%:%4004=1432%:%
%:%4005=1432%:%
%:%4006=1432%:%
%:%4007=1433%:%
%:%4008=1433%:%
%:%4009=1434%:%
%:%4010=1434%:%
%:%4011=1434%:%
%:%4012=1435%:%
%:%4013=1435%:%
%:%4014=1436%:%
%:%4015=1436%:%
%:%4016=1436%:%
%:%4017=1437%:%
%:%4018=1437%:%
%:%4019=1438%:%
%:%4020=1438%:%
%:%4021=1438%:%
%:%4022=1439%:%
%:%4023=1439%:%
%:%4024=1440%:%
%:%4025=1440%:%
%:%4026=1440%:%
%:%4027=1441%:%
%:%4028=1441%:%
%:%4029=1441%:%
%:%4030=1442%:%
%:%4031=1442%:%
%:%4032=1442%:%
%:%4033=1443%:%
%:%4034=1443%:%
%:%4035=1444%:%
%:%4036=1444%:%
%:%4037=1444%:%
%:%4038=1445%:%
%:%4039=1445%:%
%:%4040=1446%:%
%:%4041=1446%:%
%:%4042=1446%:%
%:%4043=1447%:%
%:%4044=1447%:%
%:%4045=1448%:%
%:%4046=1448%:%
%:%4047=1448%:%
%:%4048=1449%:%
%:%4049=1449%:%
%:%4050=1449%:%
%:%4051=1450%:%
%:%4052=1450%:%
%:%4053=1450%:%
%:%4054=1450%:%
%:%4055=1451%:%
%:%4056=1451%:%
%:%4057=1452%:%
%:%4058=1452%:%
%:%4059=1453%:%
%:%4060=1453%:%
%:%4061=1454%:%
%:%4062=1454%:%
%:%4063=1455%:%
%:%4064=1455%:%
%:%4065=1456%:%
%:%4066=1456%:%
%:%4067=1456%:%
%:%4068=1457%:%
%:%4069=1457%:%
%:%4070=1458%:%
%:%4071=1458%:%
%:%4072=1458%:%
%:%4073=1459%:%
%:%4074=1459%:%
%:%4075=1460%:%
%:%4076=1460%:%
%:%4077=1460%:%
%:%4078=1461%:%
%:%4079=1461%:%
%:%4080=1462%:%
%:%4081=1462%:%
%:%4082=1462%:%
%:%4083=1463%:%
%:%4084=1463%:%
%:%4085=1464%:%
%:%4086=1464%:%
%:%4087=1464%:%
%:%4088=1465%:%
%:%4089=1465%:%
%:%4090=1465%:%
%:%4091=1466%:%
%:%4092=1466%:%
%:%4093=1466%:%
%:%4094=1467%:%
%:%4095=1467%:%
%:%4096=1468%:%
%:%4097=1468%:%
%:%4098=1468%:%
%:%4099=1469%:%
%:%4100=1469%:%
%:%4101=1470%:%
%:%4102=1470%:%
%:%4103=1470%:%
%:%4104=1471%:%
%:%4105=1471%:%
%:%4106=1472%:%
%:%4107=1472%:%
%:%4108=1472%:%
%:%4109=1473%:%
%:%4110=1473%:%
%:%4111=1473%:%
%:%4112=1474%:%
%:%4113=1474%:%
%:%4114=1474%:%
%:%4115=1474%:%
%:%4116=1475%:%
%:%4117=1475%:%
%:%4118=1476%:%
%:%4119=1476%:%
%:%4120=1477%:%
%:%4121=1477%:%
%:%4122=1477%:%
%:%4123=1478%:%
%:%4124=1478%:%
%:%4125=1478%:%
%:%4126=1479%:%
%:%4127=1479%:%
%:%4128=1479%:%
%:%4129=1480%:%
%:%4130=1480%:%
%:%4131=1481%:%
%:%4132=1481%:%
%:%4133=1481%:%
%:%4134=1482%:%
%:%4135=1482%:%
%:%4136=1483%:%
%:%4137=1483%:%
%:%4138=1483%:%
%:%4139=1484%:%
%:%4140=1484%:%
%:%4141=1485%:%
%:%4142=1485%:%
%:%4143=1485%:%
%:%4144=1486%:%
%:%4145=1486%:%
%:%4146=1486%:%
%:%4147=1487%:%
%:%4153=1487%:%
%:%4158=1488%:%
%:%4163=1489%:%
