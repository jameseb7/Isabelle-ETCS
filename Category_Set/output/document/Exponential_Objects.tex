%
\begin{isabellebody}%
\setisabellecontext{Exponential{\isacharunderscore}{\kern0pt}Objects}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Exponential Objects, Transposes and Evaluation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Exponential{\isacharunderscore}{\kern0pt}Objects\isanewline
\ \ \isakeyword{imports}\ Initial\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
The axiomatization below corresponds to Axiom 9 (Exponential Objects) in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{axiomatization}\isamarkupfalse%
\isanewline
\ \ exp{\isacharunderscore}{\kern0pt}set\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsup {\isacharunderscore}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{and}\isanewline
\ \ eval{\isacharunderscore}{\kern0pt}func\ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isakeyword{where}\isanewline
\ \ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\isactrlbsup A\isactrlesup \ {\isacharequal}{\kern0pt}\ Y\isactrlbsup B\isactrlesup \ {\isasymLongrightarrow}\ X\ {\isacharequal}{\kern0pt}\ Y\ {\isasymand}\ A\ {\isacharequal}{\kern0pt}\ B{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub c\ X\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub cZ\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ g{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymLongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}surj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ codomain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ a\ \isakeyword{where}\ a{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ nonempty{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ needed{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isasymrangle}\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ a{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ comp{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}y{\isachardot}{\kern0pt}\ y\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymand}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ y\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ needed{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to a note above Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}injective{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Lifting Functions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlbsup {\isacharunderscore}{\kern0pt}\isactrlesup \isactrlsub f{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}func\ g\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}func\ g\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharcolon}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to a note below Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}square{\isacharunderscore}{\kern0pt}diagram{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.2 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y\ {\isasymand}\ g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\ \ {\isasymLongrightarrow}\ \ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ right{\isacharunderscore}{\kern0pt}eq\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharequal}{\kern0pt}\ id\isactrlsub c{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to comments below Proposition 2.5.2 and above Definition 2.5.3 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}x{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isacharcomma}{\kern0pt}x{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{1}}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}type\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Inverse Transpose Function (flat)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.3 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlsup {\isasymflat}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ g{\isachardot}{\kern0pt}\ {\isasymexists}\ Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}Z\ Y\ B{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ Y\isactrlbsup B\isactrlesup \ {\isasymand}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ f{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.4 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.5 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.6 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}\ g{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ {\isasymlongrightarrow}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ f{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ uniqueness\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ f\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X{\isacharequal}{\kern0pt}X{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A{\isacharequal}{\kern0pt}A{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}epimorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ equals{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}surj\ epi{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}surj\ id{\isacharunderscore}{\kern0pt}isomorphism\ id{\isacharunderscore}{\kern0pt}type\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}surj\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}codomain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ domain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ composition{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epi\ equals\ eval{\isacharunderscore}{\kern0pt}epi\ idA{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}epi{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}injective\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}injective{\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mono{\isacharunderscore}{\kern0pt}g{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}monomorphism\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ CollectI\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ \ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ \ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ x{\isacharunderscore}{\kern0pt}type\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ presburger\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ assms\ eqs\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ force\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ eqs\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ flat{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ mono{\isacharunderscore}{\kern0pt}g\ flat{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}injective{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isasymexists}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlesub {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ x\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlesub {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ evals{\isacharunderscore}{\kern0pt}equal{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ a\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\isactrlbsup {\isasymone}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ A\ \isakeyword{where}\ a{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymand}\ a\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ A{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ a{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ eval{\isacharunderscore}{\kern0pt}dom\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ B\ \isakeyword{where}\ b{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymand}\ b\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ B{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ b{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ eval{\isacharunderscore}{\kern0pt}dom\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}\ {\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}A\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ evals{\isacharunderscore}{\kern0pt}equal{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}B\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ b{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ {\isasymone}{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ swap{\isacharunderscore}{\kern0pt}def\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ diagonal{\isacharunderscore}{\kern0pt}def\ diagonal{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ swap{\isacharunderscore}{\kern0pt}idempotent\ swap{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ injective{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
In the lemma below, the nonempty assumption is required.
      Consider, for example, \isa{X\ {\isacharequal}{\kern0pt}\ {\isasymOmega}} and \isa{A\ {\isacharequal}{\kern0pt}\ {\isasymemptyset}}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ \ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\ h\ U\ Y\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ equals{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Y\ {\isacharequal}{\kern0pt}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}XA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ g{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ h{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idg{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ U\ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idh{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ U\ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ epic{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ nonempty{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \isacommand{have}\isamarkupfalse%
\ fIdg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fIdh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ idg{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ equals{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ calculation\ equals\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ idg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}idh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ fIdg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fIdh\ idg{\isacharunderscore}{\kern0pt}type\ idh{\isacharunderscore}{\kern0pt}type\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ epic\ epimorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Metafunctions and their Inverses (Cnufatems)%
}
\isamarkuptrue%
%
\isamarkupsubsubsection{Metafunctions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ metafunc\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}metafunc\ f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ \ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Inverse Metafunctions (Cnufatems)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ cnufatem\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}cnufatem\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ g{\isachardot}{\kern0pt}\ {\isasymforall}\ Y\ X{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ theI{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isacharcolon}{\kern0pt}\ X\ \ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}metafunc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ \ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}lemma\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ X{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isasymin}\isactrlsub c\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}lemma\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X\ {\isasymcirc}\isactrlsub c\ x\ {\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymbeta}\isactrlbsub X\isactrlesub \ {\isasymcirc}\isactrlsub c\ x{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}elem{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X\ {\isasymcirc}\isactrlsub c\ x\ {\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}elem\ x{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ calculation\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Metafunction Composition%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymbox}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ f\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ h{\isachardot}{\kern0pt}\ {\isasymexists}\ W\ X\ Y{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup \ {\isasymand}\ h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ the{\isacharunderscore}{\kern0pt}equality{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}elements{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharequal}{\kern0pt}\ \ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}id\isactrlsub c\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharequal}{\kern0pt}\ metafunc\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}cnufatem\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Z{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ \ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ id{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}elements{\isacharunderscore}{\kern0pt}aux\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}type\ domain{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{4}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ \ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ \ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ \ {\isasymtimes}\isactrlsub f\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ \ {\isasymin}\isactrlsub c\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ {\isasymone}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ id{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\ {\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ \ f\ {\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}{\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}{\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}{\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}\ x\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}{\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}\ x\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ x{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\isanewline
\ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ \ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ sharp{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}type\ domain{\isacharunderscore}{\kern0pt}comp\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}els{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}w\ {\isasymin}\isactrlsub c\ W{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ \ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ calculation\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isanewline
\ \ \ \ \ \ \ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub cw{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub cw{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isasymone}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{5}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ \ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ W{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ w\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\isactrlsub c\ W{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ w{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ w{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}els{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ X\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isasymbox}\ metafunc\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ cnufatem{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ X\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc{\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isasymbox}\ g\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ cnufatem{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}metacomp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ cnufatem{\isacharparenleft}{\kern0pt}metafunc\ f\ {\isasymbox}\ metafunc\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metacomp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isasymcirc}\isactrlsub c\ cnufatem\ g\ {\isacharequal}{\kern0pt}\ cnufatem{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}metacomp\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ A\isactrlbsup Z\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymbox}\ f{\isacharparenright}{\kern0pt}\ {\isasymbox}\ \ g\ \ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymbox}\ f{\isacharparenright}{\kern0pt}\ {\isasymbox}\ \ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymbox}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\ \ \ \ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}\ {\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Partially Parameterized Functions on Pairs%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}param\ k\ p\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}THE\ f{\isachardot}{\kern0pt}\ \ {\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ f\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ left{\isacharunderscore}{\kern0pt}param\ k\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ the{\isadigit{1}}I{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ assms{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isacharcolon}{\kern0pt}\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}el{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}right\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}param\ k\ q\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}THE\ f{\isachardot}{\kern0pt}\ \ {\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ f\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}param\ k\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ insert\ assms{\isacharcomma}{\kern0pt}\ auto{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ P{\isacharcomma}{\kern0pt}q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isacharcolon}{\kern0pt}\ P\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}el{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ p{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Exponential Set Facts%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.7 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}defn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ e{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ i{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}inv\ \isakeyword{where}\ i{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharunderscore}{\kern0pt}inv{\isacharcolon}{\kern0pt}\ {\isasymone}{\isasymrightarrow}\ \ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymand}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i{\isacharunderscore}{\kern0pt}inv\ {\isasymcirc}\isactrlsub c\ i\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}diagonal\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ diagonal{\isacharunderscore}{\kern0pt}def\ i{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharunderscore}{\kern0pt}inv{\isacharcolon}{\kern0pt}\ {\isasymone}{\isasymrightarrow}\ \ {\isasymone}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ inj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}injective{\isacharparenleft}{\kern0pt}e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ e{\isacharunderscore}{\kern0pt}defn\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}injective{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ surj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ codomain\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ e{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ witness{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymone}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv\ {\isasymin}\isactrlsub c\ {\isasymone}\ {\isasymtimes}\isactrlsub c\ X\isactrlbsup {\isasymone}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ square{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ y\ {\isasymcirc}\isactrlsub c\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}defn\ i{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ y{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ domain\ e\ {\isasymand}\ e\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}type\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ i{\isacharunderscore}{\kern0pt}iso\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ inj\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism\ surj\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\isactrlbsup {\isasymone}\isactrlesup \ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ one{\isacharunderscore}{\kern0pt}x{\isacharunderscore}{\kern0pt}A{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.8 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isasymalpha}\isactrlbsub X\isactrlesub {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymemptyset}\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}z{\isachardot}{\kern0pt}\ z\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymlongrightarrow}\ z{\isacharequal}{\kern0pt}f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ z{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ j{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}j{\isacharcolon}{\kern0pt}{\isasymemptyset}\ {\isasymrightarrow}\ {\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ empty{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}X\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ psi{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharcolon}{\kern0pt}\ {\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ {\isasymrightarrow}\ {\isasymemptyset}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ j\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ j{\isacharunderscore}{\kern0pt}iso\ \isacommand{by}\isamarkupfalse%
\ fastforce\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ z\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}type\ emptyset{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ fsharp{\isacharunderscore}{\kern0pt}type\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ z{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}{\kern0pt}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ ex{\isadigit{1}}I{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymone}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ nonempty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}{\isasymone}\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ nonempty{\isacharunderscore}{\kern0pt}def\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}defn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ {\isasymone}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ e{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isasymin}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\ \ {\isasymrightarrow}\ {\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniquess{\isacharunderscore}{\kern0pt}form{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isasymin}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymbeta}\isactrlbsub X\ {\isasymtimes}\isactrlsub c\ {\isasymone}\isactrlesub {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique\ uniqueness\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ ex{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}{\isacharbang}{\kern0pt}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ {\isasymone}\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ e{\isacharunderscore}{\kern0pt}defn\ nonempty\ nonempty{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique\ uniqueness{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymone}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ex{\isadigit{1}}\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.9 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}rule{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymcong}\ X\isactrlbsup A\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ Z\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymand}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ safe{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ projection{\isacharunderscore}{\kern0pt}property{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ projection{\isacharunderscore}{\kern0pt}property{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ f\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ g\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ h\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ computation{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacartoucheclose}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ unqiueness{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ \ f\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ computation{\isadigit{1}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ \ \ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ computation{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}g\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isacartoucheclose}\ {\isacartoucheopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ unqiueness{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ \ g\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ computation{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}flat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ g\isactrlsup {\isasymflat}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ unqiueness{\isadigit{1}}\ unqiueness{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}fflat{\isacharunderscore}{\kern0pt}gflat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}\ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymcong}\ X\isactrlbsup A\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ cart{\isacharunderscore}{\kern0pt}prods{\isacharunderscore}{\kern0pt}isomorphic\ fst{\isacharunderscore}{\kern0pt}conv\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}distribution{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymcong}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ H\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ safe{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ h\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Z{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}xyh{\isachardot}{\kern0pt}\ xyh\ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ xyh\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ l{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xyh\ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ xy\ \isakeyword{and}\ z\ \isakeyword{where}\ xy{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isasymin}\isactrlsub c\ X\ {\isasymCoprod}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ z{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\isactrlsub c\ H{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isakeyword{and}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xyh\ {\isacharequal}{\kern0pt}\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ \ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ xy{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isacharequal}{\kern0pt}\ \ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharunderscore}{\kern0pt}left\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ \ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isacharcomma}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ xy{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isacharequal}{\kern0pt}\ \ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ coprojs{\isacharunderscore}{\kern0pt}jointly{\isacharunderscore}{\kern0pt}surj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharunderscore}{\kern0pt}right\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ \ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}eqs\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isacharcomma}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymamalg}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}right\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs\ g{\isacharunderscore}{\kern0pt}eqs\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ cart{\isacharunderscore}{\kern0pt}prods{\isacharunderscore}{\kern0pt}isomorphic\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ prod{\isachardot}{\kern0pt}sel{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ j{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}j{\isacharcolon}{\kern0pt}\ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymone}{\isasymtimes}\isactrlsub c\ {\isasymemptyset}\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\ j{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ one{\isacharunderscore}{\kern0pt}x{\isacharunderscore}{\kern0pt}A{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ nonempty{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e{\isacharcolon}{\kern0pt}\ X{\isasymtimes}\isactrlsub c\ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ iso{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymcirc}\isactrlsub c\ y\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ j\ {\isacharcolon}{\kern0pt}\ \ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}A\isactrlbsup Y\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ A\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}{\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ X\isactrlbsup Y\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ A\isactrlbsup Y\isactrlesup \ {\isasymrightarrow}\ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idXY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ calculation\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idAY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ calculation\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\ A{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ idA{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ \ {\isachardoublequoteopen}A\isactrlbsup Y\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ idAY\ idXY\ id{\isacharunderscore}{\kern0pt}isomorphism\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ expset{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}tower{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup \ {\isasymcong}\ A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ B\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}dbsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasympsi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharcolon}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasympsi}sharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup \ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}C{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}B{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ \ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacartoucheopen}{\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacartoucheclose}\ {\isacartoucheopen}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacartoucheclose}\ {\isasymphi}dbsharp{\isacharunderscore}{\kern0pt}type\ {\isasympsi}sharp{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup A\isactrlesup \ {\isasymcong}\ \ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ A\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}{\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ g\ \isakeyword{where}\ g{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ \ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ X{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ gsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}gsharp{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ A{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ f{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ g{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ idA\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ gsharp{\isacharunderscore}{\kern0pt}fsharp{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ X{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ fsharp{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ fsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ fsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ fsharp{\isacharunderscore}{\kern0pt}gsharp{\isacharunderscore}{\kern0pt}id\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}fsharp{\isacharunderscore}{\kern0pt}id\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}isomorphism\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}B\ {\isasymcong}\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}A\isactrlbsup B\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ empty{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}nonempty{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ exp{\isacharunderscore}{\kern0pt}empty\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nonempty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}nonempty\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ nonempty{\isacharunderscore}{\kern0pt}def\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharunderscore}{\kern0pt}converse{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y\ {\isasymand}\ nonempty\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ assms\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ nonempty{\isacharunderscore}{\kern0pt}def\ nonempty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.11 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ powerset\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymP}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}{\isasymP}\ X\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sets{\isacharunderscore}{\kern0pt}squared{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}A\isactrlbsup {\isasymOmega}\isactrlesup \ {\isasymcong}\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharcolon}{\kern0pt}\ A\isactrlbsup {\isasymOmega}\isactrlesup \ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isasymphi}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ {\isasymone}\ {\isasymLongrightarrow}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ A{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isasymOmega}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isakeyword{where}\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isasymand}\ a{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\ {\isasymand}\ a{\isadigit{2}}\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ eqs\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ g{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ g{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ g\ {\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{1}}\ equation{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ \ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub c\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ w\ i\ \isakeyword{where}\ \ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}w\ {\isasymin}\isactrlsub c\ {\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}i\ {\isasymin}\isactrlsub c\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}w{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}w\ {\isacharequal}{\kern0pt}\ {\isasymf}{\isacharparenright}{\kern0pt}\ {\isasymor}\ {\isacharparenleft}{\kern0pt}w\ {\isacharequal}{\kern0pt}\ {\isasymt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ true{\isacharunderscore}{\kern0pt}false{\isacharunderscore}{\kern0pt}only{\isacharunderscore}{\kern0pt}truth{\isacharunderscore}{\kern0pt}values\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymor}\ {\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ case{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{1}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymf}{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ false{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymf}{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{1}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ case{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}eq\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymt}{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ true{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymt}{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}eq\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation\ x{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}clarify{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ codomain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isasymand}\ a{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\ {\isasymand}\ a{\isadigit{2}}\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ aua{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isasymone}\ {\isasymCoprod}\ {\isasymone}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ {\isasymone}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ aua\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ a{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ true{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ aua\ f{\isacharunderscore}{\kern0pt}def\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ {\isasymt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}type\ aua\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ {\isasymone}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}true{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ a{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ false{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymf}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ {\isasymone}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymone}{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ aua\ f{\isacharunderscore}{\kern0pt}def\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ {\isasymf}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ aua\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ {\isasymone}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}false{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ \ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ a{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}is\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}\ {\isasymand}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}monomorphism\ {\isasymphi}{\isacartoucheclose}\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/ETCS/Category_Set/Exponential_Objects.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%39=7%:%
%:%41=8%:%
%:%42=8%:%
%:%43=9%:%
%:%44=10%:%
%:%45=11%:%
%:%46=12%:%
%:%47=13%:%
%:%48=14%:%
%:%49=15%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=19%:%
%:%54=20%:%
%:%55=20%:%
%:%56=21%:%
%:%57=22%:%
%:%60=23%:%
%:%64=23%:%
%:%65=23%:%
%:%66=24%:%
%:%67=24%:%
%:%68=25%:%
%:%69=25%:%
%:%70=26%:%
%:%71=26%:%
%:%72=27%:%
%:%73=27%:%
%:%74=27%:%
%:%75=28%:%
%:%76=28%:%
%:%77=28%:%
%:%78=29%:%
%:%79=29%:%
%:%80=30%:%
%:%81=30%:%
%:%82=30%:%
%:%83=31%:%
%:%84=31%:%
%:%85=32%:%
%:%86=32%:%
%:%87=32%:%
%:%88=33%:%
%:%89=33%:%
%:%90=34%:%
%:%91=35%:%
%:%92=35%:%
%:%93=36%:%
%:%94=36%:%
%:%95=36%:%
%:%96=37%:%
%:%97=37%:%
%:%98=38%:%
%:%99=38%:%
%:%100=38%:%
%:%101=39%:%
%:%102=39%:%
%:%103=40%:%
%:%104=40%:%
%:%105=40%:%
%:%106=41%:%
%:%107=41%:%
%:%108=41%:%
%:%109=42%:%
%:%110=42%:%
%:%111=42%:%
%:%112=43%:%
%:%113=43%:%
%:%114=43%:%
%:%115=44%:%
%:%116=44%:%
%:%117=44%:%
%:%118=45%:%
%:%119=45%:%
%:%120=45%:%
%:%121=46%:%
%:%131=48%:%
%:%133=49%:%
%:%134=49%:%
%:%135=50%:%
%:%138=51%:%
%:%142=51%:%
%:%143=51%:%
%:%148=51%:%
%:%151=52%:%
%:%152=53%:%
%:%153=53%:%
%:%154=54%:%
%:%155=55%:%
%:%158=56%:%
%:%162=56%:%
%:%163=56%:%
%:%164=57%:%
%:%165=57%:%
%:%179=59%:%
%:%191=61%:%
%:%193=62%:%
%:%194=62%:%
%:%195=63%:%
%:%196=64%:%
%:%197=65%:%
%:%198=65%:%
%:%199=66%:%
%:%200=67%:%
%:%203=68%:%
%:%207=68%:%
%:%208=68%:%
%:%209=68%:%
%:%214=68%:%
%:%217=69%:%
%:%218=70%:%
%:%219=70%:%
%:%220=71%:%
%:%221=72%:%
%:%224=73%:%
%:%228=73%:%
%:%229=73%:%
%:%230=73%:%
%:%235=73%:%
%:%238=74%:%
%:%239=75%:%
%:%240=75%:%
%:%241=76%:%
%:%244=77%:%
%:%248=77%:%
%:%249=77%:%
%:%258=79%:%
%:%260=80%:%
%:%261=80%:%
%:%262=81%:%
%:%263=82%:%
%:%266=83%:%
%:%270=83%:%
%:%271=83%:%
%:%272=83%:%
%:%281=85%:%
%:%283=86%:%
%:%284=86%:%
%:%285=87%:%
%:%286=88%:%
%:%293=89%:%
%:%294=89%:%
%:%295=90%:%
%:%296=90%:%
%:%297=91%:%
%:%298=91%:%
%:%299=91%:%
%:%300=92%:%
%:%301=92%:%
%:%302=93%:%
%:%303=93%:%
%:%304=94%:%
%:%305=94%:%
%:%306=95%:%
%:%307=96%:%
%:%308=96%:%
%:%309=97%:%
%:%310=97%:%
%:%311=97%:%
%:%312=98%:%
%:%313=98%:%
%:%314=99%:%
%:%315=99%:%
%:%316=99%:%
%:%317=100%:%
%:%318=100%:%
%:%319=101%:%
%:%320=101%:%
%:%321=101%:%
%:%322=102%:%
%:%323=102%:%
%:%324=103%:%
%:%325=103%:%
%:%326=104%:%
%:%327=104%:%
%:%328=105%:%
%:%329=105%:%
%:%330=105%:%
%:%331=106%:%
%:%337=106%:%
%:%340=107%:%
%:%341=108%:%
%:%342=108%:%
%:%343=109%:%
%:%346=110%:%
%:%350=110%:%
%:%351=110%:%
%:%360=112%:%
%:%362=113%:%
%:%363=113%:%
%:%364=114%:%
%:%367=115%:%
%:%371=115%:%
%:%372=115%:%
%:%373=115%:%
%:%378=115%:%
%:%381=116%:%
%:%382=116%:%
%:%383=117%:%
%:%384=118%:%
%:%387=119%:%
%:%391=119%:%
%:%392=119%:%
%:%397=119%:%
%:%400=120%:%
%:%401=121%:%
%:%402=121%:%
%:%403=122%:%
%:%404=123%:%
%:%405=124%:%
%:%408=125%:%
%:%412=125%:%
%:%413=125%:%
%:%414=125%:%
%:%428=127%:%
%:%440=129%:%
%:%442=130%:%
%:%443=130%:%
%:%444=131%:%
%:%445=132%:%
%:%446=133%:%
%:%447=133%:%
%:%448=134%:%
%:%449=135%:%
%:%452=136%:%
%:%456=136%:%
%:%457=136%:%
%:%458=137%:%
%:%459=137%:%
%:%460=138%:%
%:%461=138%:%
%:%462=139%:%
%:%463=139%:%
%:%464=139%:%
%:%465=140%:%
%:%466=140%:%
%:%467=141%:%
%:%468=141%:%
%:%469=142%:%
%:%470=142%:%
%:%471=143%:%
%:%472=143%:%
%:%473=143%:%
%:%474=144%:%
%:%475=144%:%
%:%476=145%:%
%:%482=145%:%
%:%485=146%:%
%:%486=147%:%
%:%487=147%:%
%:%488=148%:%
%:%489=149%:%
%:%492=150%:%
%:%496=150%:%
%:%497=150%:%
%:%502=150%:%
%:%505=151%:%
%:%506=152%:%
%:%507=152%:%
%:%508=153%:%
%:%509=154%:%
%:%512=155%:%
%:%516=155%:%
%:%517=155%:%
%:%526=157%:%
%:%528=158%:%
%:%529=158%:%
%:%530=159%:%
%:%531=160%:%
%:%534=161%:%
%:%538=161%:%
%:%539=161%:%
%:%540=162%:%
%:%541=162%:%
%:%550=164%:%
%:%552=165%:%
%:%553=165%:%
%:%554=166%:%
%:%557=167%:%
%:%561=167%:%
%:%562=167%:%
%:%563=167%:%
%:%572=169%:%
%:%574=170%:%
%:%575=170%:%
%:%576=171%:%
%:%583=172%:%
%:%584=172%:%
%:%585=173%:%
%:%586=173%:%
%:%587=174%:%
%:%588=174%:%
%:%589=174%:%
%:%590=175%:%
%:%591=175%:%
%:%592=176%:%
%:%593=176%:%
%:%594=177%:%
%:%595=177%:%
%:%596=178%:%
%:%597=178%:%
%:%598=178%:%
%:%599=179%:%
%:%600=179%:%
%:%601=179%:%
%:%602=180%:%
%:%608=180%:%
%:%611=181%:%
%:%612=182%:%
%:%613=182%:%
%:%614=183%:%
%:%615=184%:%
%:%618=185%:%
%:%622=185%:%
%:%623=185%:%
%:%628=185%:%
%:%631=186%:%
%:%632=187%:%
%:%633=187%:%
%:%634=188%:%
%:%635=189%:%
%:%642=190%:%
%:%643=190%:%
%:%644=191%:%
%:%645=192%:%
%:%646=192%:%
%:%647=193%:%
%:%648=193%:%
%:%649=193%:%
%:%650=194%:%
%:%651=194%:%
%:%652=194%:%
%:%653=195%:%
%:%654=195%:%
%:%655=195%:%
%:%656=196%:%
%:%657=196%:%
%:%658=196%:%
%:%659=197%:%
%:%660=197%:%
%:%661=197%:%
%:%662=198%:%
%:%663=198%:%
%:%664=198%:%
%:%665=199%:%
%:%666=199%:%
%:%667=199%:%
%:%668=200%:%
%:%674=200%:%
%:%677=201%:%
%:%678=202%:%
%:%679=202%:%
%:%680=203%:%
%:%681=204%:%
%:%682=205%:%
%:%683=206%:%
%:%690=207%:%
%:%691=207%:%
%:%692=208%:%
%:%693=208%:%
%:%694=209%:%
%:%695=209%:%
%:%696=209%:%
%:%697=210%:%
%:%698=210%:%
%:%699=211%:%
%:%700=211%:%
%:%701=211%:%
%:%702=212%:%
%:%703=212%:%
%:%704=213%:%
%:%705=213%:%
%:%706=214%:%
%:%707=214%:%
%:%708=215%:%
%:%709=215%:%
%:%710=215%:%
%:%711=216%:%
%:%712=216%:%
%:%713=216%:%
%:%714=217%:%
%:%715=217%:%
%:%716=218%:%
%:%722=218%:%
%:%725=219%:%
%:%726=220%:%
%:%727=220%:%
%:%728=221%:%
%:%729=222%:%
%:%730=223%:%
%:%733=224%:%
%:%737=224%:%
%:%738=224%:%
%:%739=225%:%
%:%740=225%:%
%:%741=226%:%
%:%742=226%:%
%:%743=227%:%
%:%744=227%:%
%:%745=228%:%
%:%746=228%:%
%:%747=229%:%
%:%748=229%:%
%:%749=230%:%
%:%750=230%:%
%:%751=231%:%
%:%752=231%:%
%:%753=232%:%
%:%754=232%:%
%:%755=233%:%
%:%756=233%:%
%:%757=233%:%
%:%758=234%:%
%:%759=234%:%
%:%760=235%:%
%:%761=235%:%
%:%762=235%:%
%:%763=236%:%
%:%764=236%:%
%:%765=237%:%
%:%766=237%:%
%:%767=237%:%
%:%768=237%:%
%:%769=238%:%
%:%770=238%:%
%:%771=238%:%
%:%772=239%:%
%:%773=239%:%
%:%774=240%:%
%:%775=240%:%
%:%776=240%:%
%:%777=241%:%
%:%778=241%:%
%:%779=242%:%
%:%780=242%:%
%:%781=242%:%
%:%782=243%:%
%:%783=243%:%
%:%784=244%:%
%:%790=244%:%
%:%793=245%:%
%:%794=246%:%
%:%795=246%:%
%:%796=247%:%
%:%803=248%:%
%:%804=248%:%
%:%805=249%:%
%:%806=249%:%
%:%807=250%:%
%:%808=250%:%
%:%809=250%:%
%:%810=251%:%
%:%811=251%:%
%:%812=252%:%
%:%813=252%:%
%:%814=252%:%
%:%815=253%:%
%:%816=253%:%
%:%817=253%:%
%:%818=254%:%
%:%819=255%:%
%:%820=255%:%
%:%821=256%:%
%:%822=256%:%
%:%823=257%:%
%:%824=257%:%
%:%825=258%:%
%:%826=258%:%
%:%827=259%:%
%:%828=259%:%
%:%829=260%:%
%:%830=260%:%
%:%831=261%:%
%:%832=261%:%
%:%833=262%:%
%:%834=263%:%
%:%835=263%:%
%:%836=264%:%
%:%837=264%:%
%:%838=264%:%
%:%839=265%:%
%:%840=266%:%
%:%841=266%:%
%:%842=267%:%
%:%843=267%:%
%:%844=268%:%
%:%845=269%:%
%:%846=269%:%
%:%847=270%:%
%:%848=270%:%
%:%849=271%:%
%:%850=272%:%
%:%851=272%:%
%:%852=273%:%
%:%853=273%:%
%:%854=274%:%
%:%855=274%:%
%:%856=275%:%
%:%857=275%:%
%:%858=276%:%
%:%859=276%:%
%:%860=276%:%
%:%861=277%:%
%:%862=277%:%
%:%863=277%:%
%:%864=278%:%
%:%865=278%:%
%:%866=278%:%
%:%867=279%:%
%:%868=279%:%
%:%869=280%:%
%:%870=280%:%
%:%871=280%:%
%:%872=281%:%
%:%873=281%:%
%:%874=281%:%
%:%875=282%:%
%:%876=282%:%
%:%877=282%:%
%:%878=283%:%
%:%879=283%:%
%:%880=284%:%
%:%881=284%:%
%:%882=284%:%
%:%883=285%:%
%:%884=285%:%
%:%885=285%:%
%:%886=286%:%
%:%887=286%:%
%:%888=287%:%
%:%889=287%:%
%:%890=287%:%
%:%891=288%:%
%:%892=288%:%
%:%893=289%:%
%:%894=289%:%
%:%895=289%:%
%:%896=290%:%
%:%897=290%:%
%:%898=291%:%
%:%899=291%:%
%:%900=291%:%
%:%901=292%:%
%:%902=292%:%
%:%903=293%:%
%:%904=293%:%
%:%905=294%:%
%:%906=294%:%
%:%907=295%:%
%:%908=295%:%
%:%909=296%:%
%:%910=296%:%
%:%911=296%:%
%:%912=297%:%
%:%913=297%:%
%:%914=298%:%
%:%924=300%:%
%:%925=301%:%
%:%927=302%:%
%:%928=302%:%
%:%929=303%:%
%:%930=304%:%
%:%931=305%:%
%:%932=306%:%
%:%935=307%:%
%:%939=307%:%
%:%940=307%:%
%:%941=308%:%
%:%942=308%:%
%:%943=309%:%
%:%944=309%:%
%:%945=310%:%
%:%946=310%:%
%:%947=311%:%
%:%948=311%:%
%:%949=312%:%
%:%950=312%:%
%:%951=313%:%
%:%952=313%:%
%:%953=314%:%
%:%954=315%:%
%:%955=315%:%
%:%956=316%:%
%:%957=316%:%
%:%958=317%:%
%:%959=317%:%
%:%960=318%:%
%:%961=318%:%
%:%962=318%:%
%:%963=319%:%
%:%964=319%:%
%:%965=320%:%
%:%966=320%:%
%:%967=320%:%
%:%968=321%:%
%:%969=321%:%
%:%970=322%:%
%:%971=322%:%
%:%972=322%:%
%:%973=323%:%
%:%974=323%:%
%:%975=324%:%
%:%976=324%:%
%:%977=324%:%
%:%978=325%:%
%:%979=325%:%
%:%980=326%:%
%:%981=326%:%
%:%982=327%:%
%:%983=327%:%
%:%984=328%:%
%:%985=328%:%
%:%986=329%:%
%:%987=330%:%
%:%988=330%:%
%:%989=330%:%
%:%990=331%:%
%:%991=331%:%
%:%992=331%:%
%:%993=332%:%
%:%994=333%:%
%:%995=333%:%
%:%996=334%:%
%:%997=334%:%
%:%998=335%:%
%:%999=335%:%
%:%1000=336%:%
%:%1001=336%:%
%:%1002=336%:%
%:%1003=337%:%
%:%1004=337%:%
%:%1005=337%:%
%:%1006=338%:%
%:%1007=338%:%
%:%1008=338%:%
%:%1009=339%:%
%:%1010=339%:%
%:%1011=339%:%
%:%1012=340%:%
%:%1013=340%:%
%:%1014=340%:%
%:%1015=341%:%
%:%1016=341%:%
%:%1017=341%:%
%:%1018=342%:%
%:%1019=342%:%
%:%1020=343%:%
%:%1021=343%:%
%:%1022=343%:%
%:%1023=344%:%
%:%1024=344%:%
%:%1025=344%:%
%:%1026=345%:%
%:%1027=345%:%
%:%1028=345%:%
%:%1029=346%:%
%:%1030=346%:%
%:%1031=347%:%
%:%1032=347%:%
%:%1033=347%:%
%:%1034=348%:%
%:%1035=348%:%
%:%1036=348%:%
%:%1037=349%:%
%:%1038=349%:%
%:%1039=349%:%
%:%1040=350%:%
%:%1041=350%:%
%:%1042=351%:%
%:%1043=351%:%
%:%1044=352%:%
%:%1045=352%:%
%:%1046=352%:%
%:%1047=353%:%
%:%1048=353%:%
%:%1049=353%:%
%:%1050=354%:%
%:%1051=354%:%
%:%1052=354%:%
%:%1053=355%:%
%:%1054=355%:%
%:%1055=356%:%
%:%1056=356%:%
%:%1057=356%:%
%:%1058=357%:%
%:%1059=357%:%
%:%1060=357%:%
%:%1061=358%:%
%:%1076=360%:%
%:%1080=362%:%
%:%1090=364%:%
%:%1091=364%:%
%:%1092=365%:%
%:%1093=366%:%
%:%1094=367%:%
%:%1095=367%:%
%:%1096=368%:%
%:%1097=369%:%
%:%1100=370%:%
%:%1104=370%:%
%:%1105=370%:%
%:%1106=370%:%
%:%1107=370%:%
%:%1112=370%:%
%:%1115=371%:%
%:%1116=372%:%
%:%1117=372%:%
%:%1118=373%:%
%:%1119=374%:%
%:%1122=375%:%
%:%1126=375%:%
%:%1127=375%:%
%:%1128=375%:%
%:%1133=375%:%
%:%1136=376%:%
%:%1137=377%:%
%:%1138=377%:%
%:%1139=378%:%
%:%1140=379%:%
%:%1141=380%:%
%:%1148=381%:%
%:%1149=381%:%
%:%1150=382%:%
%:%1151=382%:%
%:%1152=383%:%
%:%1153=383%:%
%:%1154=383%:%
%:%1155=384%:%
%:%1156=384%:%
%:%1157=384%:%
%:%1158=385%:%
%:%1159=385%:%
%:%1160=385%:%
%:%1161=386%:%
%:%1162=386%:%
%:%1163=386%:%
%:%1164=387%:%
%:%1165=387%:%
%:%1166=387%:%
%:%1167=388%:%
%:%1168=388%:%
%:%1169=388%:%
%:%1170=389%:%
%:%1171=389%:%
%:%1172=390%:%
%:%1173=390%:%
%:%1174=390%:%
%:%1175=391%:%
%:%1176=391%:%
%:%1177=392%:%
%:%1192=394%:%
%:%1202=396%:%
%:%1203=396%:%
%:%1204=397%:%
%:%1205=398%:%
%:%1206=399%:%
%:%1207=399%:%
%:%1208=400%:%
%:%1209=401%:%
%:%1212=402%:%
%:%1216=402%:%
%:%1217=402%:%
%:%1218=402%:%
%:%1219=403%:%
%:%1220=403%:%
%:%1225=403%:%
%:%1228=404%:%
%:%1229=405%:%
%:%1230=405%:%
%:%1231=406%:%
%:%1232=407%:%
%:%1235=408%:%
%:%1239=408%:%
%:%1240=408%:%
%:%1241=409%:%
%:%1242=409%:%
%:%1247=409%:%
%:%1250=410%:%
%:%1251=411%:%
%:%1252=411%:%
%:%1253=412%:%
%:%1254=413%:%
%:%1261=414%:%
%:%1262=414%:%
%:%1263=415%:%
%:%1264=415%:%
%:%1265=416%:%
%:%1266=416%:%
%:%1267=417%:%
%:%1268=418%:%
%:%1269=418%:%
%:%1270=419%:%
%:%1271=419%:%
%:%1272=419%:%
%:%1273=420%:%
%:%1274=420%:%
%:%1275=420%:%
%:%1276=421%:%
%:%1277=421%:%
%:%1278=422%:%
%:%1279=422%:%
%:%1280=422%:%
%:%1281=423%:%
%:%1282=423%:%
%:%1283=423%:%
%:%1284=424%:%
%:%1285=424%:%
%:%1286=424%:%
%:%1287=425%:%
%:%1288=425%:%
%:%1289=426%:%
%:%1295=426%:%
%:%1298=427%:%
%:%1299=428%:%
%:%1300=428%:%
%:%1301=429%:%
%:%1302=430%:%
%:%1309=431%:%
%:%1310=431%:%
%:%1311=432%:%
%:%1312=432%:%
%:%1313=433%:%
%:%1314=433%:%
%:%1315=434%:%
%:%1316=434%:%
%:%1317=434%:%
%:%1318=435%:%
%:%1319=435%:%
%:%1320=436%:%
%:%1321=436%:%
%:%1322=437%:%
%:%1323=438%:%
%:%1324=438%:%
%:%1325=439%:%
%:%1326=439%:%
%:%1327=439%:%
%:%1328=440%:%
%:%1329=440%:%
%:%1330=440%:%
%:%1331=441%:%
%:%1332=441%:%
%:%1333=441%:%
%:%1334=442%:%
%:%1335=442%:%
%:%1336=442%:%
%:%1337=443%:%
%:%1338=443%:%
%:%1339=443%:%
%:%1340=444%:%
%:%1341=444%:%
%:%1342=445%:%
%:%1343=445%:%
%:%1344=445%:%
%:%1345=446%:%
%:%1346=446%:%
%:%1347=447%:%
%:%1348=447%:%
%:%1349=447%:%
%:%1350=448%:%
%:%1351=448%:%
%:%1352=449%:%
%:%1353=449%:%
%:%1354=449%:%
%:%1355=450%:%
%:%1356=450%:%
%:%1357=450%:%
%:%1358=451%:%
%:%1359=451%:%
%:%1360=451%:%
%:%1361=452%:%
%:%1362=452%:%
%:%1363=453%:%
%:%1364=453%:%
%:%1365=453%:%
%:%1366=454%:%
%:%1367=454%:%
%:%1368=454%:%
%:%1369=455%:%
%:%1384=457%:%
%:%1394=459%:%
%:%1395=459%:%
%:%1396=460%:%
%:%1397=461%:%
%:%1398=462%:%
%:%1399=462%:%
%:%1400=463%:%
%:%1403=464%:%
%:%1407=464%:%
%:%1408=464%:%
%:%1409=464%:%
%:%1414=464%:%
%:%1417=465%:%
%:%1418=466%:%
%:%1419=466%:%
%:%1420=467%:%
%:%1421=468%:%
%:%1422=469%:%
%:%1423=469%:%
%:%1424=470%:%
%:%1425=471%:%
%:%1426=472%:%
%:%1429=473%:%
%:%1433=473%:%
%:%1434=473%:%
%:%1435=473%:%
%:%1436=474%:%
%:%1437=474%:%
%:%1442=474%:%
%:%1445=475%:%
%:%1446=476%:%
%:%1447=476%:%
%:%1448=477%:%
%:%1449=478%:%
%:%1450=479%:%
%:%1457=480%:%
%:%1458=480%:%
%:%1459=481%:%
%:%1460=481%:%
%:%1461=482%:%
%:%1462=482%:%
%:%1463=482%:%
%:%1464=483%:%
%:%1465=483%:%
%:%1466=483%:%
%:%1467=484%:%
%:%1468=484%:%
%:%1469=484%:%
%:%1470=485%:%
%:%1476=485%:%
%:%1479=486%:%
%:%1480=487%:%
%:%1481=487%:%
%:%1482=488%:%
%:%1483=489%:%
%:%1484=490%:%
%:%1485=491%:%
%:%1492=492%:%
%:%1493=492%:%
%:%1494=493%:%
%:%1495=493%:%
%:%1496=494%:%
%:%1497=494%:%
%:%1498=494%:%
%:%1499=495%:%
%:%1500=495%:%
%:%1501=495%:%
%:%1502=496%:%
%:%1503=496%:%
%:%1504=496%:%
%:%1505=497%:%
%:%1506=497%:%
%:%1507=497%:%
%:%1508=498%:%
%:%1509=498%:%
%:%1510=498%:%
%:%1511=499%:%
%:%1512=499%:%
%:%1513=499%:%
%:%1514=500%:%
%:%1515=500%:%
%:%1516=500%:%
%:%1517=501%:%
%:%1518=501%:%
%:%1519=501%:%
%:%1520=502%:%
%:%1521=502%:%
%:%1522=502%:%
%:%1523=503%:%
%:%1524=503%:%
%:%1525=503%:%
%:%1526=504%:%
%:%1527=504%:%
%:%1528=504%:%
%:%1529=505%:%
%:%1530=505%:%
%:%1531=505%:%
%:%1532=506%:%
%:%1533=506%:%
%:%1534=506%:%
%:%1535=507%:%
%:%1536=507%:%
%:%1537=507%:%
%:%1538=508%:%
%:%1539=508%:%
%:%1540=509%:%
%:%1546=509%:%
%:%1549=510%:%
%:%1550=511%:%
%:%1551=511%:%
%:%1552=512%:%
%:%1553=513%:%
%:%1554=514%:%
%:%1557=515%:%
%:%1561=515%:%
%:%1562=515%:%
%:%1563=516%:%
%:%1564=516%:%
%:%1565=517%:%
%:%1566=517%:%
%:%1567=518%:%
%:%1568=518%:%
%:%1569=519%:%
%:%1570=519%:%
%:%1571=520%:%
%:%1572=520%:%
%:%1573=520%:%
%:%1574=521%:%
%:%1575=521%:%
%:%1576=522%:%
%:%1577=522%:%
%:%1578=522%:%
%:%1579=523%:%
%:%1580=523%:%
%:%1581=524%:%
%:%1582=524%:%
%:%1583=525%:%
%:%1584=525%:%
%:%1585=526%:%
%:%1586=526%:%
%:%1587=526%:%
%:%1588=527%:%
%:%1589=527%:%
%:%1590=528%:%
%:%1591=528%:%
%:%1592=528%:%
%:%1593=529%:%
%:%1594=529%:%
%:%1595=529%:%
%:%1596=530%:%
%:%1597=530%:%
%:%1598=530%:%
%:%1599=531%:%
%:%1600=531%:%
%:%1601=531%:%
%:%1602=532%:%
%:%1603=532%:%
%:%1604=532%:%
%:%1605=533%:%
%:%1606=533%:%
%:%1607=533%:%
%:%1608=534%:%
%:%1609=534%:%
%:%1610=534%:%
%:%1611=535%:%
%:%1612=535%:%
%:%1613=535%:%
%:%1614=536%:%
%:%1615=536%:%
%:%1616=536%:%
%:%1617=537%:%
%:%1618=537%:%
%:%1619=537%:%
%:%1620=538%:%
%:%1621=538%:%
%:%1622=538%:%
%:%1623=539%:%
%:%1624=539%:%
%:%1625=539%:%
%:%1626=540%:%
%:%1627=540%:%
%:%1628=540%:%
%:%1629=541%:%
%:%1630=541%:%
%:%1631=542%:%
%:%1632=542%:%
%:%1633=543%:%
%:%1634=543%:%
%:%1635=543%:%
%:%1636=544%:%
%:%1637=544%:%
%:%1638=544%:%
%:%1639=545%:%
%:%1645=545%:%
%:%1648=546%:%
%:%1649=547%:%
%:%1650=547%:%
%:%1651=548%:%
%:%1652=549%:%
%:%1655=550%:%
%:%1659=550%:%
%:%1660=550%:%
%:%1661=551%:%
%:%1662=551%:%
%:%1663=552%:%
%:%1664=552%:%
%:%1665=553%:%
%:%1666=554%:%
%:%1667=554%:%
%:%1668=555%:%
%:%1669=555%:%
%:%1670=556%:%
%:%1671=556%:%
%:%1672=557%:%
%:%1673=557%:%
%:%1674=557%:%
%:%1675=558%:%
%:%1676=558%:%
%:%1677=559%:%
%:%1678=559%:%
%:%1679=560%:%
%:%1680=561%:%
%:%1681=561%:%
%:%1682=562%:%
%:%1683=562%:%
%:%1684=562%:%
%:%1685=563%:%
%:%1686=563%:%
%:%1687=563%:%
%:%1688=564%:%
%:%1689=564%:%
%:%1690=564%:%
%:%1691=565%:%
%:%1692=565%:%
%:%1693=566%:%
%:%1694=566%:%
%:%1695=566%:%
%:%1696=567%:%
%:%1697=567%:%
%:%1698=568%:%
%:%1699=568%:%
%:%1700=568%:%
%:%1701=569%:%
%:%1702=569%:%
%:%1703=570%:%
%:%1704=570%:%
%:%1705=570%:%
%:%1706=571%:%
%:%1707=571%:%
%:%1708=572%:%
%:%1709=572%:%
%:%1710=572%:%
%:%1711=573%:%
%:%1712=573%:%
%:%1713=574%:%
%:%1714=574%:%
%:%1715=574%:%
%:%1716=575%:%
%:%1717=575%:%
%:%1718=576%:%
%:%1719=576%:%
%:%1720=576%:%
%:%1721=577%:%
%:%1722=577%:%
%:%1723=577%:%
%:%1724=578%:%
%:%1725=578%:%
%:%1726=578%:%
%:%1727=579%:%
%:%1728=579%:%
%:%1729=579%:%
%:%1730=580%:%
%:%1731=580%:%
%:%1732=580%:%
%:%1733=581%:%
%:%1734=581%:%
%:%1735=581%:%
%:%1736=582%:%
%:%1737=582%:%
%:%1738=582%:%
%:%1739=583%:%
%:%1740=583%:%
%:%1741=583%:%
%:%1742=584%:%
%:%1743=584%:%
%:%1744=584%:%
%:%1745=585%:%
%:%1746=585%:%
%:%1747=585%:%
%:%1748=586%:%
%:%1749=586%:%
%:%1750=586%:%
%:%1751=587%:%
%:%1752=587%:%
%:%1753=587%:%
%:%1754=588%:%
%:%1755=588%:%
%:%1756=588%:%
%:%1757=589%:%
%:%1758=589%:%
%:%1759=589%:%
%:%1760=590%:%
%:%1761=590%:%
%:%1762=590%:%
%:%1763=591%:%
%:%1764=591%:%
%:%1765=592%:%
%:%1766=592%:%
%:%1767=592%:%
%:%1768=593%:%
%:%1769=594%:%
%:%1770=594%:%
%:%1771=594%:%
%:%1772=595%:%
%:%1773=595%:%
%:%1774=596%:%
%:%1775=596%:%
%:%1776=596%:%
%:%1778=598%:%
%:%1779=599%:%
%:%1780=599%:%
%:%1781=599%:%
%:%1782=600%:%
%:%1783=600%:%
%:%1784=600%:%
%:%1785=601%:%
%:%1786=602%:%
%:%1787=602%:%
%:%1788=602%:%
%:%1789=603%:%
%:%1795=603%:%
%:%1798=604%:%
%:%1799=605%:%
%:%1800=605%:%
%:%1801=606%:%
%:%1802=607%:%
%:%1803=608%:%
%:%1804=609%:%
%:%1811=610%:%
%:%1812=610%:%
%:%1813=611%:%
%:%1814=611%:%
%:%1815=612%:%
%:%1816=612%:%
%:%1817=612%:%
%:%1818=613%:%
%:%1819=613%:%
%:%1820=613%:%
%:%1821=614%:%
%:%1822=614%:%
%:%1823=614%:%
%:%1824=615%:%
%:%1825=615%:%
%:%1826=615%:%
%:%1827=616%:%
%:%1828=616%:%
%:%1829=616%:%
%:%1830=617%:%
%:%1831=617%:%
%:%1832=617%:%
%:%1833=618%:%
%:%1834=618%:%
%:%1835=619%:%
%:%1836=619%:%
%:%1837=620%:%
%:%1838=621%:%
%:%1839=621%:%
%:%1840=622%:%
%:%1841=622%:%
%:%1842=623%:%
%:%1843=624%:%
%:%1844=624%:%
%:%1845=624%:%
%:%1846=625%:%
%:%1847=625%:%
%:%1848=625%:%
%:%1849=626%:%
%:%1850=626%:%
%:%1851=626%:%
%:%1852=627%:%
%:%1853=627%:%
%:%1854=627%:%
%:%1855=628%:%
%:%1856=628%:%
%:%1857=628%:%
%:%1858=629%:%
%:%1859=629%:%
%:%1860=629%:%
%:%1861=630%:%
%:%1862=630%:%
%:%1863=630%:%
%:%1864=631%:%
%:%1865=631%:%
%:%1866=632%:%
%:%1867=632%:%
%:%1868=632%:%
%:%1869=633%:%
%:%1870=633%:%
%:%1871=633%:%
%:%1872=634%:%
%:%1873=635%:%
%:%1874=635%:%
%:%1875=636%:%
%:%1876=636%:%
%:%1877=636%:%
%:%1878=637%:%
%:%1879=637%:%
%:%1880=637%:%
%:%1881=638%:%
%:%1882=638%:%
%:%1883=638%:%
%:%1884=639%:%
%:%1885=639%:%
%:%1886=639%:%
%:%1887=640%:%
%:%1888=640%:%
%:%1889=640%:%
%:%1890=641%:%
%:%1891=641%:%
%:%1892=641%:%
%:%1893=642%:%
%:%1894=642%:%
%:%1895=642%:%
%:%1896=643%:%
%:%1897=643%:%
%:%1898=643%:%
%:%1899=644%:%
%:%1900=644%:%
%:%1901=644%:%
%:%1902=645%:%
%:%1903=645%:%
%:%1904=645%:%
%:%1905=646%:%
%:%1906=646%:%
%:%1907=646%:%
%:%1908=647%:%
%:%1909=647%:%
%:%1910=647%:%
%:%1911=648%:%
%:%1912=648%:%
%:%1913=648%:%
%:%1914=649%:%
%:%1915=649%:%
%:%1916=650%:%
%:%1922=650%:%
%:%1925=651%:%
%:%1926=652%:%
%:%1927=652%:%
%:%1928=653%:%
%:%1929=654%:%
%:%1930=655%:%
%:%1937=656%:%
%:%1938=656%:%
%:%1939=657%:%
%:%1940=657%:%
%:%1941=658%:%
%:%1942=658%:%
%:%1943=658%:%
%:%1944=659%:%
%:%1945=659%:%
%:%1946=660%:%
%:%1947=660%:%
%:%1948=660%:%
%:%1949=661%:%
%:%1950=661%:%
%:%1951=662%:%
%:%1952=662%:%
%:%1953=663%:%
%:%1954=663%:%
%:%1955=664%:%
%:%1956=664%:%
%:%1957=665%:%
%:%1958=665%:%
%:%1959=665%:%
%:%1960=666%:%
%:%1961=666%:%
%:%1962=666%:%
%:%1963=667%:%
%:%1964=667%:%
%:%1965=667%:%
%:%1966=668%:%
%:%1967=668%:%
%:%1968=668%:%
%:%1969=669%:%
%:%1970=669%:%
%:%1971=669%:%
%:%1972=670%:%
%:%1973=670%:%
%:%1974=670%:%
%:%1975=671%:%
%:%1976=671%:%
%:%1977=671%:%
%:%1978=672%:%
%:%1979=672%:%
%:%1980=672%:%
%:%1981=673%:%
%:%1982=673%:%
%:%1983=674%:%
%:%1989=674%:%
%:%1992=675%:%
%:%1993=676%:%
%:%1994=676%:%
%:%1995=677%:%
%:%1996=678%:%
%:%1999=679%:%
%:%2003=679%:%
%:%2004=679%:%
%:%2005=679%:%
%:%2010=679%:%
%:%2013=680%:%
%:%2014=681%:%
%:%2015=681%:%
%:%2016=682%:%
%:%2017=683%:%
%:%2020=684%:%
%:%2024=684%:%
%:%2025=684%:%
%:%2026=684%:%
%:%2031=684%:%
%:%2034=685%:%
%:%2035=686%:%
%:%2036=686%:%
%:%2037=687%:%
%:%2038=688%:%
%:%2039=689%:%
%:%2042=690%:%
%:%2046=690%:%
%:%2047=690%:%
%:%2048=690%:%
%:%2053=690%:%
%:%2056=691%:%
%:%2057=692%:%
%:%2058=692%:%
%:%2059=693%:%
%:%2060=694%:%
%:%2061=695%:%
%:%2064=696%:%
%:%2068=696%:%
%:%2069=696%:%
%:%2070=696%:%
%:%2075=696%:%
%:%2078=697%:%
%:%2079=698%:%
%:%2080=698%:%
%:%2081=699%:%
%:%2082=700%:%
%:%2083=701%:%
%:%2084=702%:%
%:%2091=703%:%
%:%2092=703%:%
%:%2093=704%:%
%:%2094=704%:%
%:%2095=705%:%
%:%2096=705%:%
%:%2097=705%:%
%:%2098=706%:%
%:%2099=706%:%
%:%2100=706%:%
%:%2101=707%:%
%:%2102=707%:%
%:%2103=707%:%
%:%2104=708%:%
%:%2105=708%:%
%:%2106=708%:%
%:%2107=709%:%
%:%2108=709%:%
%:%2109=709%:%
%:%2110=710%:%
%:%2111=710%:%
%:%2112=710%:%
%:%2113=711%:%
%:%2114=711%:%
%:%2115=711%:%
%:%2116=712%:%
%:%2117=712%:%
%:%2118=712%:%
%:%2119=713%:%
%:%2120=713%:%
%:%2121=713%:%
%:%2122=714%:%
%:%2123=714%:%
%:%2124=714%:%
%:%2125=715%:%
%:%2126=715%:%
%:%2127=715%:%
%:%2128=716%:%
%:%2129=716%:%
%:%2130=716%:%
%:%2131=717%:%
%:%2132=717%:%
%:%2133=717%:%
%:%2134=718%:%
%:%2135=718%:%
%:%2136=718%:%
%:%2137=719%:%
%:%2138=719%:%
%:%2139=720%:%
%:%2154=722%:%
%:%2164=724%:%
%:%2165=724%:%
%:%2166=725%:%
%:%2167=726%:%
%:%2168=727%:%
%:%2169=727%:%
%:%2170=728%:%
%:%2171=729%:%
%:%2178=730%:%
%:%2179=730%:%
%:%2180=731%:%
%:%2181=731%:%
%:%2182=732%:%
%:%2183=732%:%
%:%2184=732%:%
%:%2185=733%:%
%:%2186=733%:%
%:%2187=733%:%
%:%2188=734%:%
%:%2189=734%:%
%:%2190=735%:%
%:%2196=735%:%
%:%2199=736%:%
%:%2200=737%:%
%:%2201=737%:%
%:%2202=738%:%
%:%2203=739%:%
%:%2204=740%:%
%:%2207=741%:%
%:%2211=741%:%
%:%2212=741%:%
%:%2213=741%:%
%:%2218=741%:%
%:%2221=742%:%
%:%2222=743%:%
%:%2223=743%:%
%:%2224=744%:%
%:%2225=745%:%
%:%2226=746%:%
%:%2227=747%:%
%:%2234=748%:%
%:%2235=748%:%
%:%2236=749%:%
%:%2237=749%:%
%:%2238=750%:%
%:%2239=750%:%
%:%2240=750%:%
%:%2241=751%:%
%:%2242=751%:%
%:%2243=751%:%
%:%2244=752%:%
%:%2245=752%:%
%:%2246=752%:%
%:%2247=753%:%
%:%2248=753%:%
%:%2249=753%:%
%:%2250=754%:%
%:%2251=754%:%
%:%2252=755%:%
%:%2258=755%:%
%:%2261=756%:%
%:%2262=757%:%
%:%2263=757%:%
%:%2264=758%:%
%:%2265=759%:%
%:%2266=760%:%
%:%2267=760%:%
%:%2268=761%:%
%:%2269=762%:%
%:%2276=763%:%
%:%2277=763%:%
%:%2278=764%:%
%:%2279=764%:%
%:%2280=765%:%
%:%2281=765%:%
%:%2282=765%:%
%:%2283=766%:%
%:%2284=766%:%
%:%2285=766%:%
%:%2286=767%:%
%:%2287=767%:%
%:%2288=768%:%
%:%2294=768%:%
%:%2297=769%:%
%:%2298=770%:%
%:%2299=770%:%
%:%2300=771%:%
%:%2301=772%:%
%:%2302=773%:%
%:%2305=774%:%
%:%2309=774%:%
%:%2310=774%:%
%:%2311=774%:%
%:%2316=774%:%
%:%2319=775%:%
%:%2320=776%:%
%:%2321=776%:%
%:%2322=777%:%
%:%2323=778%:%
%:%2324=779%:%
%:%2325=780%:%
%:%2332=781%:%
%:%2333=781%:%
%:%2334=782%:%
%:%2335=782%:%
%:%2336=783%:%
%:%2337=783%:%
%:%2338=783%:%
%:%2339=784%:%
%:%2340=784%:%
%:%2341=784%:%
%:%2342=785%:%
%:%2343=785%:%
%:%2344=785%:%
%:%2345=786%:%
%:%2346=786%:%
%:%2347=786%:%
%:%2348=787%:%
%:%2349=787%:%
%:%2350=788%:%
%:%2365=790%:%
%:%2377=792%:%
%:%2379=793%:%
%:%2380=793%:%
%:%2381=794%:%
%:%2388=795%:%
%:%2389=795%:%
%:%2390=796%:%
%:%2391=796%:%
%:%2392=797%:%
%:%2393=797%:%
%:%2394=797%:%
%:%2395=798%:%
%:%2396=798%:%
%:%2397=799%:%
%:%2398=799%:%
%:%2399=799%:%
%:%2400=800%:%
%:%2401=800%:%
%:%2403=802%:%
%:%2404=803%:%
%:%2405=803%:%
%:%2406=804%:%
%:%2407=804%:%
%:%2408=804%:%
%:%2409=805%:%
%:%2410=805%:%
%:%2411=806%:%
%:%2412=807%:%
%:%2413=807%:%
%:%2414=808%:%
%:%2415=808%:%
%:%2416=809%:%
%:%2417=810%:%
%:%2418=810%:%
%:%2419=811%:%
%:%2420=811%:%
%:%2421=812%:%
%:%2422=812%:%
%:%2423=813%:%
%:%2424=813%:%
%:%2425=814%:%
%:%2426=814%:%
%:%2427=815%:%
%:%2428=815%:%
%:%2429=815%:%
%:%2430=816%:%
%:%2431=816%:%
%:%2432=816%:%
%:%2433=817%:%
%:%2434=818%:%
%:%2435=818%:%
%:%2436=819%:%
%:%2437=819%:%
%:%2438=819%:%
%:%2439=820%:%
%:%2440=821%:%
%:%2441=821%:%
%:%2442=822%:%
%:%2443=822%:%
%:%2444=822%:%
%:%2445=823%:%
%:%2446=823%:%
%:%2447=823%:%
%:%2448=824%:%
%:%2449=824%:%
%:%2450=824%:%
%:%2451=825%:%
%:%2452=825%:%
%:%2453=826%:%
%:%2454=826%:%
%:%2455=827%:%
%:%2456=828%:%
%:%2457=828%:%
%:%2458=829%:%
%:%2459=829%:%
%:%2460=829%:%
%:%2461=830%:%
%:%2462=830%:%
%:%2463=830%:%
%:%2464=831%:%
%:%2465=831%:%
%:%2466=831%:%
%:%2467=832%:%
%:%2477=834%:%
%:%2479=835%:%
%:%2480=835%:%
%:%2481=836%:%
%:%2488=837%:%
%:%2489=837%:%
%:%2490=838%:%
%:%2491=838%:%
%:%2492=839%:%
%:%2493=839%:%
%:%2494=839%:%
%:%2495=840%:%
%:%2496=840%:%
%:%2497=841%:%
%:%2498=841%:%
%:%2499=842%:%
%:%2500=842%:%
%:%2501=843%:%
%:%2502=843%:%
%:%2503=844%:%
%:%2504=844%:%
%:%2505=845%:%
%:%2506=845%:%
%:%2507=845%:%
%:%2508=846%:%
%:%2509=846%:%
%:%2510=847%:%
%:%2511=848%:%
%:%2512=848%:%
%:%2513=848%:%
%:%2514=849%:%
%:%2515=849%:%
%:%2516=849%:%
%:%2517=850%:%
%:%2518=850%:%
%:%2519=851%:%
%:%2520=851%:%
%:%2521=851%:%
%:%2522=852%:%
%:%2523=852%:%
%:%2524=852%:%
%:%2525=853%:%
%:%2526=853%:%
%:%2527=854%:%
%:%2528=854%:%
%:%2529=854%:%
%:%2530=855%:%
%:%2531=855%:%
%:%2532=856%:%
%:%2533=856%:%
%:%2534=856%:%
%:%2535=857%:%
%:%2536=857%:%
%:%2537=857%:%
%:%2538=858%:%
%:%2544=858%:%
%:%2547=859%:%
%:%2548=860%:%
%:%2549=860%:%
%:%2550=861%:%
%:%2557=862%:%
%:%2558=862%:%
%:%2559=863%:%
%:%2560=863%:%
%:%2561=864%:%
%:%2562=864%:%
%:%2563=864%:%
%:%2564=865%:%
%:%2565=865%:%
%:%2566=866%:%
%:%2567=866%:%
%:%2568=867%:%
%:%2569=867%:%
%:%2570=868%:%
%:%2571=868%:%
%:%2572=869%:%
%:%2573=869%:%
%:%2574=870%:%
%:%2575=870%:%
%:%2576=870%:%
%:%2577=871%:%
%:%2578=871%:%
%:%2579=871%:%
%:%2580=872%:%
%:%2581=872%:%
%:%2582=873%:%
%:%2583=873%:%
%:%2584=874%:%
%:%2585=874%:%
%:%2586=874%:%
%:%2587=875%:%
%:%2597=877%:%
%:%2599=878%:%
%:%2600=878%:%
%:%2601=879%:%
%:%2608=880%:%
%:%2609=880%:%
%:%2610=881%:%
%:%2611=881%:%
%:%2612=882%:%
%:%2613=882%:%
%:%2614=883%:%
%:%2615=883%:%
%:%2616=884%:%
%:%2617=884%:%
%:%2618=885%:%
%:%2619=885%:%
%:%2620=886%:%
%:%2621=887%:%
%:%2622=887%:%
%:%2626=891%:%
%:%2627=892%:%
%:%2628=892%:%
%:%2629=893%:%
%:%2630=893%:%
%:%2631=894%:%
%:%2632=894%:%
%:%2633=895%:%
%:%2634=895%:%
%:%2635=895%:%
%:%2636=896%:%
%:%2637=896%:%
%:%2638=897%:%
%:%2639=897%:%
%:%2640=897%:%
%:%2641=898%:%
%:%2642=898%:%
%:%2643=899%:%
%:%2644=899%:%
%:%2645=899%:%
%:%2646=900%:%
%:%2647=900%:%
%:%2648=901%:%
%:%2649=901%:%
%:%2650=902%:%
%:%2651=902%:%
%:%2652=903%:%
%:%2653=903%:%
%:%2656=906%:%
%:%2657=907%:%
%:%2658=907%:%
%:%2659=908%:%
%:%2660=908%:%
%:%2661=909%:%
%:%2662=909%:%
%:%2663=910%:%
%:%2664=910%:%
%:%2665=911%:%
%:%2666=911%:%
%:%2667=912%:%
%:%2668=913%:%
%:%2669=913%:%
%:%2670=914%:%
%:%2671=914%:%
%:%2672=915%:%
%:%2673=915%:%
%:%2674=915%:%
%:%2675=916%:%
%:%2676=916%:%
%:%2677=917%:%
%:%2678=917%:%
%:%2679=918%:%
%:%2680=918%:%
%:%2681=919%:%
%:%2682=919%:%
%:%2683=919%:%
%:%2684=920%:%
%:%2685=920%:%
%:%2686=920%:%
%:%2687=921%:%
%:%2688=921%:%
%:%2689=922%:%
%:%2690=922%:%
%:%2691=923%:%
%:%2692=923%:%
%:%2693=924%:%
%:%2694=924%:%
%:%2695=925%:%
%:%2696=925%:%
%:%2697=926%:%
%:%2698=926%:%
%:%2699=927%:%
%:%2700=927%:%
%:%2701=927%:%
%:%2702=928%:%
%:%2703=928%:%
%:%2704=928%:%
%:%2705=929%:%
%:%2706=929%:%
%:%2707=929%:%
%:%2708=930%:%
%:%2709=930%:%
%:%2710=931%:%
%:%2711=931%:%
%:%2712=931%:%
%:%2713=932%:%
%:%2714=932%:%
%:%2715=933%:%
%:%2716=933%:%
%:%2717=933%:%
%:%2718=934%:%
%:%2719=934%:%
%:%2720=934%:%
%:%2721=935%:%
%:%2722=935%:%
%:%2723=936%:%
%:%2724=936%:%
%:%2725=937%:%
%:%2726=937%:%
%:%2727=938%:%
%:%2728=938%:%
%:%2729=938%:%
%:%2730=939%:%
%:%2731=939%:%
%:%2732=939%:%
%:%2733=940%:%
%:%2739=940%:%
%:%2742=941%:%
%:%2743=942%:%
%:%2744=942%:%
%:%2745=943%:%
%:%2752=944%:%
%:%2753=944%:%
%:%2754=945%:%
%:%2755=945%:%
%:%2756=946%:%
%:%2757=946%:%
%:%2758=947%:%
%:%2759=947%:%
%:%2760=948%:%
%:%2761=948%:%
%:%2762=949%:%
%:%2763=949%:%
%:%2764=950%:%
%:%2765=950%:%
%:%2771=956%:%
%:%2772=957%:%
%:%2773=957%:%
%:%2774=958%:%
%:%2775=958%:%
%:%2776=959%:%
%:%2777=960%:%
%:%2778=960%:%
%:%2779=960%:%
%:%2780=961%:%
%:%2781=961%:%
%:%2782=961%:%
%:%2783=962%:%
%:%2784=962%:%
%:%2785=963%:%
%:%2786=963%:%
%:%2787=963%:%
%:%2788=964%:%
%:%2789=964%:%
%:%2790=965%:%
%:%2791=965%:%
%:%2792=965%:%
%:%2793=966%:%
%:%2794=966%:%
%:%2795=966%:%
%:%2796=967%:%
%:%2797=967%:%
%:%2798=967%:%
%:%2799=968%:%
%:%2800=968%:%
%:%2801=969%:%
%:%2802=969%:%
%:%2803=969%:%
%:%2804=970%:%
%:%2805=970%:%
%:%2806=971%:%
%:%2807=971%:%
%:%2808=971%:%
%:%2809=972%:%
%:%2810=972%:%
%:%2811=973%:%
%:%2812=973%:%
%:%2813=974%:%
%:%2814=974%:%
%:%2815=975%:%
%:%2816=976%:%
%:%2817=976%:%
%:%2818=976%:%
%:%2819=977%:%
%:%2820=977%:%
%:%2821=977%:%
%:%2822=978%:%
%:%2823=978%:%
%:%2824=979%:%
%:%2825=979%:%
%:%2826=979%:%
%:%2827=980%:%
%:%2828=980%:%
%:%2829=981%:%
%:%2830=981%:%
%:%2831=981%:%
%:%2832=982%:%
%:%2833=982%:%
%:%2834=982%:%
%:%2835=983%:%
%:%2836=983%:%
%:%2837=983%:%
%:%2838=984%:%
%:%2839=984%:%
%:%2840=985%:%
%:%2841=985%:%
%:%2842=985%:%
%:%2843=986%:%
%:%2844=986%:%
%:%2845=987%:%
%:%2846=987%:%
%:%2847=987%:%
%:%2848=988%:%
%:%2849=988%:%
%:%2850=989%:%
%:%2851=989%:%
%:%2852=990%:%
%:%2853=990%:%
%:%2854=991%:%
%:%2855=991%:%
%:%2856=992%:%
%:%2857=992%:%
%:%2858=993%:%
%:%2859=993%:%
%:%2860=994%:%
%:%2861=994%:%
%:%2862=995%:%
%:%2863=995%:%
%:%2864=996%:%
%:%2865=996%:%
%:%2866=997%:%
%:%2867=997%:%
%:%2868=998%:%
%:%2869=998%:%
%:%2870=999%:%
%:%2871=999%:%
%:%2872=1000%:%
%:%2873=1000%:%
%:%2874=1000%:%
%:%2875=1001%:%
%:%2876=1002%:%
%:%2877=1002%:%
%:%2878=1002%:%
%:%2879=1003%:%
%:%2880=1003%:%
%:%2881=1004%:%
%:%2882=1004%:%
%:%2883=1005%:%
%:%2884=1005%:%
%:%2885=1006%:%
%:%2886=1006%:%
%:%2887=1006%:%
%:%2888=1007%:%
%:%2889=1007%:%
%:%2890=1008%:%
%:%2891=1008%:%
%:%2892=1009%:%
%:%2893=1009%:%
%:%2894=1010%:%
%:%2895=1010%:%
%:%2896=1010%:%
%:%2897=1011%:%
%:%2898=1011%:%
%:%2899=1011%:%
%:%2900=1012%:%
%:%2901=1012%:%
%:%2902=1012%:%
%:%2903=1013%:%
%:%2904=1013%:%
%:%2905=1013%:%
%:%2906=1014%:%
%:%2907=1014%:%
%:%2908=1014%:%
%:%2909=1015%:%
%:%2910=1015%:%
%:%2911=1016%:%
%:%2912=1016%:%
%:%2913=1016%:%
%:%2914=1017%:%
%:%2915=1017%:%
%:%2916=1017%:%
%:%2917=1018%:%
%:%2918=1018%:%
%:%2919=1018%:%
%:%2920=1019%:%
%:%2921=1019%:%
%:%2922=1019%:%
%:%2923=1020%:%
%:%2924=1020%:%
%:%2925=1020%:%
%:%2926=1021%:%
%:%2927=1021%:%
%:%2928=1022%:%
%:%2929=1022%:%
%:%2930=1022%:%
%:%2931=1023%:%
%:%2932=1023%:%
%:%2933=1024%:%
%:%2934=1024%:%
%:%2935=1024%:%
%:%2936=1025%:%
%:%2937=1025%:%
%:%2938=1026%:%
%:%2939=1026%:%
%:%2940=1026%:%
%:%2941=1027%:%
%:%2942=1027%:%
%:%2943=1028%:%
%:%2944=1028%:%
%:%2945=1028%:%
%:%2946=1029%:%
%:%2947=1029%:%
%:%2948=1030%:%
%:%2949=1030%:%
%:%2950=1030%:%
%:%2951=1031%:%
%:%2952=1031%:%
%:%2953=1032%:%
%:%2954=1032%:%
%:%2955=1033%:%
%:%2956=1033%:%
%:%2957=1034%:%
%:%2958=1034%:%
%:%2959=1034%:%
%:%2960=1035%:%
%:%2961=1035%:%
%:%2962=1035%:%
%:%2963=1036%:%
%:%2964=1036%:%
%:%2965=1037%:%
%:%2966=1037%:%
%:%2967=1038%:%
%:%2968=1038%:%
%:%2969=1038%:%
%:%2970=1039%:%
%:%2971=1039%:%
%:%2972=1039%:%
%:%2973=1040%:%
%:%2974=1040%:%
%:%2975=1040%:%
%:%2976=1041%:%
%:%2977=1041%:%
%:%2978=1041%:%
%:%2979=1042%:%
%:%2980=1042%:%
%:%2981=1042%:%
%:%2982=1043%:%
%:%2983=1043%:%
%:%2984=1044%:%
%:%2985=1044%:%
%:%2986=1044%:%
%:%2987=1045%:%
%:%2988=1045%:%
%:%2989=1045%:%
%:%2990=1046%:%
%:%2991=1046%:%
%:%2992=1046%:%
%:%2993=1047%:%
%:%2994=1047%:%
%:%2995=1047%:%
%:%2996=1048%:%
%:%2997=1048%:%
%:%2998=1048%:%
%:%2999=1049%:%
%:%3000=1049%:%
%:%3001=1050%:%
%:%3002=1050%:%
%:%3003=1050%:%
%:%3004=1051%:%
%:%3005=1051%:%
%:%3006=1052%:%
%:%3007=1052%:%
%:%3008=1052%:%
%:%3009=1053%:%
%:%3010=1053%:%
%:%3011=1054%:%
%:%3012=1054%:%
%:%3013=1054%:%
%:%3014=1055%:%
%:%3015=1055%:%
%:%3016=1056%:%
%:%3017=1056%:%
%:%3018=1056%:%
%:%3019=1057%:%
%:%3020=1057%:%
%:%3021=1058%:%
%:%3022=1058%:%
%:%3023=1058%:%
%:%3024=1059%:%
%:%3025=1059%:%
%:%3026=1060%:%
%:%3027=1060%:%
%:%3028=1061%:%
%:%3029=1061%:%
%:%3030=1062%:%
%:%3031=1062%:%
%:%3032=1063%:%
%:%3033=1063%:%
%:%3034=1063%:%
%:%3036=1065%:%
%:%3037=1066%:%
%:%3038=1066%:%
%:%3039=1066%:%
%:%3040=1067%:%
%:%3041=1067%:%
%:%3042=1068%:%
%:%3043=1068%:%
%:%3044=1069%:%
%:%3045=1069%:%
%:%3046=1069%:%
%:%3047=1070%:%
%:%3048=1070%:%
%:%3049=1071%:%
%:%3055=1071%:%
%:%3058=1072%:%
%:%3059=1073%:%
%:%3060=1073%:%
%:%3061=1074%:%
%:%3062=1075%:%
%:%3069=1076%:%
%:%3070=1076%:%
%:%3071=1077%:%
%:%3072=1077%:%
%:%3073=1078%:%
%:%3074=1078%:%
%:%3075=1078%:%
%:%3076=1079%:%
%:%3077=1079%:%
%:%3078=1080%:%
%:%3079=1080%:%
%:%3080=1080%:%
%:%3081=1081%:%
%:%3082=1081%:%
%:%3083=1082%:%
%:%3084=1082%:%
%:%3085=1082%:%
%:%3086=1083%:%
%:%3087=1083%:%
%:%3088=1084%:%
%:%3089=1084%:%
%:%3090=1085%:%
%:%3091=1085%:%
%:%3092=1086%:%
%:%3093=1086%:%
%:%3094=1086%:%
%:%3095=1087%:%
%:%3101=1087%:%
%:%3104=1088%:%
%:%3105=1089%:%
%:%3106=1089%:%
%:%3107=1090%:%
%:%3108=1091%:%
%:%3115=1092%:%
%:%3116=1092%:%
%:%3117=1093%:%
%:%3118=1093%:%
%:%3119=1094%:%
%:%3120=1094%:%
%:%3121=1094%:%
%:%3122=1095%:%
%:%3123=1095%:%
%:%3124=1096%:%
%:%3125=1096%:%
%:%3126=1096%:%
%:%3127=1097%:%
%:%3128=1097%:%
%:%3129=1098%:%
%:%3130=1098%:%
%:%3131=1099%:%
%:%3132=1099%:%
%:%3133=1100%:%
%:%3134=1100%:%
%:%3135=1100%:%
%:%3136=1101%:%
%:%3137=1101%:%
%:%3138=1102%:%
%:%3139=1102%:%
%:%3140=1102%:%
%:%3141=1103%:%
%:%3142=1104%:%
%:%3143=1104%:%
%:%3144=1105%:%
%:%3145=1105%:%
%:%3146=1106%:%
%:%3147=1106%:%
%:%3148=1107%:%
%:%3149=1108%:%
%:%3150=1108%:%
%:%3151=1108%:%
%:%3152=1109%:%
%:%3153=1109%:%
%:%3154=1109%:%
%:%3155=1110%:%
%:%3156=1110%:%
%:%3157=1111%:%
%:%3158=1111%:%
%:%3159=1111%:%
%:%3160=1112%:%
%:%3161=1112%:%
%:%3162=1113%:%
%:%3163=1113%:%
%:%3164=1113%:%
%:%3165=1114%:%
%:%3166=1114%:%
%:%3167=1114%:%
%:%3168=1115%:%
%:%3169=1115%:%
%:%3170=1115%:%
%:%3171=1116%:%
%:%3172=1116%:%
%:%3173=1116%:%
%:%3174=1117%:%
%:%3175=1117%:%
%:%3176=1117%:%
%:%3177=1118%:%
%:%3178=1118%:%
%:%3179=1119%:%
%:%3180=1119%:%
%:%3181=1119%:%
%:%3182=1120%:%
%:%3183=1120%:%
%:%3184=1121%:%
%:%3185=1121%:%
%:%3186=1121%:%
%:%3187=1122%:%
%:%3188=1122%:%
%:%3189=1123%:%
%:%3190=1123%:%
%:%3191=1123%:%
%:%3192=1124%:%
%:%3193=1124%:%
%:%3194=1125%:%
%:%3195=1125%:%
%:%3196=1126%:%
%:%3197=1126%:%
%:%3198=1127%:%
%:%3199=1127%:%
%:%3200=1128%:%
%:%3201=1128%:%
%:%3202=1129%:%
%:%3203=1130%:%
%:%3204=1130%:%
%:%3205=1130%:%
%:%3206=1131%:%
%:%3207=1131%:%
%:%3208=1131%:%
%:%3209=1132%:%
%:%3210=1132%:%
%:%3211=1133%:%
%:%3212=1133%:%
%:%3213=1133%:%
%:%3214=1134%:%
%:%3215=1134%:%
%:%3216=1135%:%
%:%3217=1135%:%
%:%3218=1135%:%
%:%3219=1136%:%
%:%3220=1136%:%
%:%3221=1136%:%
%:%3222=1137%:%
%:%3223=1137%:%
%:%3224=1137%:%
%:%3225=1138%:%
%:%3226=1138%:%
%:%3227=1138%:%
%:%3228=1139%:%
%:%3229=1139%:%
%:%3230=1139%:%
%:%3231=1140%:%
%:%3232=1140%:%
%:%3233=1141%:%
%:%3234=1141%:%
%:%3235=1141%:%
%:%3236=1142%:%
%:%3237=1142%:%
%:%3238=1143%:%
%:%3239=1143%:%
%:%3240=1143%:%
%:%3241=1144%:%
%:%3242=1144%:%
%:%3243=1145%:%
%:%3244=1145%:%
%:%3245=1145%:%
%:%3246=1146%:%
%:%3247=1146%:%
%:%3248=1147%:%
%:%3249=1147%:%
%:%3250=1148%:%
%:%3251=1148%:%
%:%3252=1149%:%
%:%3253=1149%:%
%:%3254=1150%:%
%:%3260=1150%:%
%:%3263=1151%:%
%:%3264=1152%:%
%:%3265=1152%:%
%:%3266=1153%:%
%:%3273=1154%:%
%:%3274=1154%:%
%:%3275=1155%:%
%:%3276=1155%:%
%:%3277=1156%:%
%:%3278=1157%:%
%:%3279=1158%:%
%:%3280=1158%:%
%:%3281=1158%:%
%:%3282=1159%:%
%:%3283=1160%:%
%:%3284=1160%:%
%:%3285=1161%:%
%:%3286=1162%:%
%:%3287=1163%:%
%:%3288=1163%:%
%:%3289=1163%:%
%:%3290=1164%:%
%:%3291=1165%:%
%:%3292=1165%:%
%:%3293=1166%:%
%:%3294=1166%:%
%:%3295=1167%:%
%:%3296=1167%:%
%:%3297=1168%:%
%:%3298=1169%:%
%:%3299=1169%:%
%:%3300=1170%:%
%:%3301=1170%:%
%:%3302=1171%:%
%:%3303=1172%:%
%:%3304=1172%:%
%:%3305=1173%:%
%:%3306=1173%:%
%:%3307=1174%:%
%:%3308=1175%:%
%:%3309=1175%:%
%:%3310=1176%:%
%:%3311=1176%:%
%:%3312=1176%:%
%:%3313=1177%:%
%:%3314=1177%:%
%:%3315=1178%:%
%:%3316=1178%:%
%:%3317=1178%:%
%:%3318=1179%:%
%:%3319=1179%:%
%:%3320=1180%:%
%:%3321=1180%:%
%:%3322=1180%:%
%:%3323=1181%:%
%:%3324=1181%:%
%:%3325=1181%:%
%:%3326=1182%:%
%:%3327=1182%:%
%:%3328=1182%:%
%:%3329=1183%:%
%:%3330=1183%:%
%:%3331=1183%:%
%:%3332=1184%:%
%:%3333=1184%:%
%:%3334=1184%:%
%:%3335=1185%:%
%:%3336=1185%:%
%:%3337=1186%:%
%:%3338=1186%:%
%:%3339=1186%:%
%:%3340=1187%:%
%:%3341=1187%:%
%:%3342=1188%:%
%:%3343=1188%:%
%:%3344=1188%:%
%:%3345=1189%:%
%:%3346=1189%:%
%:%3347=1189%:%
%:%3348=1190%:%
%:%3349=1190%:%
%:%3350=1190%:%
%:%3351=1191%:%
%:%3352=1191%:%
%:%3353=1192%:%
%:%3354=1192%:%
%:%3355=1192%:%
%:%3356=1193%:%
%:%3357=1193%:%
%:%3358=1194%:%
%:%3359=1194%:%
%:%3360=1194%:%
%:%3361=1195%:%
%:%3362=1195%:%
%:%3363=1196%:%
%:%3364=1196%:%
%:%3365=1196%:%
%:%3366=1197%:%
%:%3367=1197%:%
%:%3368=1198%:%
%:%3369=1198%:%
%:%3370=1198%:%
%:%3371=1199%:%
%:%3372=1199%:%
%:%3373=1200%:%
%:%3374=1200%:%
%:%3375=1200%:%
%:%3376=1201%:%
%:%3377=1201%:%
%:%3378=1202%:%
%:%3379=1202%:%
%:%3380=1202%:%
%:%3381=1203%:%
%:%3382=1203%:%
%:%3383=1204%:%
%:%3384=1204%:%
%:%3385=1204%:%
%:%3386=1204%:%
%:%3387=1204%:%
%:%3388=1205%:%
%:%3389=1205%:%
%:%3390=1206%:%
%:%3391=1206%:%
%:%3392=1207%:%
%:%3393=1207%:%
%:%3394=1208%:%
%:%3395=1208%:%
%:%3396=1209%:%
%:%3397=1209%:%
%:%3398=1210%:%
%:%3399=1210%:%
%:%3400=1211%:%
%:%3401=1212%:%
%:%3402=1212%:%
%:%3403=1213%:%
%:%3404=1213%:%
%:%3405=1214%:%
%:%3406=1215%:%
%:%3407=1215%:%
%:%3408=1216%:%
%:%3409=1216%:%
%:%3410=1216%:%
%:%3411=1217%:%
%:%3412=1217%:%
%:%3413=1217%:%
%:%3414=1218%:%
%:%3415=1218%:%
%:%3416=1218%:%
%:%3417=1219%:%
%:%3418=1219%:%
%:%3419=1220%:%
%:%3420=1220%:%
%:%3421=1220%:%
%:%3422=1221%:%
%:%3423=1221%:%
%:%3424=1222%:%
%:%3425=1222%:%
%:%3426=1222%:%
%:%3427=1223%:%
%:%3428=1223%:%
%:%3429=1224%:%
%:%3430=1224%:%
%:%3431=1224%:%
%:%3432=1225%:%
%:%3433=1225%:%
%:%3434=1225%:%
%:%3435=1226%:%
%:%3436=1226%:%
%:%3437=1226%:%
%:%3438=1227%:%
%:%3439=1227%:%
%:%3440=1228%:%
%:%3441=1228%:%
%:%3442=1228%:%
%:%3443=1229%:%
%:%3444=1229%:%
%:%3445=1229%:%
%:%3446=1230%:%
%:%3447=1230%:%
%:%3448=1230%:%
%:%3449=1231%:%
%:%3450=1231%:%
%:%3451=1232%:%
%:%3452=1232%:%
%:%3453=1232%:%
%:%3454=1233%:%
%:%3455=1233%:%
%:%3456=1233%:%
%:%3457=1234%:%
%:%3458=1234%:%
%:%3459=1234%:%
%:%3460=1235%:%
%:%3461=1235%:%
%:%3462=1236%:%
%:%3463=1236%:%
%:%3464=1236%:%
%:%3465=1237%:%
%:%3466=1237%:%
%:%3467=1238%:%
%:%3468=1238%:%
%:%3469=1238%:%
%:%3470=1239%:%
%:%3471=1239%:%
%:%3472=1240%:%
%:%3473=1240%:%
%:%3474=1240%:%
%:%3475=1241%:%
%:%3476=1241%:%
%:%3477=1242%:%
%:%3478=1242%:%
%:%3479=1242%:%
%:%3480=1242%:%
%:%3481=1242%:%
%:%3482=1243%:%
%:%3483=1243%:%
%:%3484=1244%:%
%:%3485=1244%:%
%:%3486=1245%:%
%:%3487=1245%:%
%:%3488=1246%:%
%:%3489=1246%:%
%:%3490=1247%:%
%:%3496=1247%:%
%:%3499=1248%:%
%:%3500=1249%:%
%:%3501=1249%:%
%:%3502=1250%:%
%:%3503=1251%:%
%:%3510=1252%:%
%:%3511=1252%:%
%:%3512=1253%:%
%:%3513=1253%:%
%:%3514=1254%:%
%:%3515=1254%:%
%:%3516=1254%:%
%:%3517=1255%:%
%:%3518=1255%:%
%:%3519=1256%:%
%:%3520=1256%:%
%:%3521=1256%:%
%:%3522=1257%:%
%:%3523=1257%:%
%:%3524=1258%:%
%:%3525=1258%:%
%:%3526=1259%:%
%:%3527=1259%:%
%:%3528=1260%:%
%:%3529=1260%:%
%:%3530=1260%:%
%:%3531=1261%:%
%:%3532=1261%:%
%:%3533=1262%:%
%:%3534=1262%:%
%:%3535=1262%:%
%:%3536=1263%:%
%:%3537=1264%:%
%:%3538=1264%:%
%:%3539=1265%:%
%:%3540=1265%:%
%:%3541=1266%:%
%:%3542=1266%:%
%:%3543=1267%:%
%:%3544=1267%:%
%:%3545=1267%:%
%:%3546=1268%:%
%:%3547=1268%:%
%:%3548=1268%:%
%:%3549=1269%:%
%:%3550=1269%:%
%:%3551=1269%:%
%:%3552=1270%:%
%:%3553=1270%:%
%:%3554=1270%:%
%:%3555=1271%:%
%:%3556=1271%:%
%:%3557=1272%:%
%:%3558=1272%:%
%:%3559=1272%:%
%:%3560=1273%:%
%:%3561=1273%:%
%:%3562=1274%:%
%:%3563=1274%:%
%:%3564=1274%:%
%:%3565=1275%:%
%:%3566=1275%:%
%:%3567=1276%:%
%:%3568=1276%:%
%:%3569=1276%:%
%:%3570=1277%:%
%:%3571=1277%:%
%:%3572=1277%:%
%:%3573=1278%:%
%:%3574=1278%:%
%:%3575=1278%:%
%:%3576=1279%:%
%:%3577=1279%:%
%:%3578=1279%:%
%:%3579=1280%:%
%:%3580=1280%:%
%:%3581=1280%:%
%:%3582=1281%:%
%:%3583=1281%:%
%:%3584=1282%:%
%:%3585=1282%:%
%:%3586=1283%:%
%:%3587=1284%:%
%:%3588=1284%:%
%:%3589=1285%:%
%:%3590=1285%:%
%:%3591=1286%:%
%:%3592=1286%:%
%:%3593=1287%:%
%:%3594=1287%:%
%:%3595=1287%:%
%:%3596=1288%:%
%:%3597=1288%:%
%:%3598=1288%:%
%:%3599=1289%:%
%:%3600=1289%:%
%:%3601=1289%:%
%:%3602=1290%:%
%:%3603=1290%:%
%:%3604=1290%:%
%:%3605=1291%:%
%:%3606=1291%:%
%:%3607=1292%:%
%:%3608=1292%:%
%:%3609=1292%:%
%:%3610=1293%:%
%:%3611=1293%:%
%:%3612=1294%:%
%:%3613=1294%:%
%:%3614=1294%:%
%:%3615=1295%:%
%:%3616=1295%:%
%:%3617=1296%:%
%:%3618=1296%:%
%:%3619=1296%:%
%:%3620=1297%:%
%:%3621=1297%:%
%:%3622=1297%:%
%:%3623=1298%:%
%:%3624=1298%:%
%:%3625=1298%:%
%:%3626=1299%:%
%:%3627=1299%:%
%:%3628=1299%:%
%:%3629=1300%:%
%:%3630=1300%:%
%:%3631=1300%:%
%:%3632=1301%:%
%:%3633=1301%:%
%:%3634=1302%:%
%:%3635=1302%:%
%:%3636=1303%:%
%:%3637=1303%:%
%:%3638=1304%:%
%:%3639=1304%:%
%:%3640=1305%:%
%:%3646=1305%:%
%:%3649=1306%:%
%:%3650=1307%:%
%:%3651=1307%:%
%:%3652=1308%:%
%:%3653=1309%:%
%:%3656=1310%:%
%:%3660=1310%:%
%:%3661=1310%:%
%:%3666=1310%:%
%:%3669=1311%:%
%:%3670=1312%:%
%:%3671=1312%:%
%:%3672=1313%:%
%:%3673=1314%:%
%:%3676=1315%:%
%:%3680=1315%:%
%:%3681=1315%:%
%:%3686=1315%:%
%:%3689=1316%:%
%:%3690=1317%:%
%:%3691=1317%:%
%:%3692=1318%:%
%:%3693=1319%:%
%:%3696=1320%:%
%:%3700=1320%:%
%:%3701=1320%:%
%:%3702=1320%:%
%:%3707=1320%:%
%:%3710=1321%:%
%:%3711=1322%:%
%:%3712=1322%:%
%:%3713=1323%:%
%:%3714=1324%:%
%:%3717=1325%:%
%:%3721=1325%:%
%:%3722=1325%:%
%:%3727=1325%:%
%:%3730=1326%:%
%:%3731=1327%:%
%:%3732=1327%:%
%:%3733=1328%:%
%:%3734=1329%:%
%:%3737=1330%:%
%:%3741=1330%:%
%:%3742=1330%:%
%:%3751=1332%:%
%:%3753=1333%:%
%:%3754=1333%:%
%:%3755=1334%:%
%:%3756=1335%:%
%:%3757=1336%:%
%:%3758=1336%:%
%:%3759=1337%:%
%:%3766=1338%:%
%:%3767=1338%:%
%:%3768=1339%:%
%:%3769=1339%:%
%:%3770=1340%:%
%:%3771=1341%:%
%:%3772=1342%:%
%:%3773=1342%:%
%:%3774=1343%:%
%:%3775=1343%:%
%:%3776=1344%:%
%:%3777=1344%:%
%:%3778=1345%:%
%:%3779=1345%:%
%:%3780=1346%:%
%:%3781=1346%:%
%:%3782=1347%:%
%:%3783=1347%:%
%:%3784=1347%:%
%:%3785=1347%:%
%:%3786=1348%:%
%:%3787=1348%:%
%:%3788=1348%:%
%:%3789=1349%:%
%:%3790=1349%:%
%:%3791=1349%:%
%:%3792=1349%:%
%:%3793=1350%:%
%:%3794=1350%:%
%:%3795=1350%:%
%:%3796=1351%:%
%:%3797=1351%:%
%:%3798=1352%:%
%:%3799=1352%:%
%:%3800=1353%:%
%:%3801=1353%:%
%:%3802=1354%:%
%:%3803=1354%:%
%:%3804=1355%:%
%:%3805=1355%:%
%:%3806=1356%:%
%:%3807=1356%:%
%:%3808=1357%:%
%:%3809=1357%:%
%:%3810=1358%:%
%:%3811=1358%:%
%:%3812=1358%:%
%:%3813=1359%:%
%:%3814=1359%:%
%:%3815=1359%:%
%:%3816=1360%:%
%:%3817=1361%:%
%:%3818=1361%:%
%:%3819=1362%:%
%:%3820=1362%:%
%:%3821=1362%:%
%:%3822=1363%:%
%:%3823=1363%:%
%:%3824=1364%:%
%:%3825=1365%:%
%:%3826=1365%:%
%:%3827=1366%:%
%:%3828=1366%:%
%:%3829=1367%:%
%:%3830=1368%:%
%:%3831=1368%:%
%:%3832=1368%:%
%:%3833=1369%:%
%:%3834=1369%:%
%:%3835=1369%:%
%:%3836=1370%:%
%:%3837=1371%:%
%:%3838=1371%:%
%:%3839=1372%:%
%:%3840=1372%:%
%:%3841=1372%:%
%:%3842=1373%:%
%:%3843=1374%:%
%:%3844=1374%:%
%:%3845=1375%:%
%:%3846=1375%:%
%:%3847=1375%:%
%:%3848=1376%:%
%:%3849=1377%:%
%:%3850=1377%:%
%:%3851=1378%:%
%:%3852=1378%:%
%:%3853=1378%:%
%:%3854=1378%:%
%:%3855=1378%:%
%:%3856=1379%:%
%:%3857=1379%:%
%:%3858=1380%:%
%:%3859=1380%:%
%:%3860=1381%:%
%:%3861=1382%:%
%:%3862=1382%:%
%:%3863=1383%:%
%:%3864=1383%:%
%:%3865=1384%:%
%:%3866=1385%:%
%:%3867=1385%:%
%:%3868=1385%:%
%:%3869=1386%:%
%:%3870=1386%:%
%:%3871=1386%:%
%:%3872=1387%:%
%:%3873=1388%:%
%:%3874=1388%:%
%:%3875=1389%:%
%:%3876=1389%:%
%:%3877=1389%:%
%:%3878=1390%:%
%:%3879=1391%:%
%:%3880=1391%:%
%:%3881=1392%:%
%:%3882=1392%:%
%:%3883=1392%:%
%:%3884=1393%:%
%:%3885=1394%:%
%:%3886=1394%:%
%:%3887=1395%:%
%:%3888=1395%:%
%:%3889=1395%:%
%:%3890=1395%:%
%:%3891=1395%:%
%:%3892=1396%:%
%:%3893=1396%:%
%:%3894=1397%:%
%:%3895=1397%:%
%:%3896=1398%:%
%:%3897=1399%:%
%:%3898=1399%:%
%:%3899=1399%:%
%:%3900=1400%:%
%:%3901=1400%:%
%:%3902=1400%:%
%:%3903=1401%:%
%:%3904=1402%:%
%:%3905=1402%:%
%:%3906=1402%:%
%:%3907=1403%:%
%:%3908=1403%:%
%:%3909=1404%:%
%:%3910=1404%:%
%:%3911=1405%:%
%:%3912=1405%:%
%:%3913=1406%:%
%:%3914=1406%:%
%:%3915=1407%:%
%:%3916=1407%:%
%:%3917=1407%:%
%:%3918=1408%:%
%:%3919=1408%:%
%:%3920=1408%:%
%:%3921=1409%:%
%:%3922=1409%:%
%:%3923=1409%:%
%:%3924=1410%:%
%:%3925=1410%:%
%:%3926=1410%:%
%:%3927=1411%:%
%:%3928=1411%:%
%:%3929=1412%:%
%:%3930=1412%:%
%:%3931=1413%:%
%:%3932=1413%:%
%:%3933=1413%:%
%:%3934=1414%:%
%:%3935=1414%:%
%:%3936=1414%:%
%:%3937=1415%:%
%:%3938=1415%:%
%:%3939=1416%:%
%:%3940=1416%:%
%:%3941=1417%:%
%:%3942=1417%:%
%:%3943=1418%:%
%:%3944=1418%:%
%:%3945=1419%:%
%:%3946=1419%:%
%:%3947=1419%:%
%:%3948=1420%:%
%:%3949=1420%:%
%:%3950=1420%:%
%:%3951=1421%:%
%:%3952=1421%:%
%:%3953=1421%:%
%:%3954=1422%:%
%:%3955=1422%:%
%:%3956=1422%:%
%:%3957=1423%:%
%:%3958=1423%:%
%:%3959=1423%:%
%:%3960=1424%:%
%:%3961=1424%:%
%:%3962=1424%:%
%:%3963=1425%:%
%:%3964=1425%:%
%:%3965=1425%:%
%:%3966=1426%:%
%:%3967=1426%:%
%:%3968=1426%:%
%:%3969=1427%:%
%:%3970=1427%:%
%:%3971=1428%:%
%:%3972=1428%:%
%:%3973=1428%:%
%:%3974=1429%:%
%:%3975=1429%:%
%:%3976=1429%:%
%:%3977=1430%:%
%:%3978=1430%:%
%:%3979=1430%:%
%:%3980=1431%:%
%:%3981=1431%:%
%:%3982=1431%:%
%:%3983=1432%:%
%:%3984=1432%:%
%:%3985=1432%:%
%:%3986=1433%:%
%:%3987=1433%:%
%:%3988=1434%:%
%:%3989=1434%:%
%:%3990=1435%:%
%:%3991=1435%:%
%:%3992=1436%:%
%:%3993=1436%:%
%:%3994=1436%:%
%:%3995=1437%:%
%:%3996=1437%:%
%:%3997=1437%:%
%:%3998=1438%:%
%:%3999=1438%:%
%:%4000=1439%:%
%:%4001=1439%:%
%:%4002=1439%:%
%:%4003=1440%:%
%:%4004=1440%:%
%:%4005=1440%:%
%:%4006=1441%:%
%:%4007=1441%:%
%:%4008=1441%:%
%:%4009=1442%:%
%:%4010=1442%:%
%:%4011=1442%:%
%:%4012=1443%:%
%:%4013=1443%:%
%:%4014=1443%:%
%:%4015=1444%:%
%:%4016=1444%:%
%:%4017=1444%:%
%:%4018=1445%:%
%:%4019=1445%:%
%:%4020=1445%:%
%:%4021=1446%:%
%:%4022=1446%:%
%:%4023=1446%:%
%:%4024=1447%:%
%:%4025=1447%:%
%:%4026=1448%:%
%:%4027=1448%:%
%:%4028=1448%:%
%:%4029=1449%:%
%:%4030=1449%:%
%:%4031=1449%:%
%:%4032=1450%:%
%:%4033=1450%:%
%:%4034=1450%:%
%:%4035=1451%:%
%:%4036=1451%:%
%:%4037=1451%:%
%:%4038=1452%:%
%:%4039=1452%:%
%:%4040=1452%:%
%:%4041=1453%:%
%:%4042=1453%:%
%:%4043=1454%:%
%:%4044=1454%:%
%:%4045=1455%:%
%:%4046=1455%:%
%:%4047=1456%:%
%:%4048=1456%:%
%:%4049=1456%:%
%:%4050=1457%:%
%:%4051=1457%:%
%:%4052=1457%:%
%:%4053=1458%:%
%:%4054=1458%:%
%:%4055=1459%:%
%:%4056=1459%:%
%:%4057=1460%:%
%:%4058=1460%:%
%:%4059=1461%:%
%:%4060=1461%:%
%:%4061=1461%:%
%:%4062=1462%:%
%:%4063=1462%:%
%:%4064=1462%:%
%:%4065=1463%:%
%:%4066=1463%:%
%:%4067=1464%:%
%:%4068=1464%:%
%:%4069=1465%:%
%:%4070=1465%:%
%:%4071=1466%:%
%:%4072=1466%:%
%:%4073=1467%:%
%:%4074=1467%:%
%:%4075=1467%:%
%:%4076=1467%:%
%:%4077=1468%:%
%:%4078=1468%:%
%:%4079=1468%:%
%:%4080=1469%:%
%:%4081=1469%:%
%:%4082=1469%:%
%:%4083=1470%:%
%:%4084=1470%:%
%:%4085=1470%:%
%:%4086=1471%:%
%:%4087=1471%:%
%:%4088=1471%:%
%:%4089=1472%:%
%:%4090=1472%:%
%:%4091=1473%:%
%:%4092=1474%:%
%:%4093=1474%:%
%:%4094=1475%:%
%:%4095=1476%:%
%:%4096=1476%:%
%:%4097=1477%:%
%:%4098=1477%:%
%:%4099=1478%:%
%:%4100=1478%:%
%:%4101=1479%:%
%:%4102=1479%:%
%:%4103=1480%:%
%:%4104=1480%:%
%:%4105=1481%:%
%:%4106=1481%:%
%:%4107=1481%:%
%:%4108=1482%:%
%:%4109=1482%:%
%:%4110=1483%:%
%:%4111=1483%:%
%:%4112=1483%:%
%:%4113=1484%:%
%:%4114=1484%:%
%:%4115=1485%:%
%:%4116=1485%:%
%:%4117=1485%:%
%:%4118=1486%:%
%:%4119=1486%:%
%:%4120=1487%:%
%:%4121=1487%:%
%:%4122=1487%:%
%:%4123=1488%:%
%:%4124=1488%:%
%:%4125=1489%:%
%:%4126=1489%:%
%:%4127=1489%:%
%:%4128=1490%:%
%:%4129=1490%:%
%:%4130=1490%:%
%:%4131=1491%:%
%:%4132=1491%:%
%:%4133=1491%:%
%:%4134=1492%:%
%:%4135=1492%:%
%:%4136=1493%:%
%:%4137=1493%:%
%:%4138=1493%:%
%:%4139=1494%:%
%:%4140=1494%:%
%:%4141=1495%:%
%:%4142=1495%:%
%:%4143=1495%:%
%:%4144=1496%:%
%:%4145=1496%:%
%:%4146=1497%:%
%:%4147=1497%:%
%:%4148=1497%:%
%:%4149=1498%:%
%:%4150=1498%:%
%:%4151=1498%:%
%:%4152=1499%:%
%:%4153=1499%:%
%:%4154=1499%:%
%:%4155=1499%:%
%:%4156=1499%:%
%:%4157=1500%:%
%:%4158=1500%:%
%:%4159=1501%:%
%:%4160=1501%:%
%:%4161=1502%:%
%:%4162=1502%:%
%:%4163=1503%:%
%:%4164=1503%:%
%:%4165=1504%:%
%:%4166=1504%:%
%:%4167=1505%:%
%:%4168=1505%:%
%:%4169=1505%:%
%:%4170=1506%:%
%:%4171=1506%:%
%:%4172=1507%:%
%:%4173=1507%:%
%:%4174=1507%:%
%:%4175=1508%:%
%:%4176=1508%:%
%:%4177=1509%:%
%:%4178=1509%:%
%:%4179=1509%:%
%:%4180=1510%:%
%:%4181=1510%:%
%:%4182=1511%:%
%:%4183=1511%:%
%:%4184=1511%:%
%:%4185=1512%:%
%:%4186=1512%:%
%:%4187=1513%:%
%:%4188=1513%:%
%:%4189=1513%:%
%:%4190=1514%:%
%:%4191=1514%:%
%:%4192=1514%:%
%:%4193=1515%:%
%:%4194=1515%:%
%:%4195=1515%:%
%:%4196=1516%:%
%:%4197=1516%:%
%:%4198=1517%:%
%:%4199=1517%:%
%:%4200=1517%:%
%:%4201=1518%:%
%:%4202=1518%:%
%:%4203=1519%:%
%:%4204=1519%:%
%:%4205=1519%:%
%:%4206=1520%:%
%:%4207=1520%:%
%:%4208=1521%:%
%:%4209=1521%:%
%:%4210=1521%:%
%:%4211=1522%:%
%:%4212=1522%:%
%:%4213=1522%:%
%:%4214=1523%:%
%:%4215=1523%:%
%:%4216=1523%:%
%:%4217=1523%:%
%:%4218=1523%:%
%:%4219=1524%:%
%:%4220=1524%:%
%:%4221=1525%:%
%:%4222=1525%:%
%:%4223=1526%:%
%:%4224=1526%:%
%:%4225=1526%:%
%:%4226=1527%:%
%:%4227=1527%:%
%:%4228=1527%:%
%:%4229=1528%:%
%:%4230=1528%:%
%:%4231=1528%:%
%:%4232=1529%:%
%:%4233=1529%:%
%:%4234=1530%:%
%:%4235=1530%:%
%:%4236=1530%:%
%:%4237=1531%:%
%:%4238=1531%:%
%:%4239=1532%:%
%:%4240=1532%:%
%:%4241=1532%:%
%:%4242=1533%:%
%:%4243=1533%:%
%:%4244=1534%:%
%:%4245=1534%:%
%:%4246=1534%:%
%:%4247=1535%:%
%:%4248=1535%:%
%:%4249=1535%:%
%:%4250=1536%:%
%:%4256=1536%:%
%:%4261=1537%:%
%:%4266=1538%:%
