%
\begin{isabellebody}%
\setisabellecontext{Cfunc}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Basic Types and Operators for the Category of Sets%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Cfunc\isanewline
\ \ \isakeyword{imports}\ Main\ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Eisbach{\isachardot}{\kern0pt}Eisbach{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{typedecl}\isamarkupfalse%
\ cset\isanewline
\isacommand{typedecl}\isamarkupfalse%
\ cfunc%
\begin{isamarkuptext}%
We declare \isa{cset} and \isa{cfunc} as types to represent the sets and functions within
  ETCS, as distinct from HOL sets and functions.
  The "c" prefix here is intended to stand for "category", and emphasises that these are
  category-theoretic objects.%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
The axiomatization below corresponds to Axiom 1 (Sets Is a Category) in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{axiomatization}\isamarkupfalse%
\isanewline
\ \ domain\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ codomain\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ comp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymcirc}\isactrlsub c{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeyword{and}\isanewline
\ \ id\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}id\isactrlsub c{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \isanewline
\isakeyword{where}\isanewline
\ \ domain{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f\ {\isasymLongrightarrow}\ domain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ codomain{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f\ {\isasymLongrightarrow}\ codomain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ codomain\ g{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ comp{\isacharunderscore}{\kern0pt}associative{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ h\ {\isacharequal}{\kern0pt}\ codomain\ g\ {\isasymLongrightarrow}\ domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f\ {\isasymLongrightarrow}\ h\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}h\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ id{\isacharunderscore}{\kern0pt}domain{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ id{\isacharunderscore}{\kern0pt}codomain{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ id\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id\ {\isacharparenleft}{\kern0pt}codomain\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}%
\begin{isamarkuptext}%
We define a neater way of stating types and lift the type axioms into lemmas using it.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isasymrightarrow}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{5}}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{5}}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{5}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{5}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}domain\ f\ {\isacharequal}{\kern0pt}\ X\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\ {\isasymLongrightarrow}\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ codomain{\isacharunderscore}{\kern0pt}comp\ domain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\ {\isasymLongrightarrow}\ h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ W\ {\isasymLongrightarrow}\ h\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}h\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id\ X\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}codomain\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ f\ {\isasymcirc}\isactrlsub c\ id\ X\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ id\ Y\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Tactics for Applying Typing Rules%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
ETCS lemmas often have assumptions on its ETCS type, which can often be cumbersome to prove.
  To simplify proofs involving ETCS types, we provide proof methods that apply type rules in a
  structured way to prove facts about ETCS function types.
  The type rules state the types of the basic constants and operators of ETCS and are declared as
  a named set of theorems called $type\_rule$.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{named{\isacharunderscore}{\kern0pt}theorems}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}rule\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}\isanewline
\isacommand{declare}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{ML{\isacharunderscore}{\kern0pt}file}\isamarkupfalse%
\ {\isacartoucheopen}typecheck{\isachardot}{\kern0pt}ml{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{typecheck\_cfuncs: Tactic to Construct Type Facts%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}Scan{\isachardot}{\kern0pt}option\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}thms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isachargreater}{\kern0pt}{\isachargreater}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharunderscore}{\kern0pt}method{\isacartoucheclose}\isanewline
\ \ {\isachardoublequoteopen}Check\ types\ of\ cfuncs\ in\ current\ goal\ and\ add\ as\ assumptions\ of\ the\ current\ goal{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}Scan{\isachardot}{\kern0pt}option\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}thms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isachargreater}{\kern0pt}{\isachargreater}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}method{\isacartoucheclose}\isanewline
\ \ {\isachardoublequoteopen}Check\ types\ of\ cfuncs\ in\ all\ subgoals\ and\ add\ as\ assumptions\ of\ the\ current\ goal{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharunderscore}{\kern0pt}prems\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}Scan{\isachardot}{\kern0pt}option\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}thms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isachargreater}{\kern0pt}{\isachargreater}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharunderscore}{\kern0pt}prems{\isacharunderscore}{\kern0pt}method{\isacartoucheclose}\isanewline
\ \ {\isachardoublequoteopen}Check\ types\ of\ cfuncs\ in\ assumptions\ of\ the\ current\ goal\ and\ add\ as\ assumptions\ of\ the\ current\ goal{\isachardoublequoteclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{etcs\_rule: Tactic to Apply Rules with ETCS Typechecking%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}rule\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isacartoucheopen}Scan{\isachardot}{\kern0pt}repeats\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}unless\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}multi{\isacharunderscore}{\kern0pt}thm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Scan{\isachardot}{\kern0pt}option\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}thms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isachargreater}{\kern0pt}{\isachargreater}{\kern0pt}\ ETCS{\isacharunderscore}{\kern0pt}resolve{\isacharunderscore}{\kern0pt}method{\isacartoucheclose}\isanewline
\ \ {\isachardoublequoteopen}apply\ rule\ with\ ETCS\ type\ checking{\isachardoublequoteclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{etcs\_subst: Tactic to Apply Substitutions with ETCS Typechecking%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}subst\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isacartoucheopen}Scan{\isachardot}{\kern0pt}repeats\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}unless\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}multi{\isacharunderscore}{\kern0pt}thm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Scan{\isachardot}{\kern0pt}option\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}thms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isachargreater}{\kern0pt}{\isachargreater}{\kern0pt}\ ETCS{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}method{\isacartoucheclose}\ \isanewline
\ \ {\isachardoublequoteopen}apply\ substitution\ with\ ETCS\ type\ checking{\isachardoublequoteclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{method}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}assocl\ \isakeyword{declares}\ type{\isacharunderscore}{\kern0pt}rule\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\isacommand{method}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}assocr\ \isakeyword{declares}\ type{\isacharunderscore}{\kern0pt}rule\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ sym{\isacharbrackleft}{\kern0pt}OF\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}asm\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isacartoucheopen}Runtime{\isachardot}{\kern0pt}exn{\isacharunderscore}{\kern0pt}trace\ {\isacharparenleft}{\kern0pt}fn\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ Scan{\isachardot}{\kern0pt}repeats\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}unless\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}multi{\isacharunderscore}{\kern0pt}thm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Scan{\isachardot}{\kern0pt}option\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}thms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isachargreater}{\kern0pt}{\isachargreater}{\kern0pt}\ ETCS{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}asm{\isacharunderscore}{\kern0pt}method{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ \isanewline
\ \ {\isachardoublequoteopen}apply\ substitution\ to\ assumptions\ of\ the\ goal{\isacharcomma}{\kern0pt}\ with\ ETCS\ type\ checking{\isachardoublequoteclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{method}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}assocl{\isacharunderscore}{\kern0pt}asm\ \isakeyword{declares}\ type{\isacharunderscore}{\kern0pt}rule\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}asm\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\isacommand{method}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}assocr{\isacharunderscore}{\kern0pt}asm\ \isakeyword{declares}\ type{\isacharunderscore}{\kern0pt}rule\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}asm\ sym{\isacharbrackleft}{\kern0pt}OF\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{etcs\_erule: Tactic to Apply Elimination Rules with ETCS Typechecking%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ etcs{\isacharunderscore}{\kern0pt}erule\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isacartoucheopen}Scan{\isachardot}{\kern0pt}repeats\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}unless\ {\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}multi{\isacharunderscore}{\kern0pt}thm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Scan{\isachardot}{\kern0pt}option\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Scan{\isachardot}{\kern0pt}lift\ {\isacharparenleft}{\kern0pt}Args{\isachardot}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}{\isachardollar}{\kern0pt}\ {\isachardoublequote}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isachardoublequote}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Args{\isachardot}{\kern0pt}colon{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbar}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}\ Attrib{\isachardot}{\kern0pt}thms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isachargreater}{\kern0pt}{\isachargreater}{\kern0pt}\ ETCS{\isacharunderscore}{\kern0pt}eresolve{\isacharunderscore}{\kern0pt}method{\isacartoucheclose}\isanewline
\ \ {\isachardoublequoteopen}apply\ erule\ with\ ETCS\ type\ checking{\isachardoublequoteclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Monomorphisms, Epimorphisms and Isomorphisms%
}
\isamarkuptrue%
%
\isamarkupsubsubsection{Monomorphisms%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ monomorphism\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}monomorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ g\ h{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}codomain\ g\ {\isacharequal}{\kern0pt}\ domain\ f\ {\isasymand}\ codomain\ h\ {\isacharequal}{\kern0pt}\ domain\ f{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ h\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}monomorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ g\ h\ A\ X\ Y{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ h\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ h\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ domain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monomorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ g\ h\ A{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ h\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ h\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Exercise 2.1.7a in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monomorphism\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ monomorphism\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ s\ t\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ gf{\isacharunderscore}{\kern0pt}monic{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}s{\isachardot}{\kern0pt}\ {\isasymforall}t{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ codomain\ s\ {\isacharequal}{\kern0pt}\ domain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymand}\ codomain\ t\ {\isacharequal}{\kern0pt}\ domain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ t\ {\isasymlongrightarrow}\ s\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ s\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ t\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ s\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ t{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ codomain{\isacharunderscore}{\kern0pt}s\ codomain{\isacharunderscore}{\kern0pt}t\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ gf{\isacharunderscore}{\kern0pt}monic\ codomain{\isacharunderscore}{\kern0pt}s\ codomain{\isacharunderscore}{\kern0pt}t\ domain{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monomorphism\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ monomorphism\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Exercise 2.1.7c in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ composition{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}monic{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}codomain\ f\ {\isacharequal}{\kern0pt}\ domain\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monomorphism\ f\ {\isasymLongrightarrow}\ monomorphism\ g\ {\isasymLongrightarrow}\ monomorphism\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ h\ k\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}s\ t{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ codomain\ s\ {\isacharequal}{\kern0pt}\ domain\ f\ {\isasymand}\ codomain\ t\ {\isacharequal}{\kern0pt}\ domain\ f\ {\isasymlongrightarrow}\ f\ {\isasymcirc}\isactrlsub c\ s\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ t\ {\isasymlongrightarrow}\ s\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}s{\isachardot}{\kern0pt}\ {\isasymforall}t{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ codomain\ s\ {\isacharequal}{\kern0pt}\ domain\ g\ {\isasymand}\ codomain\ t\ {\isacharequal}{\kern0pt}\ domain\ g\ {\isasymlongrightarrow}\ g\ {\isasymcirc}\isactrlsub c\ s\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ t\ {\isasymlongrightarrow}\ s\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}k{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ k\ {\isacharequal}{\kern0pt}\ domain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ h\ {\isacharequal}{\kern0pt}\ domain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ gfh{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}gfk{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ \ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ codomain{\isacharunderscore}{\kern0pt}h\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ gfh{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}gfk{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ codomain{\isacharunderscore}{\kern0pt}k\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ codomain{\isacharunderscore}{\kern0pt}h\ codomain{\isacharunderscore}{\kern0pt}k\ comp{\isacharunderscore}{\kern0pt}type\ domain{\isacharunderscore}{\kern0pt}comp\ g{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ codomain{\isacharunderscore}{\kern0pt}h\ codomain{\isacharunderscore}{\kern0pt}k\ domain{\isacharunderscore}{\kern0pt}comp\ f{\isacharunderscore}{\kern0pt}mono\ assms{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Epimorphisms%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ epimorphism\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}epimorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ g\ h{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f\ {\isasymand}\ domain\ h\ {\isacharequal}{\kern0pt}\ codomain\ f{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ f\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ epimorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}epimorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ g\ h\ A\ X\ Y{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymand}\ g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ A\ {\isasymand}\ h\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ A\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ f\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ epimorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ codomain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ epimorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}epimorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ g\ h\ A{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ A\ {\isasymand}\ h\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ A\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ f\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ epimorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Exercise 2.1.7b in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}epimorphism\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ epimorphism\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ epimorphism{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ s\ t\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ gf{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}s{\isachardot}{\kern0pt}\ {\isasymforall}t{\isachardot}{\kern0pt}\isanewline
\ \ \ \ domain\ s\ {\isacharequal}{\kern0pt}\ codomain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymand}\ domain\ t\ {\isacharequal}{\kern0pt}\ codomain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ s\ {\isasymcirc}\isactrlsub c\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ t\ {\isasymcirc}\isactrlsub c\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isasymlongrightarrow}\ s\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ s\ {\isacharequal}{\kern0pt}\ codomain\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ t\ {\isacharequal}{\kern0pt}\ codomain\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ sf{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}tf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ t\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sf{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}tf\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}s\ domain{\isacharunderscore}{\kern0pt}t{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ gf{\isacharunderscore}{\kern0pt}epi\ codomain{\isacharunderscore}{\kern0pt}comp\ domain{\isacharunderscore}{\kern0pt}s\ domain{\isacharunderscore}{\kern0pt}t\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Exercise 2.1.7d in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ composition{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\isanewline
\isakeyword{assumes}\ {\isachardoublequoteopen}codomain\ f\ {\isacharequal}{\kern0pt}\ domain\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}epimorphism\ f\ {\isasymLongrightarrow}\ epimorphism\ g\ {\isasymLongrightarrow}\ epimorphism\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ epimorphism{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ h\ k\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}epi\ {\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymforall}\ s\ h{\isachardot}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}domain\ s\ {\isacharequal}{\kern0pt}\ codomain\ f\ {\isasymand}\ domain\ h\ {\isacharequal}{\kern0pt}\ codomain\ f{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}s\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ f\ {\isasymlongrightarrow}\ s\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}epi\ {\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymforall}\ s\ h{\isachardot}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}domain\ s\ {\isacharequal}{\kern0pt}\ codomain\ g\ {\isasymand}\ domain\ h\ {\isacharequal}{\kern0pt}\ codomain\ g{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}s\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ g\ {\isasymlongrightarrow}\ s\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}k{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ k\ {\isacharequal}{\kern0pt}\ codomain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ h\ {\isacharequal}{\kern0pt}\ codomain\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hgf{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}kgf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}h\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ codomain{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}h{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ hgf{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}kgf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}k\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ codomain{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}k{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ codomain{\isacharunderscore}{\kern0pt}comp\ domain{\isacharunderscore}{\kern0pt}comp\ domain{\isacharunderscore}{\kern0pt}h\ domain{\isacharunderscore}{\kern0pt}k\ f{\isacharunderscore}{\kern0pt}epi{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ codomain{\isacharunderscore}{\kern0pt}comp\ domain{\isacharunderscore}{\kern0pt}h\ domain{\isacharunderscore}{\kern0pt}k\ g{\isacharunderscore}{\kern0pt}epi\ assms{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Isomorphisms%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ isomorphism\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}isomorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ g{\isachardot}{\kern0pt}\ domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f\ {\isasymand}\ codomain\ g\ {\isacharequal}{\kern0pt}\ domain\ f\ {\isasymand}\ \isanewline
\ \ \ \ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymand}\ f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}isomorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ g\ X\ Y{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymand}\ g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ X\ {\isasymand}\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\ X\ {\isasymand}\ f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}isomorphism\ f\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ g{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ X\ {\isasymand}\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\ X\ {\isasymand}\ f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ inverse\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbold {\isasyminverse}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ {\isadigit{9}}{\isadigit{9}}{\isadigit{9}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}inverse\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ g{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ codomain\ f\ {\isasymrightarrow}\ domain\ f\ {\isasymand}\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymand}\ f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}codomain\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlbold {\isasyminverse}\ {\isacharcolon}{\kern0pt}\ codomain\ f\ {\isasymrightarrow}\ domain\ f\ {\isasymand}\ f\isactrlbold {\isasyminverse}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymand}\ f\ {\isasymcirc}\isactrlsub c\ f\isactrlbold {\isasyminverse}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}codomain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ safe{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}g{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ codomain\ f\ {\isasymrightarrow}\ domain\ f\ {\isasymand}\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymand}\ f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}codomain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g{\isadigit{1}}\ g{\isadigit{2}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ f{\isacharunderscore}{\kern0pt}g{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}codomain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isadigit{2}}{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isadigit{2}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ f{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}codomain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ codomain\ f\ {\isasymrightarrow}\ domain\ f{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ codomain\ f\ {\isasymrightarrow}\ domain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}codomain\ g{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\ {\isachardoublequoteopen}domain\ g{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ codomain\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ g{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ comp{\isacharunderscore}{\kern0pt}associative\ f{\isacharunderscore}{\kern0pt}g{\isadigit{1}}\ g{\isadigit{2}}{\isacharunderscore}{\kern0pt}f\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlbold {\isasyminverse}\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlbold {\isasyminverse}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ f\isactrlbold {\isasyminverse}\ {\isacharequal}{\kern0pt}\ id\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}f\isactrlbold {\isasyminverse}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{unfolding}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}f{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}idempotent{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlbold {\isasyminverse}{\isacharparenright}{\kern0pt}\isactrlbold {\isasyminverse}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ inv{\isacharunderscore}{\kern0pt}iso\ inverse{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infix}\ {\isachardoublequoteopen}{\isasymcong}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}X\ {\isasymcong}\ Y\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ f{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y\ {\isasymand}\ isomorphism\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}isomorphism{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}id\ X{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ auto\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}codomain\ id{\isacharunderscore}{\kern0pt}domain{\isacharcomma}{\kern0pt}\ metis\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}reflexive{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}id\ X{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ auto\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}codomain\ id{\isacharunderscore}{\kern0pt}isomorphism\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymcong}\ Y\ {\isasymlongrightarrow}\ Y\ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}domain\ f\ {\isacharequal}{\kern0pt}\ codomain\ g\ {\isasymLongrightarrow}\ isomorphism\ f\ {\isasymLongrightarrow}\ isomorphism\ g\ {\isasymLongrightarrow}\ isomorphism\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto{\isacharcomma}{\kern0pt}\ smt\ codomain{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}comp\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}comp{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}isomorphism\ f\ {\isasymLongrightarrow}\ isomorphism\ g\ {\isasymLongrightarrow}\ isomorphism\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcong}\ Y\ {\isasymand}\ Y\ {\isasymcong}\ Z{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ X\ {\isasymcong}\ Z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ isomorphism{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}equiv{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}equiv\ UNIV\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ X\ {\isasymcong}\ Y{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ equiv{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}refl\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymcong}\ y{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ refl{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}reflexive\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sym\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymcong}\ y{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sym{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}trans\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymcong}\ y{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ trans{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Exercise 2.1.7e in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}isomorphism\ f\ {\isasymLongrightarrow}\ epimorphism\ f\ {\isasymand}\ monomorphism\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}def\ epimorphism{\isacharunderscore}{\kern0pt}def\ monomorphism{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\ s\ t\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}g{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}g{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ g\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ gf{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ fg{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ s\ {\isacharequal}{\kern0pt}\ codomain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ t\ {\isacharequal}{\kern0pt}\ codomain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ sf{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}tf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ t\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ s\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}codomain{\isacharparenleft}{\kern0pt}f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ domain{\isacharunderscore}{\kern0pt}s\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ s\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ domain{\isacharunderscore}{\kern0pt}g\ fg{\isacharunderscore}{\kern0pt}id{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ codomain{\isacharunderscore}{\kern0pt}g\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}s{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}t\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sf{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}tf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ codomain{\isacharunderscore}{\kern0pt}g\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}t{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}codomain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ domain{\isacharunderscore}{\kern0pt}g\ fg{\isacharunderscore}{\kern0pt}id{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ domain{\isacharunderscore}{\kern0pt}t\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\ \ \ \ \isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\ h\ k\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ domain{\isacharunderscore}{\kern0pt}g{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain\ g\ {\isacharequal}{\kern0pt}\ codomain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}g{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ g\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ gf{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ fg{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ h\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ codomain{\isacharunderscore}{\kern0pt}k{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}codomain\ k\ {\isacharequal}{\kern0pt}\ domain\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}fh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ k\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ codomain{\isacharunderscore}{\kern0pt}h\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ gf{\isacharunderscore}{\kern0pt}id\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ codomain{\isacharunderscore}{\kern0pt}h\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}fh{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ codomain{\isacharunderscore}{\kern0pt}k\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ gf{\isacharunderscore}{\kern0pt}id{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ codomain{\isacharunderscore}{\kern0pt}k\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ isomorphism{\isacharunderscore}{\kern0pt}sandwich{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ B{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ B\ {\isasymrightarrow}\ C{\isachardoublequoteclose}\ \isakeyword{and}\ h{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h{\isacharcolon}{\kern0pt}\ C\ {\isasymrightarrow}\ D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ h{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism\ h{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ hgf{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}h\ {\isasymcirc}\isactrlsub c\ g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}isomorphism\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}h\isactrlbold {\isasyminverse}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}h\ {\isasymcirc}\isactrlsub c\ g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\isactrlbold {\isasyminverse}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ f{\isacharunderscore}{\kern0pt}iso\ h{\isacharunderscore}{\kern0pt}iso\ hgf{\isacharunderscore}{\kern0pt}iso\ inv{\isacharunderscore}{\kern0pt}iso\ isomorphism{\isacharunderscore}{\kern0pt}comp{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharunderscore}{\kern0pt}prems{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}left\ inv{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/ETCS/Category_Set/Cfunc.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%35=5%:%
%:%38=6%:%
%:%39=7%:%
%:%40=7%:%
%:%41=8%:%
%:%42=8%:%
%:%44=10%:%
%:%45=11%:%
%:%46=12%:%
%:%47=13%:%
%:%51=15%:%
%:%53=16%:%
%:%54=16%:%
%:%55=17%:%
%:%56=18%:%
%:%57=19%:%
%:%58=20%:%
%:%59=21%:%
%:%60=22%:%
%:%61=23%:%
%:%62=24%:%
%:%63=25%:%
%:%64=26%:%
%:%65=27%:%
%:%66=28%:%
%:%68=31%:%
%:%70=32%:%
%:%71=32%:%
%:%72=33%:%
%:%73=34%:%
%:%74=35%:%
%:%75=35%:%
%:%76=36%:%
%:%79=37%:%
%:%83=37%:%
%:%84=37%:%
%:%89=37%:%
%:%92=38%:%
%:%93=39%:%
%:%94=39%:%
%:%95=40%:%
%:%98=41%:%
%:%102=41%:%
%:%103=41%:%
%:%108=41%:%
%:%111=42%:%
%:%112=43%:%
%:%113=43%:%
%:%116=44%:%
%:%120=44%:%
%:%121=44%:%
%:%122=44%:%
%:%123=44%:%
%:%128=44%:%
%:%131=45%:%
%:%132=46%:%
%:%133=46%:%
%:%136=47%:%
%:%140=47%:%
%:%141=47%:%
%:%142=47%:%
%:%143=47%:%
%:%148=47%:%
%:%151=48%:%
%:%152=49%:%
%:%153=49%:%
%:%156=50%:%
%:%160=50%:%
%:%161=50%:%
%:%162=50%:%
%:%163=50%:%
%:%177=52%:%
%:%189=54%:%
%:%190=55%:%
%:%191=56%:%
%:%192=57%:%
%:%193=58%:%
%:%195=60%:%
%:%196=60%:%
%:%197=61%:%
%:%198=62%:%
%:%199=62%:%
%:%200=63%:%
%:%201=63%:%
%:%204=64%:%
%:%209=65%:%
%:%210=65%:%
%:%224=67%:%
%:%240=69%:%
%:%241=69%:%
%:%242=70%:%
%:%243=71%:%
%:%244=72%:%
%:%245=73%:%
%:%246=74%:%
%:%247=74%:%
%:%248=75%:%
%:%249=76%:%
%:%250=77%:%
%:%251=78%:%
%:%252=79%:%
%:%253=79%:%
%:%254=80%:%
%:%255=81%:%
%:%256=82%:%
%:%270=84%:%
%:%286=86%:%
%:%287=86%:%
%:%288=87%:%
%:%290=89%:%
%:%291=90%:%
%:%305=92%:%
%:%321=94%:%
%:%322=94%:%
%:%323=95%:%
%:%325=97%:%
%:%326=98%:%
%:%331=98%:%
%:%334=99%:%
%:%335=100%:%
%:%336=100%:%
%:%337=101%:%
%:%338=101%:%
%:%341=102%:%
%:%346=103%:%
%:%347=103%:%
%:%348=104%:%
%:%350=106%:%
%:%351=107%:%
%:%356=107%:%
%:%359=108%:%
%:%360=109%:%
%:%361=109%:%
%:%362=110%:%
%:%363=110%:%
%:%370=112%:%
%:%386=114%:%
%:%387=114%:%
%:%388=115%:%
%:%390=117%:%
%:%391=118%:%
%:%405=120%:%
%:%409=122%:%
%:%419=124%:%
%:%420=124%:%
%:%421=125%:%
%:%422=126%:%
%:%423=127%:%
%:%424=128%:%
%:%425=128%:%
%:%426=129%:%
%:%429=130%:%
%:%433=130%:%
%:%434=130%:%
%:%435=130%:%
%:%440=130%:%
%:%443=131%:%
%:%444=132%:%
%:%445=132%:%
%:%446=133%:%
%:%447=134%:%
%:%450=135%:%
%:%454=135%:%
%:%455=135%:%
%:%456=135%:%
%:%457=135%:%
%:%466=137%:%
%:%468=138%:%
%:%469=138%:%
%:%470=139%:%
%:%471=140%:%
%:%474=141%:%
%:%478=141%:%
%:%479=141%:%
%:%480=142%:%
%:%481=142%:%
%:%482=143%:%
%:%483=143%:%
%:%484=144%:%
%:%485=144%:%
%:%487=146%:%
%:%488=147%:%
%:%489=147%:%
%:%490=148%:%
%:%491=148%:%
%:%492=149%:%
%:%493=149%:%
%:%494=150%:%
%:%495=151%:%
%:%496=151%:%
%:%497=151%:%
%:%498=152%:%
%:%499=152%:%
%:%500=153%:%
%:%501=153%:%
%:%502=153%:%
%:%503=154%:%
%:%504=154%:%
%:%505=154%:%
%:%506=155%:%
%:%512=155%:%
%:%515=156%:%
%:%516=157%:%
%:%517=157%:%
%:%518=158%:%
%:%519=159%:%
%:%522=160%:%
%:%526=160%:%
%:%527=160%:%
%:%536=162%:%
%:%538=163%:%
%:%539=163%:%
%:%540=164%:%
%:%541=165%:%
%:%544=166%:%
%:%548=166%:%
%:%549=166%:%
%:%550=167%:%
%:%551=167%:%
%:%552=168%:%
%:%553=168%:%
%:%554=169%:%
%:%555=169%:%
%:%556=170%:%
%:%557=171%:%
%:%558=171%:%
%:%559=172%:%
%:%560=173%:%
%:%561=173%:%
%:%562=174%:%
%:%563=174%:%
%:%564=175%:%
%:%565=175%:%
%:%566=176%:%
%:%567=177%:%
%:%568=177%:%
%:%569=178%:%
%:%570=178%:%
%:%571=179%:%
%:%572=179%:%
%:%573=179%:%
%:%574=180%:%
%:%575=180%:%
%:%576=181%:%
%:%577=181%:%
%:%578=181%:%
%:%579=182%:%
%:%580=182%:%
%:%581=183%:%
%:%582=183%:%
%:%583=183%:%
%:%584=184%:%
%:%585=184%:%
%:%586=184%:%
%:%587=185%:%
%:%588=185%:%
%:%589=185%:%
%:%590=186%:%
%:%591=186%:%
%:%592=187%:%
%:%607=189%:%
%:%617=191%:%
%:%618=191%:%
%:%619=192%:%
%:%620=193%:%
%:%621=194%:%
%:%622=195%:%
%:%623=195%:%
%:%624=196%:%
%:%627=197%:%
%:%631=197%:%
%:%632=197%:%
%:%633=197%:%
%:%638=197%:%
%:%641=198%:%
%:%642=199%:%
%:%643=199%:%
%:%644=200%:%
%:%645=201%:%
%:%648=202%:%
%:%652=202%:%
%:%653=202%:%
%:%654=202%:%
%:%655=202%:%
%:%664=204%:%
%:%666=205%:%
%:%667=205%:%
%:%668=206%:%
%:%669=207%:%
%:%672=208%:%
%:%676=208%:%
%:%677=208%:%
%:%678=209%:%
%:%679=209%:%
%:%680=210%:%
%:%681=210%:%
%:%682=211%:%
%:%683=211%:%
%:%685=213%:%
%:%686=214%:%
%:%687=214%:%
%:%688=215%:%
%:%689=215%:%
%:%690=216%:%
%:%691=216%:%
%:%692=217%:%
%:%693=218%:%
%:%694=218%:%
%:%695=218%:%
%:%696=219%:%
%:%697=219%:%
%:%698=220%:%
%:%699=220%:%
%:%700=220%:%
%:%701=221%:%
%:%702=221%:%
%:%703=221%:%
%:%704=222%:%
%:%714=224%:%
%:%716=225%:%
%:%717=225%:%
%:%718=226%:%
%:%719=227%:%
%:%722=228%:%
%:%726=228%:%
%:%727=228%:%
%:%728=229%:%
%:%729=229%:%
%:%730=230%:%
%:%731=230%:%
%:%732=231%:%
%:%733=231%:%
%:%734=232%:%
%:%735=233%:%
%:%736=233%:%
%:%737=234%:%
%:%738=235%:%
%:%739=235%:%
%:%740=236%:%
%:%741=236%:%
%:%742=237%:%
%:%743=237%:%
%:%744=238%:%
%:%745=239%:%
%:%746=239%:%
%:%747=240%:%
%:%748=240%:%
%:%749=241%:%
%:%750=241%:%
%:%751=241%:%
%:%752=242%:%
%:%753=242%:%
%:%754=243%:%
%:%755=243%:%
%:%756=243%:%
%:%757=244%:%
%:%758=244%:%
%:%759=245%:%
%:%760=245%:%
%:%761=245%:%
%:%762=246%:%
%:%763=246%:%
%:%764=247%:%
%:%765=247%:%
%:%766=247%:%
%:%767=248%:%
%:%768=248%:%
%:%769=249%:%
%:%784=251%:%
%:%794=253%:%
%:%795=253%:%
%:%796=254%:%
%:%797=255%:%
%:%798=256%:%
%:%799=257%:%
%:%800=257%:%
%:%801=258%:%
%:%804=259%:%
%:%808=259%:%
%:%809=259%:%
%:%810=259%:%
%:%815=259%:%
%:%818=260%:%
%:%819=261%:%
%:%820=261%:%
%:%821=262%:%
%:%822=263%:%
%:%825=264%:%
%:%829=264%:%
%:%830=264%:%
%:%831=264%:%
%:%832=264%:%
%:%837=264%:%
%:%840=265%:%
%:%841=266%:%
%:%842=266%:%
%:%843=267%:%
%:%844=268%:%
%:%845=269%:%
%:%846=269%:%
%:%847=270%:%
%:%848=271%:%
%:%851=272%:%
%:%855=272%:%
%:%856=272%:%
%:%857=273%:%
%:%858=273%:%
%:%859=274%:%
%:%860=274%:%
%:%861=275%:%
%:%862=275%:%
%:%863=275%:%
%:%864=275%:%
%:%865=276%:%
%:%866=276%:%
%:%867=277%:%
%:%868=277%:%
%:%869=278%:%
%:%870=278%:%
%:%871=279%:%
%:%872=279%:%
%:%873=280%:%
%:%874=280%:%
%:%875=281%:%
%:%876=281%:%
%:%877=281%:%
%:%878=282%:%
%:%879=282%:%
%:%880=282%:%
%:%881=283%:%
%:%882=283%:%
%:%883=283%:%
%:%884=284%:%
%:%885=284%:%
%:%886=285%:%
%:%892=285%:%
%:%895=286%:%
%:%896=287%:%
%:%897=287%:%
%:%898=288%:%
%:%899=289%:%
%:%902=290%:%
%:%906=290%:%
%:%907=290%:%
%:%908=290%:%
%:%909=290%:%
%:%914=290%:%
%:%917=291%:%
%:%918=292%:%
%:%919=292%:%
%:%920=293%:%
%:%921=294%:%
%:%924=295%:%
%:%928=295%:%
%:%929=295%:%
%:%930=295%:%
%:%931=295%:%
%:%936=295%:%
%:%939=296%:%
%:%940=297%:%
%:%941=297%:%
%:%942=298%:%
%:%943=299%:%
%:%946=300%:%
%:%950=300%:%
%:%951=300%:%
%:%952=300%:%
%:%953=300%:%
%:%958=300%:%
%:%961=301%:%
%:%962=302%:%
%:%963=302%:%
%:%964=303%:%
%:%965=304%:%
%:%968=305%:%
%:%972=305%:%
%:%973=305%:%
%:%974=305%:%
%:%975=305%:%
%:%980=305%:%
%:%983=306%:%
%:%984=307%:%
%:%985=307%:%
%:%986=308%:%
%:%987=309%:%
%:%990=310%:%
%:%994=310%:%
%:%995=310%:%
%:%1000=310%:%
%:%1003=311%:%
%:%1004=312%:%
%:%1005=312%:%
%:%1006=313%:%
%:%1007=314%:%
%:%1008=315%:%
%:%1009=315%:%
%:%1012=316%:%
%:%1016=316%:%
%:%1017=316%:%
%:%1018=317%:%
%:%1019=317%:%
%:%1024=317%:%
%:%1027=318%:%
%:%1028=319%:%
%:%1029=319%:%
%:%1032=320%:%
%:%1036=320%:%
%:%1037=320%:%
%:%1038=321%:%
%:%1039=321%:%
%:%1044=321%:%
%:%1047=322%:%
%:%1048=323%:%
%:%1049=323%:%
%:%1052=324%:%
%:%1056=324%:%
%:%1057=324%:%
%:%1058=325%:%
%:%1059=325%:%
%:%1064=325%:%
%:%1067=326%:%
%:%1068=327%:%
%:%1069=327%:%
%:%1070=328%:%
%:%1073=329%:%
%:%1077=329%:%
%:%1078=329%:%
%:%1079=329%:%
%:%1084=329%:%
%:%1087=330%:%
%:%1088=331%:%
%:%1089=331%:%
%:%1090=332%:%
%:%1091=333%:%
%:%1094=334%:%
%:%1098=334%:%
%:%1099=334%:%
%:%1100=334%:%
%:%1105=334%:%
%:%1108=335%:%
%:%1109=336%:%
%:%1110=336%:%
%:%1113=337%:%
%:%1117=337%:%
%:%1118=337%:%
%:%1119=337%:%
%:%1124=337%:%
%:%1127=338%:%
%:%1128=339%:%
%:%1129=339%:%
%:%1130=340%:%
%:%1133=341%:%
%:%1137=341%:%
%:%1138=341%:%
%:%1139=342%:%
%:%1140=342%:%
%:%1141=343%:%
%:%1142=343%:%
%:%1143=344%:%
%:%1144=344%:%
%:%1145=344%:%
%:%1146=344%:%
%:%1147=345%:%
%:%1148=345%:%
%:%1149=346%:%
%:%1150=346%:%
%:%1151=347%:%
%:%1152=347%:%
%:%1153=347%:%
%:%1154=347%:%
%:%1155=348%:%
%:%1156=348%:%
%:%1157=349%:%
%:%1158=349%:%
%:%1159=350%:%
%:%1160=350%:%
%:%1161=350%:%
%:%1162=350%:%
%:%1163=351%:%
%:%1173=353%:%
%:%1175=354%:%
%:%1176=354%:%
%:%1177=355%:%
%:%1180=356%:%
%:%1184=356%:%
%:%1185=356%:%
%:%1186=357%:%
%:%1187=357%:%
%:%1188=358%:%
%:%1189=358%:%
%:%1190=359%:%
%:%1191=359%:%
%:%1192=360%:%
%:%1193=360%:%
%:%1194=361%:%
%:%1195=361%:%
%:%1196=362%:%
%:%1197=362%:%
%:%1198=363%:%
%:%1199=363%:%
%:%1200=364%:%
%:%1201=364%:%
%:%1202=365%:%
%:%1203=365%:%
%:%1204=366%:%
%:%1205=367%:%
%:%1206=367%:%
%:%1207=368%:%
%:%1208=368%:%
%:%1209=369%:%
%:%1210=369%:%
%:%1211=369%:%
%:%1212=370%:%
%:%1213=370%:%
%:%1214=371%:%
%:%1215=371%:%
%:%1216=371%:%
%:%1217=372%:%
%:%1218=372%:%
%:%1219=373%:%
%:%1220=373%:%
%:%1221=373%:%
%:%1222=374%:%
%:%1223=374%:%
%:%1224=375%:%
%:%1225=375%:%
%:%1226=375%:%
%:%1227=376%:%
%:%1228=376%:%
%:%1229=377%:%
%:%1230=377%:%
%:%1231=377%:%
%:%1232=378%:%
%:%1233=378%:%
%:%1234=379%:%
%:%1235=379%:%
%:%1236=379%:%
%:%1237=380%:%
%:%1238=380%:%
%:%1239=381%:%
%:%1240=381%:%
%:%1241=381%:%
%:%1242=381%:%
%:%1243=382%:%
%:%1244=382%:%
%:%1245=383%:%
%:%1246=383%:%
%:%1247=384%:%
%:%1248=384%:%
%:%1249=385%:%
%:%1250=385%:%
%:%1251=386%:%
%:%1252=386%:%
%:%1253=387%:%
%:%1254=387%:%
%:%1255=388%:%
%:%1256=388%:%
%:%1257=389%:%
%:%1258=389%:%
%:%1259=390%:%
%:%1260=390%:%
%:%1261=391%:%
%:%1262=392%:%
%:%1263=392%:%
%:%1264=393%:%
%:%1265=393%:%
%:%1266=394%:%
%:%1267=394%:%
%:%1268=394%:%
%:%1269=395%:%
%:%1270=395%:%
%:%1271=395%:%
%:%1272=396%:%
%:%1273=396%:%
%:%1274=396%:%
%:%1275=397%:%
%:%1276=397%:%
%:%1277=398%:%
%:%1278=398%:%
%:%1279=398%:%
%:%1280=399%:%
%:%1281=399%:%
%:%1282=400%:%
%:%1283=400%:%
%:%1284=400%:%
%:%1285=401%:%
%:%1286=401%:%
%:%1287=402%:%
%:%1288=402%:%
%:%1289=402%:%
%:%1290=403%:%
%:%1291=403%:%
%:%1292=404%:%
%:%1293=404%:%
%:%1294=404%:%
%:%1295=405%:%
%:%1296=405%:%
%:%1297=406%:%
%:%1298=406%:%
%:%1299=406%:%
%:%1300=407%:%
%:%1301=407%:%
%:%1302=408%:%
%:%1308=408%:%
%:%1311=409%:%
%:%1312=410%:%
%:%1313=410%:%
%:%1314=411%:%
%:%1315=412%:%
%:%1316=413%:%
%:%1317=414%:%
%:%1318=415%:%
%:%1325=416%:%
%:%1326=416%:%
%:%1327=417%:%
%:%1328=417%:%
%:%1329=418%:%
%:%1330=418%:%
%:%1331=418%:%
%:%1332=419%:%
%:%1333=419%:%
%:%1334=419%:%
%:%1335=420%:%
%:%1336=420%:%
%:%1337=420%:%
%:%1338=421%:%
%:%1344=421%:%
%:%1349=422%:%
%:%1354=423%:%
