%
\begin{isabellebody}%
\setisabellecontext{Product}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Product\isanewline
\ \ \isakeyword{imports}\ Cfunc\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Cartesian products of sets%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The axiomatization below corresponds to Axiom 2 (Cartesian Products) in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{axiomatization}\isamarkupfalse%
\isanewline
\ \ cart{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymtimes}\isactrlsub c{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeyword{and}\isanewline
\ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ cfunc{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymlangle}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isakeyword{where}\isanewline
\ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ Y\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ Y\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymLongrightarrow}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymLongrightarrow}\ h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ W\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasympi}\isactrlsub {\isadigit{1}}\ X\ Y\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasympi}\isactrlsub {\isadigit{0}}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ X\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}\ f\ g\ Z{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymand}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymexists}\ h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ W\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}\ h{\isadigit{2}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ W\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}triple\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymtimes}\ cfunc\ {\isasymtimes}\ cfunc\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}triple\ W{\isasympi}\ X\ Y\ {\isasymequiv}\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}fst\ W{\isasympi}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}snd\ W{\isasympi}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ W{\isasympi}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ X\ Y{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ X\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ Z\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.1.8 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prods{\isacharunderscore}{\kern0pt}isomorphic{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ W{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}triple\ {\isacharparenleft}{\kern0pt}W{\isacharcomma}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ X\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}triple\ {\isacharparenleft}{\kern0pt}W{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ X\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ f{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ W{\isacharprime}{\kern0pt}\ {\isasymand}\ isomorphism\ f\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ W{\isacharprime}{\kern0pt}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ W{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fstI\ sndI{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ g\ \isakeyword{where}\ g{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W{\isacharprime}{\kern0pt}\ {\isasymrightarrow}\ W\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ W{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fstI\ sndI{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fg{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fg{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ idW{\isacharprime}{\kern0pt}\ \isakeyword{where}\ {\isachardoublequoteopen}idW{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ W{\isacharprime}{\kern0pt}\ {\isasymrightarrow}\ W{\isacharprime}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ h{\isadigit{2}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ W{\isacharprime}{\kern0pt}\ {\isasymrightarrow}\ W{\isacharprime}{\kern0pt}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ idW{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fst{\isacharunderscore}{\kern0pt}conv\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ fg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id\ W{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ idW{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ W{\isacharprime}{\kern0pt}\ {\isasymrightarrow}\ W{\isacharprime}{\kern0pt}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}\ {\isasymlongrightarrow}\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ idW{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ idW{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}def\ fg{\isadigit{0}}\ fg{\isadigit{1}}\ g{\isacharunderscore}{\kern0pt}def\ idW{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}unique\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id\ W{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ idW{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ idW{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}unique\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ id\ W{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ gf{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ gf{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympi}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ idW\ \isakeyword{where}\ {\isachardoublequoteopen}idW\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ W\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ h{\isadigit{2}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ W\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ idW{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ W{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fst{\isacharunderscore}{\kern0pt}conv\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ gf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\ W{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ idW{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ W\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{1}}\ {\isasymlongrightarrow}\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ idW{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ idW{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ idW{\isacharunderscore}{\kern0pt}unique\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ codomain{\isacharunderscore}{\kern0pt}comp\ domain{\isacharunderscore}{\kern0pt}comp\ f{\isacharunderscore}{\kern0pt}def\ gf{\isadigit{0}}\ gf{\isadigit{1}}\ g{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\ \isakeyword{in}\ allE{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id\ W\ {\isacharequal}{\kern0pt}\ idW{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ idW{\isacharunderscore}{\kern0pt}unique\ W{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}id\ W{\isachardoublequoteclose}\ \isakeyword{in}\ allE{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ id\ W{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}def\ fg\ g{\isacharunderscore}{\kern0pt}def\ gf\ isomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}iso\ f{\isacharunderscore}{\kern0pt}def\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}f{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ W{\isacharprime}{\kern0pt}\ {\isasymand}\ isomorphism\ f\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{0}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasympi}{\isacharprime}{\kern0pt}\isactrlsub {\isadigit{1}}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasympi}\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ product{\isacharunderscore}{\kern0pt}commutes{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}A\ {\isasymtimes}\isactrlsub c\ B\ {\isasymcong}\ B\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}AB{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ A{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ A{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}BA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ A{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ A{\isasymrangle}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isasymtimes}\isactrlsub c\ B\ {\isasymcong}\ B\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}AB\ id{\isacharunderscore}{\kern0pt}BA\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ \ X\ {\isasymtimes}\isactrlsub c\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ b\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ b\ \isanewline
\ \ \ \ \ \ {\isasymand}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}full{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eqI{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ \ X\ {\isasymtimes}\isactrlsub c\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ b\ \isanewline
\ \ \ \ \ \ {\isasymand}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}c\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ \ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ \ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}d{\isasymrangle}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ c\ {\isasymand}\ b\ {\isacharequal}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ x\ y{\isachardot}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}\ {\isasymand}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}{\kern0pt}\ rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ \ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ a\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Diagonal function%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.1.9 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ diagonal\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}diagonal\ X\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}id\ X{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ diagonal{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}diagonal\ X\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ diagonal{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ diag{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
{\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}diagonal\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ X\ {\isasymcirc}\isactrlsub c\ diagonal\ X\ {\isacharequal}{\kern0pt}\ id\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ diagonal{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}diagonal\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic\ diagonal{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}isomorphism\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Products of functions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.1.10 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymtimes}\isactrlsub f{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isasymtimes}\isactrlsub f\ g\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ V{\isasymrightarrow}\ W{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymtimes}\isactrlsub f\ g\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ V{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ V{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Z\ {\isasymLongrightarrow}\ f\ {\isasymtimes}\isactrlsub f\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Z\ {\isasymLongrightarrow}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ f\ {\isasymtimes}\isactrlsub f\ g\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ W\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Z\ {\isasymLongrightarrow}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ f\ {\isasymtimes}\isactrlsub f\ g\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ W\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\ {\isasymLongrightarrow}\ g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Z\ {\isasymLongrightarrow}\ h\ {\isacharcolon}{\kern0pt}\ W\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymLongrightarrow}\isanewline
\ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ W\ X\ {\isasymLongrightarrow}\isanewline
\ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ W\ X\ {\isasymLongrightarrow}\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymtimes}\isactrlsub f\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.1.11 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ B{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ B\ {\isasymrightarrow}\ C{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\ \ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ A\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ C\ {\isasymand}\isanewline
\ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ C\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ X\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ A\ {\isasymand}\isanewline
\ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ C\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ A\ {\isasymlongrightarrow}\isanewline
\ \ \ \ h\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ X\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ left{\isacharunderscore}{\kern0pt}eq\ right{\isacharunderscore}{\kern0pt}eq\ uniqueness\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ a{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ W{\isachardoublequoteclose}\ \isakeyword{and}\ b{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ a{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ b{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymforall}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymand}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ a\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ b\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ a{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ b{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ W\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}type\ b{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ W\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}type\ b{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ a{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ b{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ uniqueness\ left{\isacharunderscore}{\kern0pt}eq\ right{\isacharunderscore}{\kern0pt}eq\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}f\ {\isasymtimes}\isactrlsub f\ g\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isachardoublequoteclose}\ \isakeyword{in}\ allE{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ meson\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ uniqueness{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ a{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ b{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a\ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ b\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}proj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ a\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}proj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ b\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a\ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ b\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ a{\isacharunderscore}{\kern0pt}type\ b{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ f{\isacharunderscore}{\kern0pt}type\ same{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}proj\ same{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}proj{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Exercise 2.1.12 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Exercise 2.1.14 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}diagonal{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ diagonal{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ diagonal{\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ diagonal{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ X{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\isactrlsub c\ Y\ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ Y\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ Y{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ id{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}id\isactrlsub c\ X{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}id\isactrlsub c\ Y{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ B\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ W{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}a\ {\isasymtimes}\isactrlsub f\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ a{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isacharcomma}{\kern0pt}\ b\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}\isanewline
\ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isasymlangle}x\ {\isasymcirc}\isactrlsub c\ a\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isacharcomma}{\kern0pt}\ y\ {\isasymcirc}\isactrlsub c\ b\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ a\ {\isasymtimes}\isactrlsub f\ b\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ a{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ y\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ type{\isacharunderscore}{\kern0pt}assms{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ W{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}monomorphism\ f{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}monomorphism\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monomorphism\ {\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ unfold\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ A\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ x{\isadigit{1}}\ x{\isadigit{2}}\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}expand{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}x{\isadigit{2}}{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}x{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ y{\isadigit{1}}\ y{\isadigit{2}}\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}expand{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isasymlangle}y{\isadigit{1}}{\isacharcomma}{\kern0pt}\ y{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\ \isakeyword{and}\ y{\isadigit{1}}{\isacharunderscore}{\kern0pt}y{\isadigit{2}}{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y{\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ y{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isadigit{1}}{\isacharcomma}{\kern0pt}\ y{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}expand\ y{\isacharunderscore}{\kern0pt}expand\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ x{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ y{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ y{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ type{\isacharunderscore}{\kern0pt}assms\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}x{\isadigit{2}}{\isacharunderscore}{\kern0pt}type\ y{\isadigit{1}}{\isacharunderscore}{\kern0pt}y{\isadigit{2}}{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ y{\isadigit{1}}\ {\isasymand}\ g\ {\isasymcirc}\isactrlsub c\ x{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ y{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}type\ type{\isacharunderscore}{\kern0pt}assms\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}x{\isadigit{2}}{\isacharunderscore}{\kern0pt}type\ y{\isadigit{1}}{\isacharunderscore}{\kern0pt}y{\isadigit{2}}{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ y{\isadigit{1}}\ {\isasymand}\ x{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ y{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}mono\ g{\isacharunderscore}{\kern0pt}mono\ monomorphism{\isacharunderscore}{\kern0pt}def\ type{\isacharunderscore}{\kern0pt}assms\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}x{\isadigit{2}}{\isacharunderscore}{\kern0pt}type\ y{\isadigit{1}}{\isacharunderscore}{\kern0pt}y{\isadigit{2}}{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}y{\isadigit{1}}{\isacharcomma}{\kern0pt}\ y{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}expand\ y{\isacharunderscore}{\kern0pt}expand{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Useful Cartesian product permuting functions%
}
\isamarkuptrue%
%
\isamarkupsubsubsection{Swapping a Cartesian product%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ swap\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}swap\ X\ Y\ {\isacharequal}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}swap\ X\ Y\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ Y\ {\isasymrightarrow}\ Y\ {\isasymtimes}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}swap\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}swap\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharcomma}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ B\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}swap\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y\ {\isasymtimes}\isactrlsub f\ x{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ swap\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}swap\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ swap\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isacharcomma}{\kern0pt}\ y\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}y\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isacharcomma}{\kern0pt}\ x\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y\ {\isasymtimes}\isactrlsub f\ x{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y\ {\isasymtimes}\isactrlsub f\ x{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ swap\ A\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}idempotent{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}swap\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ Y\ {\isacharequal}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ swap{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}swap\ X\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ isomorphism{\isacharunderscore}{\kern0pt}def\ swap{\isacharunderscore}{\kern0pt}idempotent\ swap{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Permuting a Cartesian product to associate to the right%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isasymlangle}\isanewline
\ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlangle}\isanewline
\ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z\isanewline
\ \ \ \ \ \ {\isasymrangle}\isanewline
\ \ \ \ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ calculation\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ B\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ C\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ associate{\isacharunderscore}{\kern0pt}right\ A\ B\ C{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isacharcomma}{\kern0pt}\ y\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}\ z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ C{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ unfold\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}\ y\ \ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isasymrangle}{\isacharcomma}{\kern0pt}\ z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ C{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}\ {\isasymlangle}y\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}\ z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ C{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y\ {\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ C{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}{\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A{\isasymtimes}\isactrlsub cB{\isacharparenright}{\kern0pt}\ C{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ C{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ associate{\isacharunderscore}{\kern0pt}right\ A\ B\ C{\isachardoublequoteclose}\ \ \ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Permuting a Cartesian product to associate to the left%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}left\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isasymlangle}\isanewline
\ \ \ \ \ \ {\isasymlangle}\isanewline
\ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}\ \ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ comp{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}right\ A\ B\ C\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ A\ B\ C\ {\isacharequal}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ comp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\ \isanewline
\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}left\ A\ B\ C\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ A\ B\ C\ {\isacharequal}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ comp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ product{\isacharunderscore}{\kern0pt}associates{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}A\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ \ {\isasymcong}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ C{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}type\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ left{\isacharunderscore}{\kern0pt}right\ right{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ B\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ C\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ associate{\isacharunderscore}{\kern0pt}left\ A\ B\ C{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isasymlangle}y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C{\isacharcomma}{\kern0pt}\ z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ unfold\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isasymlangle}y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}x\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ {\isasymlangle}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ B\ C\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub cC{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ z{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ A\ B\ C{\isachardoublequoteclose}\ \ \ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Distributing over a Cartesian product from the right%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ Z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ Y\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\ \ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\ {\isasymlangle}distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z{\isacharcomma}{\kern0pt}\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}type\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ z{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\ \ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}monomorphism\ {\isacharparenleft}{\kern0pt}distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ unfold\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\ h\ A\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ g{\isadigit{1}}\ g{\isadigit{2}}\ g{\isadigit{3}}\ \isakeyword{where}\ g{\isacharunderscore}{\kern0pt}expand{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isadigit{3}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ h{\isadigit{1}}\ h{\isadigit{2}}\ h{\isadigit{3}}\ \isakeyword{where}\ h{\isacharunderscore}{\kern0pt}expand{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h{\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}h{\isadigit{3}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ distribute{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}expand\ h{\isacharunderscore}{\kern0pt}expand\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}g{\isadigit{2}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}h{\isadigit{2}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}\ {\isasymand}\ {\isasymlangle}g{\isadigit{2}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}h{\isadigit{2}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ h{\isadigit{1}}\ {\isasymand}\ g{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isadigit{2}}\ {\isasymand}\ g{\isadigit{3}}\ {\isacharequal}{\kern0pt}\ h{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ g{\isacharunderscore}{\kern0pt}expand\ h{\isacharunderscore}{\kern0pt}expand{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Distributing over a Cartesian product from the left%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ \ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ Z\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}def\ \ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharequal}{\kern0pt}\ {\isasymlangle}distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z{\isacharcomma}{\kern0pt}\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right\ X\ Y\ Z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}type\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isasymlangle}y{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}x{\isacharcomma}{\kern0pt}\ y{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ z{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}monomorphism\ {\isacharparenleft}{\kern0pt}distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ unfold\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\ h\ A\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ g{\isadigit{1}}\ g{\isadigit{2}}\ g{\isadigit{3}}\ \isakeyword{where}\ g{\isacharunderscore}{\kern0pt}expand{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymlangle}g{\isadigit{2}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isadigit{3}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ Z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ h{\isadigit{1}}\ h{\isadigit{2}}\ h{\isadigit{3}}\ \isakeyword{where}\ h{\isacharunderscore}{\kern0pt}expand{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymlangle}h{\isadigit{2}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h{\isadigit{1}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}h{\isadigit{3}}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymlangle}g{\isadigit{2}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ distribute{\isacharunderscore}{\kern0pt}left\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymlangle}h{\isadigit{2}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}expand\ h{\isacharunderscore}{\kern0pt}expand\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{2}}{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ distribute{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{2}}{\isasymrangle}\ {\isasymand}\ {\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ h{\isadigit{1}}\ {\isasymand}\ g{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isadigit{2}}\ {\isasymand}\ g{\isadigit{3}}\ {\isacharequal}{\kern0pt}\ h{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}g{\isadigit{2}}{\isacharunderscore}{\kern0pt}g{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ h{\isadigit{1}}{\isacharunderscore}{\kern0pt}h{\isadigit{2}}{\isacharunderscore}{\kern0pt}h{\isadigit{3}}{\isacharunderscore}{\kern0pt}types\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}g{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymlangle}g{\isadigit{2}}{\isacharcomma}{\kern0pt}\ g{\isadigit{3}}{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}h{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymlangle}h{\isadigit{2}}{\isacharcomma}{\kern0pt}\ h{\isadigit{3}}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ g{\isacharunderscore}{\kern0pt}expand\ h{\isacharunderscore}{\kern0pt}expand{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Selecting pairs from a pair of pairs%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ outers\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}outers\ A\ B\ C\ D\ {\isacharequal}{\kern0pt}\ {\isasymlangle}\isanewline
\ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ outers{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}outers\ A\ B\ C\ D\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ outers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ outers{\isacharunderscore}{\kern0pt}apply{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}c\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ C{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}outers\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}outers\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}\isanewline
\ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}\isanewline
\ \ \ \ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ outers{\isacharunderscore}{\kern0pt}def\ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}c{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ inners\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}inners\ A\ B\ C\ D\ {\isacharequal}{\kern0pt}\ {\isasymlangle}\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inners{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inners\ A\ B\ C\ D\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ inners{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ inners{\isacharunderscore}{\kern0pt}apply{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}c\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ C{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}inners\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}b{\isacharcomma}{\kern0pt}c{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inners\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ inners{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}c{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}b{\isacharcomma}{\kern0pt}\ c{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ lefts\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}lefts\ A\ B\ C\ D\ {\isacharequal}{\kern0pt}\ {\isasymlangle}\isanewline
\ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lefts{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}lefts\ A\ B\ C\ D\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ lefts{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lefts{\isacharunderscore}{\kern0pt}apply{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}c\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ C{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}lefts\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isacharcomma}{\kern0pt}c{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}lefts\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ lefts{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}c{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ c{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ rights\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}rights\ A\ B\ C\ D\ {\isacharequal}{\kern0pt}\ {\isasymlangle}\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rights{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rights\ A\ B\ C\ D\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ rights{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rights{\isacharunderscore}{\kern0pt}apply{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}c\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ C{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}rights\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}b{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}rights\ A\ B\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ B{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ D{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ {\isasymlangle}c{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ rights{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}b{\isasymrangle}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ C\ D\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}c{\isacharcomma}{\kern0pt}d{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}b{\isacharcomma}{\kern0pt}\ d{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/ETCS/HOL-ETCS/Product.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%27=5%:%
%:%39=7%:%
%:%41=8%:%
%:%42=8%:%
%:%43=9%:%
%:%44=10%:%
%:%45=11%:%
%:%46=12%:%
%:%47=13%:%
%:%48=14%:%
%:%49=15%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=19%:%
%:%54=20%:%
%:%55=21%:%
%:%56=22%:%
%:%57=22%:%
%:%58=23%:%
%:%62=27%:%
%:%63=28%:%
%:%64=29%:%
%:%65=29%:%
%:%66=30%:%
%:%67=31%:%
%:%68=32%:%
%:%69=32%:%
%:%70=33%:%
%:%73=34%:%
%:%77=34%:%
%:%78=34%:%
%:%79=35%:%
%:%80=35%:%
%:%81=36%:%
%:%82=36%:%
%:%83=37%:%
%:%84=37%:%
%:%85=38%:%
%:%86=38%:%
%:%87=39%:%
%:%88=39%:%
%:%93=44%:%
%:%94=45%:%
%:%95=45%:%
%:%96=46%:%
%:%97=46%:%
%:%98=47%:%
%:%108=49%:%
%:%110=50%:%
%:%111=50%:%
%:%112=51%:%
%:%113=52%:%
%:%114=53%:%
%:%121=54%:%
%:%122=54%:%
%:%123=55%:%
%:%124=55%:%
%:%125=56%:%
%:%126=56%:%
%:%127=56%:%
%:%128=56%:%
%:%129=57%:%
%:%130=58%:%
%:%131=58%:%
%:%132=59%:%
%:%133=59%:%
%:%134=59%:%
%:%135=59%:%
%:%136=60%:%
%:%137=61%:%
%:%138=61%:%
%:%139=62%:%
%:%140=62%:%
%:%141=62%:%
%:%142=63%:%
%:%143=63%:%
%:%144=64%:%
%:%145=64%:%
%:%146=64%:%
%:%147=65%:%
%:%148=66%:%
%:%149=66%:%
%:%150=67%:%
%:%151=67%:%
%:%152=67%:%
%:%153=67%:%
%:%154=68%:%
%:%155=68%:%
%:%156=68%:%
%:%157=69%:%
%:%158=69%:%
%:%159=70%:%
%:%160=70%:%
%:%161=71%:%
%:%162=71%:%
%:%163=72%:%
%:%164=72%:%
%:%165=72%:%
%:%166=73%:%
%:%167=73%:%
%:%168=74%:%
%:%169=74%:%
%:%170=74%:%
%:%171=75%:%
%:%172=75%:%
%:%173=75%:%
%:%174=76%:%
%:%175=76%:%
%:%176=77%:%
%:%177=77%:%
%:%178=78%:%
%:%179=79%:%
%:%180=79%:%
%:%181=80%:%
%:%182=80%:%
%:%183=80%:%
%:%184=81%:%
%:%185=81%:%
%:%186=82%:%
%:%187=82%:%
%:%188=82%:%
%:%189=83%:%
%:%190=84%:%
%:%191=84%:%
%:%192=85%:%
%:%193=85%:%
%:%194=85%:%
%:%195=85%:%
%:%196=86%:%
%:%197=86%:%
%:%198=86%:%
%:%199=87%:%
%:%200=87%:%
%:%201=88%:%
%:%202=88%:%
%:%203=89%:%
%:%204=89%:%
%:%205=90%:%
%:%206=90%:%
%:%207=90%:%
%:%208=91%:%
%:%209=91%:%
%:%210=92%:%
%:%211=92%:%
%:%212=92%:%
%:%213=93%:%
%:%214=93%:%
%:%215=93%:%
%:%216=94%:%
%:%217=94%:%
%:%218=95%:%
%:%219=95%:%
%:%220=96%:%
%:%221=97%:%
%:%222=97%:%
%:%223=98%:%
%:%224=98%:%
%:%225=98%:%
%:%226=99%:%
%:%227=99%:%
%:%228=99%:%
%:%229=100%:%
%:%230=100%:%
%:%231=101%:%
%:%237=101%:%
%:%240=102%:%
%:%241=103%:%
%:%242=103%:%
%:%243=104%:%
%:%250=105%:%
%:%251=105%:%
%:%252=106%:%
%:%253=106%:%
%:%254=107%:%
%:%255=107%:%
%:%256=108%:%
%:%257=108%:%
%:%258=109%:%
%:%259=109%:%
%:%260=110%:%
%:%261=110%:%
%:%262=111%:%
%:%263=111%:%
%:%264=112%:%
%:%270=112%:%
%:%273=113%:%
%:%274=114%:%
%:%275=114%:%
%:%276=115%:%
%:%277=116%:%
%:%279=118%:%
%:%282=119%:%
%:%286=119%:%
%:%287=119%:%
%:%292=119%:%
%:%295=120%:%
%:%296=121%:%
%:%297=121%:%
%:%298=122%:%
%:%299=123%:%
%:%300=124%:%
%:%301=125%:%
%:%304=126%:%
%:%308=126%:%
%:%309=126%:%
%:%310=126%:%
%:%315=126%:%
%:%318=127%:%
%:%319=128%:%
%:%320=128%:%
%:%321=129%:%
%:%322=130%:%
%:%325=131%:%
%:%329=131%:%
%:%330=131%:%
%:%335=131%:%
%:%338=132%:%
%:%339=133%:%
%:%340=133%:%
%:%341=134%:%
%:%342=135%:%
%:%349=136%:%
%:%350=136%:%
%:%351=137%:%
%:%352=137%:%
%:%353=138%:%
%:%354=138%:%
%:%355=138%:%
%:%356=139%:%
%:%357=139%:%
%:%358=140%:%
%:%359=140%:%
%:%360=140%:%
%:%361=141%:%
%:%362=141%:%
%:%363=142%:%
%:%364=142%:%
%:%365=142%:%
%:%366=143%:%
%:%381=145%:%
%:%393=147%:%
%:%395=148%:%
%:%396=148%:%
%:%397=149%:%
%:%398=150%:%
%:%399=151%:%
%:%400=151%:%
%:%401=152%:%
%:%404=153%:%
%:%408=153%:%
%:%409=153%:%
%:%410=153%:%
%:%415=153%:%
%:%418=154%:%
%:%419=155%:%
%:%420=155%:%
%:%421=156%:%
%:%428=157%:%
%:%429=157%:%
%:%430=158%:%
%:%431=158%:%
%:%432=159%:%
%:%433=159%:%
%:%434=160%:%
%:%435=160%:%
%:%436=160%:%
%:%437=161%:%
%:%438=161%:%
%:%439=162%:%
%:%454=164%:%
%:%466=166%:%
%:%468=167%:%
%:%469=167%:%
%:%470=168%:%
%:%471=169%:%
%:%472=170%:%
%:%473=170%:%
%:%474=171%:%
%:%475=172%:%
%:%478=173%:%
%:%482=173%:%
%:%483=173%:%
%:%484=173%:%
%:%489=173%:%
%:%492=174%:%
%:%493=175%:%
%:%494=175%:%
%:%495=176%:%
%:%498=177%:%
%:%502=177%:%
%:%503=177%:%
%:%504=178%:%
%:%505=178%:%
%:%506=178%:%
%:%511=178%:%
%:%514=179%:%
%:%515=180%:%
%:%516=180%:%
%:%517=181%:%
%:%520=182%:%
%:%524=182%:%
%:%525=182%:%
%:%526=183%:%
%:%527=183%:%
%:%528=183%:%
%:%533=183%:%
%:%536=184%:%
%:%537=185%:%
%:%538=185%:%
%:%539=186%:%
%:%542=187%:%
%:%546=187%:%
%:%547=187%:%
%:%548=188%:%
%:%549=188%:%
%:%550=188%:%
%:%555=188%:%
%:%558=189%:%
%:%559=190%:%
%:%560=190%:%
%:%562=192%:%
%:%565=193%:%
%:%569=193%:%
%:%570=193%:%
%:%571=194%:%
%:%572=194%:%
%:%573=194%:%
%:%582=196%:%
%:%584=197%:%
%:%585=197%:%
%:%586=198%:%
%:%587=199%:%
%:%594=200%:%
%:%595=200%:%
%:%596=201%:%
%:%597=201%:%
%:%598=202%:%
%:%599=202%:%
%:%602=205%:%
%:%603=206%:%
%:%604=206%:%
%:%605=207%:%
%:%606=208%:%
%:%607=208%:%
%:%608=209%:%
%:%609=209%:%
%:%610=209%:%
%:%611=210%:%
%:%612=210%:%
%:%613=211%:%
%:%614=211%:%
%:%615=211%:%
%:%616=212%:%
%:%617=212%:%
%:%618=213%:%
%:%619=213%:%
%:%620=213%:%
%:%621=214%:%
%:%627=214%:%
%:%630=215%:%
%:%631=216%:%
%:%632=216%:%
%:%633=217%:%
%:%634=218%:%
%:%635=219%:%
%:%642=220%:%
%:%643=220%:%
%:%644=221%:%
%:%645=221%:%
%:%646=221%:%
%:%647=222%:%
%:%648=223%:%
%:%649=224%:%
%:%650=224%:%
%:%651=224%:%
%:%652=225%:%
%:%653=226%:%
%:%654=226%:%
%:%655=227%:%
%:%656=227%:%
%:%657=227%:%
%:%658=228%:%
%:%659=228%:%
%:%660=228%:%
%:%661=229%:%
%:%662=229%:%
%:%663=229%:%
%:%664=230%:%
%:%665=231%:%
%:%666=231%:%
%:%667=232%:%
%:%668=232%:%
%:%669=232%:%
%:%670=233%:%
%:%671=233%:%
%:%672=233%:%
%:%673=234%:%
%:%674=234%:%
%:%675=234%:%
%:%676=235%:%
%:%677=236%:%
%:%678=236%:%
%:%679=237%:%
%:%680=237%:%
%:%681=237%:%
%:%682=238%:%
%:%683=239%:%
%:%689=239%:%
%:%692=240%:%
%:%693=241%:%
%:%694=241%:%
%:%695=242%:%
%:%696=243%:%
%:%697=244%:%
%:%704=245%:%
%:%705=245%:%
%:%706=246%:%
%:%707=246%:%
%:%708=247%:%
%:%709=247%:%
%:%710=247%:%
%:%711=248%:%
%:%712=248%:%
%:%713=249%:%
%:%714=249%:%
%:%715=249%:%
%:%716=250%:%
%:%717=250%:%
%:%718=251%:%
%:%719=251%:%
%:%720=252%:%
%:%730=254%:%
%:%732=255%:%
%:%733=255%:%
%:%736=256%:%
%:%740=256%:%
%:%741=256%:%
%:%750=258%:%
%:%752=259%:%
%:%753=259%:%
%:%754=260%:%
%:%755=261%:%
%:%758=262%:%
%:%762=262%:%
%:%763=262%:%
%:%764=263%:%
%:%765=263%:%
%:%766=264%:%
%:%767=264%:%
%:%768=265%:%
%:%769=265%:%
%:%770=265%:%
%:%771=266%:%
%:%772=266%:%
%:%773=266%:%
%:%774=267%:%
%:%775=267%:%
%:%776=267%:%
%:%777=268%:%
%:%778=268%:%
%:%779=268%:%
%:%780=269%:%
%:%781=269%:%
%:%782=269%:%
%:%783=270%:%
%:%784=270%:%
%:%785=270%:%
%:%786=271%:%
%:%787=271%:%
%:%788=271%:%
%:%789=272%:%
%:%790=272%:%
%:%791=272%:%
%:%792=273%:%
%:%793=273%:%
%:%794=273%:%
%:%795=274%:%
%:%801=274%:%
%:%804=275%:%
%:%805=276%:%
%:%806=276%:%
%:%807=277%:%
%:%808=278%:%
%:%815=279%:%
%:%816=279%:%
%:%817=280%:%
%:%818=280%:%
%:%819=281%:%
%:%820=282%:%
%:%821=282%:%
%:%822=283%:%
%:%823=283%:%
%:%824=283%:%
%:%825=284%:%
%:%826=284%:%
%:%827=285%:%
%:%833=285%:%
%:%836=286%:%
%:%837=287%:%
%:%838=287%:%
%:%839=288%:%
%:%840=289%:%
%:%841=290%:%
%:%844=291%:%
%:%848=291%:%
%:%849=291%:%
%:%850=292%:%
%:%851=292%:%
%:%852=293%:%
%:%853=293%:%
%:%854=294%:%
%:%855=294%:%
%:%856=295%:%
%:%857=295%:%
%:%858=296%:%
%:%859=297%:%
%:%860=297%:%
%:%861=298%:%
%:%862=298%:%
%:%863=298%:%
%:%864=299%:%
%:%865=299%:%
%:%866=300%:%
%:%867=300%:%
%:%868=300%:%
%:%869=301%:%
%:%870=302%:%
%:%871=302%:%
%:%872=303%:%
%:%873=303%:%
%:%874=303%:%
%:%875=304%:%
%:%876=304%:%
%:%877=304%:%
%:%878=305%:%
%:%879=305%:%
%:%880=305%:%
%:%881=306%:%
%:%882=306%:%
%:%883=306%:%
%:%884=307%:%
%:%885=307%:%
%:%886=307%:%
%:%887=308%:%
%:%888=308%:%
%:%889=309%:%
%:%890=309%:%
%:%891=309%:%
%:%892=310%:%
%:%893=310%:%
%:%894=310%:%
%:%895=311%:%
%:%896=311%:%
%:%897=311%:%
%:%898=312%:%
%:%899=312%:%
%:%900=313%:%
%:%901=313%:%
%:%902=313%:%
%:%903=314%:%
%:%904=314%:%
%:%905=315%:%
%:%920=317%:%
%:%924=319%:%
%:%934=321%:%
%:%935=321%:%
%:%936=322%:%
%:%937=323%:%
%:%938=324%:%
%:%939=324%:%
%:%942=325%:%
%:%946=325%:%
%:%947=325%:%
%:%948=325%:%
%:%953=325%:%
%:%956=326%:%
%:%957=327%:%
%:%958=327%:%
%:%959=328%:%
%:%960=329%:%
%:%967=330%:%
%:%968=330%:%
%:%969=331%:%
%:%970=331%:%
%:%971=332%:%
%:%972=332%:%
%:%973=332%:%
%:%974=333%:%
%:%975=333%:%
%:%976=333%:%
%:%977=334%:%
%:%978=334%:%
%:%979=335%:%
%:%980=335%:%
%:%981=335%:%
%:%982=336%:%
%:%983=336%:%
%:%984=336%:%
%:%985=337%:%
%:%986=337%:%
%:%987=337%:%
%:%988=338%:%
%:%989=338%:%
%:%990=338%:%
%:%991=339%:%
%:%997=339%:%
%:%1000=340%:%
%:%1001=341%:%
%:%1002=341%:%
%:%1003=342%:%
%:%1004=343%:%
%:%1011=344%:%
%:%1012=344%:%
%:%1013=345%:%
%:%1014=345%:%
%:%1015=346%:%
%:%1016=346%:%
%:%1017=346%:%
%:%1018=346%:%
%:%1019=347%:%
%:%1020=347%:%
%:%1021=347%:%
%:%1022=348%:%
%:%1023=348%:%
%:%1024=349%:%
%:%1025=349%:%
%:%1026=349%:%
%:%1027=350%:%
%:%1028=350%:%
%:%1029=350%:%
%:%1030=351%:%
%:%1031=351%:%
%:%1032=351%:%
%:%1033=352%:%
%:%1034=352%:%
%:%1035=352%:%
%:%1036=353%:%
%:%1037=353%:%
%:%1038=353%:%
%:%1039=354%:%
%:%1040=354%:%
%:%1041=354%:%
%:%1042=355%:%
%:%1048=355%:%
%:%1051=356%:%
%:%1052=357%:%
%:%1053=357%:%
%:%1054=358%:%
%:%1057=359%:%
%:%1061=359%:%
%:%1062=359%:%
%:%1063=360%:%
%:%1068=360%:%
%:%1071=361%:%
%:%1072=362%:%
%:%1073=362%:%
%:%1074=363%:%
%:%1077=364%:%
%:%1081=364%:%
%:%1082=364%:%
%:%1096=366%:%
%:%1106=368%:%
%:%1107=368%:%
%:%1108=369%:%
%:%1115=376%:%
%:%1116=377%:%
%:%1117=378%:%
%:%1118=378%:%
%:%1121=379%:%
%:%1125=379%:%
%:%1126=379%:%
%:%1127=379%:%
%:%1132=379%:%
%:%1135=380%:%
%:%1136=381%:%
%:%1137=381%:%
%:%1138=382%:%
%:%1139=383%:%
%:%1146=384%:%
%:%1147=384%:%
%:%1148=385%:%
%:%1149=385%:%
%:%1150=386%:%
%:%1151=386%:%
%:%1152=387%:%
%:%1153=387%:%
%:%1154=387%:%
%:%1155=388%:%
%:%1156=388%:%
%:%1157=389%:%
%:%1158=389%:%
%:%1159=389%:%
%:%1160=390%:%
%:%1161=390%:%
%:%1162=390%:%
%:%1163=391%:%
%:%1164=391%:%
%:%1165=391%:%
%:%1166=392%:%
%:%1167=392%:%
%:%1168=392%:%
%:%1169=393%:%
%:%1170=393%:%
%:%1171=393%:%
%:%1172=394%:%
%:%1173=394%:%
%:%1174=394%:%
%:%1175=395%:%
%:%1181=395%:%
%:%1184=396%:%
%:%1185=397%:%
%:%1186=397%:%
%:%1187=398%:%
%:%1188=399%:%
%:%1195=400%:%
%:%1196=400%:%
%:%1197=401%:%
%:%1198=401%:%
%:%1199=402%:%
%:%1200=403%:%
%:%1201=403%:%
%:%1202=403%:%
%:%1203=404%:%
%:%1204=404%:%
%:%1205=404%:%
%:%1206=405%:%
%:%1207=405%:%
%:%1208=405%:%
%:%1209=406%:%
%:%1210=406%:%
%:%1211=406%:%
%:%1212=407%:%
%:%1213=407%:%
%:%1214=407%:%
%:%1215=408%:%
%:%1216=408%:%
%:%1217=408%:%
%:%1218=409%:%
%:%1219=409%:%
%:%1220=409%:%
%:%1221=410%:%
%:%1222=410%:%
%:%1223=410%:%
%:%1224=411%:%
%:%1225=411%:%
%:%1226=411%:%
%:%1227=412%:%
%:%1228=412%:%
%:%1229=412%:%
%:%1230=413%:%
%:%1231=413%:%
%:%1232=413%:%
%:%1233=414%:%
%:%1234=414%:%
%:%1235=414%:%
%:%1236=414%:%
%:%1237=414%:%
%:%1238=415%:%
%:%1253=417%:%
%:%1263=419%:%
%:%1264=419%:%
%:%1265=420%:%
%:%1272=427%:%
%:%1273=428%:%
%:%1274=429%:%
%:%1275=429%:%
%:%1278=430%:%
%:%1282=430%:%
%:%1283=430%:%
%:%1284=431%:%
%:%1285=431%:%
%:%1290=431%:%
%:%1293=432%:%
%:%1294=433%:%
%:%1295=433%:%
%:%1296=434%:%
%:%1297=435%:%
%:%1304=436%:%
%:%1305=436%:%
%:%1306=437%:%
%:%1307=437%:%
%:%1309=439%:%
%:%1310=440%:%
%:%1311=440%:%
%:%1312=440%:%
%:%1313=441%:%
%:%1314=441%:%
%:%1315=441%:%
%:%1317=443%:%
%:%1318=444%:%
%:%1319=444%:%
%:%1320=444%:%
%:%1321=445%:%
%:%1322=445%:%
%:%1323=445%:%
%:%1324=446%:%
%:%1325=446%:%
%:%1326=446%:%
%:%1327=447%:%
%:%1328=447%:%
%:%1329=447%:%
%:%1330=448%:%
%:%1331=448%:%
%:%1332=448%:%
%:%1333=449%:%
%:%1334=449%:%
%:%1335=449%:%
%:%1336=450%:%
%:%1337=450%:%
%:%1338=450%:%
%:%1339=451%:%
%:%1345=451%:%
%:%1348=452%:%
%:%1349=453%:%
%:%1350=453%:%
%:%1351=454%:%
%:%1354=455%:%
%:%1358=455%:%
%:%1359=455%:%
%:%1364=455%:%
%:%1367=456%:%
%:%1368=457%:%
%:%1369=457%:%
%:%1370=458%:%
%:%1373=459%:%
%:%1377=459%:%
%:%1378=459%:%
%:%1383=459%:%
%:%1386=460%:%
%:%1387=461%:%
%:%1388=461%:%
%:%1389=462%:%
%:%1392=463%:%
%:%1396=463%:%
%:%1397=463%:%
%:%1402=463%:%
%:%1405=464%:%
%:%1406=465%:%
%:%1407=465%:%
%:%1408=466%:%
%:%1409=467%:%
%:%1416=468%:%
%:%1417=468%:%
%:%1418=469%:%
%:%1419=469%:%
%:%1420=470%:%
%:%1421=471%:%
%:%1422=471%:%
%:%1423=471%:%
%:%1424=472%:%
%:%1425=472%:%
%:%1426=472%:%
%:%1427=473%:%
%:%1428=473%:%
%:%1429=473%:%
%:%1430=474%:%
%:%1431=474%:%
%:%1432=474%:%
%:%1433=475%:%
%:%1434=475%:%
%:%1435=475%:%
%:%1436=476%:%
%:%1437=476%:%
%:%1438=476%:%
%:%1439=477%:%
%:%1440=477%:%
%:%1441=477%:%
%:%1442=478%:%
%:%1443=478%:%
%:%1444=478%:%
%:%1445=479%:%
%:%1446=479%:%
%:%1447=479%:%
%:%1448=480%:%
%:%1449=480%:%
%:%1450=480%:%
%:%1451=481%:%
%:%1452=481%:%
%:%1453=481%:%
%:%1454=482%:%
%:%1455=482%:%
%:%1456=482%:%
%:%1457=482%:%
%:%1458=482%:%
%:%1459=483%:%
%:%1474=485%:%
%:%1484=487%:%
%:%1485=487%:%
%:%1486=488%:%
%:%1487=489%:%
%:%1488=490%:%
%:%1489=491%:%
%:%1490=491%:%
%:%1491=492%:%
%:%1494=493%:%
%:%1498=493%:%
%:%1499=493%:%
%:%1500=494%:%
%:%1501=494%:%
%:%1502=494%:%
%:%1507=494%:%
%:%1510=495%:%
%:%1511=496%:%
%:%1512=496%:%
%:%1513=497%:%
%:%1514=498%:%
%:%1517=499%:%
%:%1521=499%:%
%:%1522=499%:%
%:%1523=500%:%
%:%1524=500%:%
%:%1529=500%:%
%:%1532=501%:%
%:%1533=502%:%
%:%1534=502%:%
%:%1535=503%:%
%:%1536=504%:%
%:%1537=505%:%
%:%1538=506%:%
%:%1539=506%:%
%:%1540=507%:%
%:%1543=508%:%
%:%1547=508%:%
%:%1548=508%:%
%:%1549=509%:%
%:%1550=509%:%
%:%1551=509%:%
%:%1556=509%:%
%:%1559=510%:%
%:%1560=511%:%
%:%1561=511%:%
%:%1562=512%:%
%:%1563=513%:%
%:%1566=514%:%
%:%1570=514%:%
%:%1571=514%:%
%:%1572=515%:%
%:%1573=515%:%
%:%1578=515%:%
%:%1581=516%:%
%:%1582=517%:%
%:%1583=517%:%
%:%1584=518%:%
%:%1585=519%:%
%:%1586=520%:%
%:%1587=520%:%
%:%1588=521%:%
%:%1591=522%:%
%:%1595=522%:%
%:%1596=522%:%
%:%1597=523%:%
%:%1598=523%:%
%:%1603=523%:%
%:%1606=524%:%
%:%1607=525%:%
%:%1608=525%:%
%:%1609=526%:%
%:%1610=527%:%
%:%1613=528%:%
%:%1617=528%:%
%:%1618=528%:%
%:%1619=528%:%
%:%1620=529%:%
%:%1621=529%:%
%:%1626=529%:%
%:%1629=530%:%
%:%1630=531%:%
%:%1631=531%:%
%:%1632=532%:%
%:%1639=533%:%
%:%1640=533%:%
%:%1641=534%:%
%:%1642=534%:%
%:%1643=535%:%
%:%1644=535%:%
%:%1645=536%:%
%:%1646=536%:%
%:%1647=536%:%
%:%1648=537%:%
%:%1649=538%:%
%:%1650=538%:%
%:%1651=538%:%
%:%1652=539%:%
%:%1653=539%:%
%:%1654=540%:%
%:%1655=540%:%
%:%1656=540%:%
%:%1657=541%:%
%:%1658=542%:%
%:%1659=542%:%
%:%1660=542%:%
%:%1661=543%:%
%:%1662=544%:%
%:%1663=544%:%
%:%1664=545%:%
%:%1665=545%:%
%:%1666=545%:%
%:%1667=546%:%
%:%1668=546%:%
%:%1669=546%:%
%:%1670=547%:%
%:%1671=547%:%
%:%1672=547%:%
%:%1673=548%:%
%:%1674=548%:%
%:%1675=548%:%
%:%1676=549%:%
%:%1677=549%:%
%:%1678=549%:%
%:%1679=550%:%
%:%1680=550%:%
%:%1681=550%:%
%:%1682=551%:%
%:%1683=551%:%
%:%1684=551%:%
%:%1685=552%:%
%:%1686=552%:%
%:%1687=552%:%
%:%1688=553%:%
%:%1689=553%:%
%:%1690=553%:%
%:%1691=554%:%
%:%1692=554%:%
%:%1693=555%:%
%:%1694=555%:%
%:%1695=555%:%
%:%1696=556%:%
%:%1697=556%:%
%:%1698=557%:%
%:%1713=559%:%
%:%1723=561%:%
%:%1724=561%:%
%:%1725=562%:%
%:%1726=563%:%
%:%1727=564%:%
%:%1728=565%:%
%:%1729=565%:%
%:%1730=566%:%
%:%1733=567%:%
%:%1737=567%:%
%:%1738=567%:%
%:%1739=568%:%
%:%1740=568%:%
%:%1741=568%:%
%:%1746=568%:%
%:%1749=569%:%
%:%1750=570%:%
%:%1751=570%:%
%:%1752=571%:%
%:%1753=572%:%
%:%1756=573%:%
%:%1760=573%:%
%:%1761=573%:%
%:%1762=574%:%
%:%1763=574%:%
%:%1768=574%:%
%:%1771=575%:%
%:%1772=576%:%
%:%1773=576%:%
%:%1774=577%:%
%:%1775=578%:%
%:%1776=579%:%
%:%1777=580%:%
%:%1778=580%:%
%:%1779=581%:%
%:%1782=582%:%
%:%1786=582%:%
%:%1787=582%:%
%:%1788=583%:%
%:%1789=583%:%
%:%1790=583%:%
%:%1795=583%:%
%:%1798=584%:%
%:%1799=585%:%
%:%1800=585%:%
%:%1801=586%:%
%:%1802=587%:%
%:%1805=588%:%
%:%1809=588%:%
%:%1810=588%:%
%:%1811=588%:%
%:%1812=589%:%
%:%1813=589%:%
%:%1818=589%:%
%:%1821=590%:%
%:%1822=591%:%
%:%1823=591%:%
%:%1824=592%:%
%:%1825=593%:%
%:%1826=594%:%
%:%1827=594%:%
%:%1828=595%:%
%:%1831=596%:%
%:%1835=596%:%
%:%1836=596%:%
%:%1837=597%:%
%:%1838=597%:%
%:%1843=597%:%
%:%1846=598%:%
%:%1847=599%:%
%:%1848=599%:%
%:%1849=600%:%
%:%1850=601%:%
%:%1853=602%:%
%:%1857=602%:%
%:%1858=602%:%
%:%1859=602%:%
%:%1860=603%:%
%:%1861=603%:%
%:%1866=603%:%
%:%1869=604%:%
%:%1870=605%:%
%:%1871=605%:%
%:%1872=606%:%
%:%1879=607%:%
%:%1880=607%:%
%:%1881=608%:%
%:%1882=608%:%
%:%1883=609%:%
%:%1884=609%:%
%:%1885=610%:%
%:%1886=610%:%
%:%1887=610%:%
%:%1888=611%:%
%:%1889=612%:%
%:%1890=612%:%
%:%1891=612%:%
%:%1892=613%:%
%:%1893=613%:%
%:%1894=614%:%
%:%1895=614%:%
%:%1896=614%:%
%:%1897=615%:%
%:%1898=616%:%
%:%1899=616%:%
%:%1900=616%:%
%:%1901=617%:%
%:%1902=618%:%
%:%1903=618%:%
%:%1904=619%:%
%:%1905=619%:%
%:%1906=619%:%
%:%1907=620%:%
%:%1908=620%:%
%:%1909=620%:%
%:%1910=621%:%
%:%1911=621%:%
%:%1912=621%:%
%:%1913=622%:%
%:%1914=622%:%
%:%1915=622%:%
%:%1916=623%:%
%:%1917=623%:%
%:%1918=623%:%
%:%1919=624%:%
%:%1920=624%:%
%:%1921=624%:%
%:%1922=625%:%
%:%1923=625%:%
%:%1924=625%:%
%:%1925=626%:%
%:%1926=626%:%
%:%1927=626%:%
%:%1928=627%:%
%:%1929=627%:%
%:%1930=627%:%
%:%1931=628%:%
%:%1932=628%:%
%:%1933=629%:%
%:%1934=629%:%
%:%1935=629%:%
%:%1936=630%:%
%:%1937=630%:%
%:%1938=631%:%
%:%1953=633%:%
%:%1963=635%:%
%:%1964=635%:%
%:%1965=636%:%
%:%1968=639%:%
%:%1969=640%:%
%:%1970=641%:%
%:%1971=641%:%
%:%1974=642%:%
%:%1978=642%:%
%:%1979=642%:%
%:%1980=642%:%
%:%1985=642%:%
%:%1988=643%:%
%:%1989=644%:%
%:%1990=644%:%
%:%1991=645%:%
%:%1992=646%:%
%:%1999=647%:%
%:%2000=647%:%
%:%2001=648%:%
%:%2002=648%:%
%:%2005=651%:%
%:%2006=652%:%
%:%2007=652%:%
%:%2008=652%:%
%:%2009=652%:%
%:%2010=653%:%
%:%2011=653%:%
%:%2012=653%:%
%:%2013=654%:%
%:%2014=654%:%
%:%2015=654%:%
%:%2016=655%:%
%:%2017=655%:%
%:%2018=655%:%
%:%2019=656%:%
%:%2020=656%:%
%:%2021=656%:%
%:%2022=657%:%
%:%2023=657%:%
%:%2024=657%:%
%:%2025=658%:%
%:%2026=658%:%
%:%2027=658%:%
%:%2028=659%:%
%:%2034=659%:%
%:%2037=660%:%
%:%2038=661%:%
%:%2039=661%:%
%:%2040=662%:%
%:%2043=665%:%
%:%2044=666%:%
%:%2045=667%:%
%:%2046=667%:%
%:%2049=668%:%
%:%2053=668%:%
%:%2054=668%:%
%:%2055=668%:%
%:%2060=668%:%
%:%2063=669%:%
%:%2064=670%:%
%:%2065=670%:%
%:%2066=671%:%
%:%2067=672%:%
%:%2074=673%:%
%:%2075=673%:%
%:%2076=674%:%
%:%2077=674%:%
%:%2079=676%:%
%:%2080=677%:%
%:%2081=677%:%
%:%2082=677%:%
%:%2083=677%:%
%:%2084=678%:%
%:%2085=678%:%
%:%2086=678%:%
%:%2087=679%:%
%:%2088=679%:%
%:%2089=679%:%
%:%2090=680%:%
%:%2091=680%:%
%:%2092=680%:%
%:%2093=681%:%
%:%2094=681%:%
%:%2095=681%:%
%:%2096=682%:%
%:%2097=682%:%
%:%2098=682%:%
%:%2099=683%:%
%:%2100=683%:%
%:%2101=683%:%
%:%2102=684%:%
%:%2108=684%:%
%:%2111=685%:%
%:%2112=686%:%
%:%2113=686%:%
%:%2114=687%:%
%:%2117=690%:%
%:%2118=691%:%
%:%2119=692%:%
%:%2120=692%:%
%:%2123=693%:%
%:%2127=693%:%
%:%2128=693%:%
%:%2129=693%:%
%:%2134=693%:%
%:%2137=694%:%
%:%2138=695%:%
%:%2139=695%:%
%:%2140=696%:%
%:%2141=697%:%
%:%2148=698%:%
%:%2149=698%:%
%:%2150=699%:%
%:%2151=699%:%
%:%2152=700%:%
%:%2153=700%:%
%:%2154=700%:%
%:%2155=700%:%
%:%2156=701%:%
%:%2157=701%:%
%:%2158=701%:%
%:%2159=702%:%
%:%2160=702%:%
%:%2161=702%:%
%:%2162=703%:%
%:%2163=703%:%
%:%2164=703%:%
%:%2165=704%:%
%:%2166=704%:%
%:%2167=704%:%
%:%2168=705%:%
%:%2169=705%:%
%:%2170=705%:%
%:%2171=706%:%
%:%2172=706%:%
%:%2173=706%:%
%:%2174=707%:%
%:%2180=707%:%
%:%2183=708%:%
%:%2184=709%:%
%:%2185=709%:%
%:%2186=710%:%
%:%2189=713%:%
%:%2190=714%:%
%:%2191=715%:%
%:%2192=715%:%
%:%2195=716%:%
%:%2199=716%:%
%:%2200=716%:%
%:%2201=716%:%
%:%2206=716%:%
%:%2209=717%:%
%:%2210=718%:%
%:%2211=718%:%
%:%2212=719%:%
%:%2213=720%:%
%:%2220=721%:%
%:%2221=721%:%
%:%2222=722%:%
%:%2223=722%:%
%:%2224=723%:%
%:%2225=723%:%
%:%2226=723%:%
%:%2227=723%:%
%:%2228=724%:%
%:%2229=724%:%
%:%2230=724%:%
%:%2231=725%:%
%:%2232=725%:%
%:%2233=725%:%
%:%2234=726%:%
%:%2235=726%:%
%:%2236=726%:%
%:%2237=727%:%
%:%2238=727%:%
%:%2239=727%:%
%:%2240=728%:%
%:%2241=728%:%
%:%2242=728%:%
%:%2243=729%:%
%:%2244=729%:%
%:%2245=729%:%
%:%2246=730%:%
%:%2252=730%:%
%:%2257=731%:%
%:%2262=732%:%
