%
\begin{isabellebody}%
\setisabellecontext{Exponential{\isacharunderscore}{\kern0pt}Objects}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Exponential{\isacharunderscore}{\kern0pt}Objects\isanewline
\ \ \isakeyword{imports}\ Initial\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Exponential Objects, Transposes and Evaluation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The axiomatization below corresponds to Axiom 9 (Exponential Objects) in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{axiomatization}\isamarkupfalse%
\isanewline
\ \ exp{\isacharunderscore}{\kern0pt}set\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsup {\isacharunderscore}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{and}\isanewline
\ \ eval{\isacharunderscore}{\kern0pt}func\ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isakeyword{where}\isanewline
\ \ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\isactrlbsup A\isactrlesup \ {\isacharequal}{\kern0pt}\ Y\isactrlbsup B\isactrlesup \ {\isasymLongrightarrow}\ X\ {\isacharequal}{\kern0pt}\ Y\ {\isasymand}\ A\ {\isacharequal}{\kern0pt}\ B{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub c\ X\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub cZ\ {\isasymrightarrow}\ X\ {\isasymLongrightarrow}\ g{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymLongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}surj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ codomain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ a\ \isakeyword{where}\ a{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ nonempty{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ needed{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ one{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isasymrangle}\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ one{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ one{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ one{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ a{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ comp{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ one\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}y{\isachardot}{\kern0pt}\ y\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymand}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ y\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ needed{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to a note above Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}injective{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Lifting Functions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlbsup {\isacharunderscore}{\kern0pt}\isactrlesup \isactrlsub f{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}func\ g\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}domain\ g{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}func\ g\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharcolon}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to a note below Definition 2.5.1 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}square{\isacharunderscore}{\kern0pt}diagram{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.2 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ g{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ X\ {\isasymrightarrow}\ Y\ {\isasymand}\ g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\ \ {\isasymLongrightarrow}\ \ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ right{\isacharunderscore}{\kern0pt}eq\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharequal}{\kern0pt}\ id\isactrlsub c{\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}domain\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to comments below Proposition 2.5.2 and above Definition 2.5.3 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\isactrlsub c\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}a{\isacharcomma}{\kern0pt}x{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isacharcomma}{\kern0pt}x{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ eval{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}sharp{\isadigit{1}}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}type\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Inverse Transpose Function (flat)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.3 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlsup {\isasymflat}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ g{\isachardot}{\kern0pt}\ {\isasymexists}\ Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}\ Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}Z\ Y\ B{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ Y\isactrlbsup B\isactrlesup \ {\isasymand}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}Z\ X\ A{\isachardot}{\kern0pt}\ domain\ f\ {\isacharequal}{\kern0pt}\ Z\ {\isasymand}\ codomain\ f\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup \ {\isasymand}\ g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ f{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}etcs{\isacharunderscore}{\kern0pt}subst\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.4 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ f{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ unfold\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.5 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X\ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.6 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}\ g{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup \ {\isasymlongrightarrow}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ f{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ uniqueness\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ f\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z{\isacharequal}{\kern0pt}W{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X{\isacharequal}{\kern0pt}X{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A{\isacharequal}{\kern0pt}A{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}epimorphism\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ equals{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}surj\ epi{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}surj\ id{\isacharunderscore}{\kern0pt}isomorphism\ id{\isacharunderscore}{\kern0pt}type\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}epi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}surj\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}codomain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ domain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ composition{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epi\ equals\ eval{\isacharunderscore}{\kern0pt}epi\ idA{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}epi{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}injective\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}injective{\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}g\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ g\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mono{\isacharunderscore}{\kern0pt}g{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}monomorphism\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ CollectI\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ \ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ \ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ x{\isacharunderscore}{\kern0pt}type\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ presburger\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ A{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ assms\ eqs\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ force\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ eqs\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ flat{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ \ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ mono{\isacharunderscore}{\kern0pt}g\ flat{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ x{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}type{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}injective{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isasymexists}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ one\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ one\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}x\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub one\ {\isasymtimes}\isactrlsub c\ one\isactrlesub {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ x\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub one\ {\isasymtimes}\isactrlsub c\ one\isactrlesub {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymin}\isactrlsub c\ domain\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ evals{\isacharunderscore}{\kern0pt}equal{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ X\ one\ {\isasymcirc}\isactrlsub c\ a\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ one\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}domain{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ one\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\isactrlbsup one\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ A\ \isakeyword{where}\ a{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymin}\isactrlsub c\ X\isactrlbsup one\isactrlesup \ {\isasymand}\ a\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ A{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ a{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ eval{\isacharunderscore}{\kern0pt}dom\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ B\ \isakeyword{where}\ b{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ {\isasymin}\isactrlsub c\ X\isactrlbsup one\isactrlesup \ {\isasymand}\ b\ {\isacharequal}{\kern0pt}\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ B{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ b{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ eval{\isacharunderscore}{\kern0pt}dom\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one\ {\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ one\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}A\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ one\ {\isasymcirc}\isactrlsub c\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ one\ {\isasymcirc}\isactrlsub c\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ evals{\isacharunderscore}{\kern0pt}equal{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ one\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}B\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ b{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ one{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ B\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ swap{\isacharunderscore}{\kern0pt}def\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ diagonal{\isacharunderscore}{\kern0pt}def\ diagonal{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ swap{\isacharunderscore}{\kern0pt}idempotent\ swap{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a{\isacharunderscore}{\kern0pt}def\ b{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}type\ injective{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
In the lemma below, the nonempty assumption is required.
      Consider, for example, \isa{X\ {\isacharequal}{\kern0pt}\ {\isasymOmega}} and \isa{A\ {\isacharequal}{\kern0pt}\ {\isasymemptyset}}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ Z\ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ \ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ g\ h\ U\ Y\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ equals{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Y\ {\isacharequal}{\kern0pt}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}XA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ g{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ U\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ h{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idg{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ U\ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idh{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\ {\isasymtimes}\isactrlsub c\ U\ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ epic{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ nonempty{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \isacommand{have}\isamarkupfalse%
\ fIdg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fIdh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ idg{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ equals{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Y{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Z\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ calculation\ equals\ f{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type\ h{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ idg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}idh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ fIdg{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}fIdh\ idg{\isacharunderscore}{\kern0pt}type\ idh{\isacharunderscore}{\kern0pt}type\ monomorphism{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ A\ U{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ epic\ epimorphism{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ g{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Metafunctions and their Inverses (Cnufatems)%
}
\isamarkuptrue%
%
\isamarkupsubsection{Metafunctions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ metafunc\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}metafunc\ f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ f{\isacharparenright}{\kern0pt}\ one{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ \ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ metafunc\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Inverse Metafunctions (Cnufatems)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ cnufatem\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}cnufatem\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ g{\isachardot}{\kern0pt}\ {\isasymforall}\ Y\ X{\isachardot}{\kern0pt}\ f\ {\isacharcolon}{\kern0pt}\ one\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ g\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ theI{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isacharcolon}{\kern0pt}\ X\ \ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cnufatem{\isacharunderscore}{\kern0pt}metafunc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ X{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Y{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymLongrightarrow}\ cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ \ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ eval{\isacharunderscore}{\kern0pt}lemma\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}cnufatem\ {\isacharparenleft}{\kern0pt}metafunc\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z\ {\isacharequal}{\kern0pt}\ one{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ X{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Y{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\ \isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isasymin}\isactrlsub c\ X\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ eval{\isacharunderscore}{\kern0pt}lemma\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X\ {\isasymcirc}\isactrlsub c\ x\ {\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymbeta}\isactrlbsub X\isactrlesub \ {\isasymcirc}\isactrlsub c\ x{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}elem{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ X\ {\isasymcirc}\isactrlsub c\ x\ {\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}elem\ x{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}metis\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ metafunc\ {\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ calculation\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Metafunction Composition%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cset\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ \ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ \ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ \ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ \ \ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ \ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ \ X\ {\isacharparenright}{\kern0pt}\ \ {\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isacharcolon}{\kern0pt}\ Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymbox}{\isachardoublequoteclose}\ {\isadigit{5}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ f\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ h{\isachardot}{\kern0pt}\ {\isasymexists}\ W\ X\ Y{\isachardot}{\kern0pt}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup \ {\isasymand}\ h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ the{\isacharunderscore}{\kern0pt}equality{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}elements{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}{\isacharequal}{\kern0pt}\ \ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}id\isactrlsub c\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}id\isactrlsub c\ one{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharequal}{\kern0pt}\ metafunc\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}cnufatem\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}cnufatem\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Z{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ \ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ id{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}elements{\isacharunderscore}{\kern0pt}aux\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isacharparenleft}{\kern0pt}domain\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ one{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}type\ domain{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{4}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ \ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ metafunc{\isacharunderscore}{\kern0pt}def\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ \ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ \ {\isasymtimes}\isactrlsub f\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Z{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isadigit{1}}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ \ {\isasymin}\isactrlsub c\ X\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ id\isactrlsub c\ one{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ id{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x\ {\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcomma}{\kern0pt}f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\ {\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ \ f\ {\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}{\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}{\isasymlangle}g{\isacharcomma}{\kern0pt}\ x{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}{\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}\ x\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}{\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharcomma}{\kern0pt}\ x\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ swap{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isasymlangle}x{\isacharcomma}{\kern0pt}\ \ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ x{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ Y{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Y\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ X{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub X\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\isanewline
\ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ \ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ sharp{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ swap\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ X\ {\isasymcirc}\isactrlsub c\ swap\ X\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ cnufatem{\isacharunderscore}{\kern0pt}type\ domain{\isacharunderscore}{\kern0pt}comp\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}els{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}w\ {\isasymin}\isactrlsub c\ W{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ \ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ w{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ calculation\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isanewline
\ \ \ \ \ \ \ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ Y\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub cw{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub cw{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ id\ {\isacharparenleft}{\kern0pt}X{\isasymtimes}\isactrlsub c\ one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}g{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ one{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{5}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ \ \ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ W{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymbox}\ g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ w\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\isactrlsub c\ W{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\ {\isasymcirc}\isactrlsub c\ w{\isacharcomma}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ w{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}els{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}meta{\isacharunderscore}{\kern0pt}comp\ X\ Y\ Z\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f{\isacharcomma}{\kern0pt}g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ X\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isasymbox}\ metafunc\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ cnufatem{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}identity{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ X\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}metafunc{\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\ {\isasymbox}\ g\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ cnufatem{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}metacomp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Y\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}f\ {\isasymcirc}\isactrlsub c\ g\ {\isacharequal}{\kern0pt}\ cnufatem{\isacharparenleft}{\kern0pt}metafunc\ f\ {\isasymbox}\ metafunc\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cnufatem{\isacharunderscore}{\kern0pt}metafunc\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ metacomp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}cnufatem\ f\ {\isasymcirc}\isactrlsub c\ cnufatem\ g\ {\isacharequal}{\kern0pt}\ cnufatem{\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}metacomp\ metafunc{\isacharunderscore}{\kern0pt}cnufatem{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ meta{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ A\isactrlbsup Z\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ W\ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymbox}\ f{\isacharparenright}{\kern0pt}\ {\isasymbox}\ \ g\ \ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymbox}\ f{\isacharparenright}{\kern0pt}\ {\isasymbox}\ \ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymbox}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ Y\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\ \ \ \ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}\ {\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}e\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}g\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ W{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ e\ {\isasymbox}\ {\isacharparenleft}{\kern0pt}f\ {\isasymbox}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ meta{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Partially Parameterized Functions on Pairs%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}left{\isacharunderscore}{\kern0pt}param\ k\ p\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}THE\ f{\isachardot}{\kern0pt}\ \ {\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ f\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ left{\isacharunderscore}{\kern0pt}param\ k\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ the{\isadigit{1}}I{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ assms{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isacharcolon}{\kern0pt}\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}el{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}p{\isacharcomma}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub Q\isactrlesub {\isacharcomma}{\kern0pt}\ id\ Q{\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ left{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}right\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cfunc\ {\isasymRightarrow}\ cfunc\ {\isasymRightarrow}\ cfunc{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharbrackright}{\kern0pt}\isactrlesub {\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}right{\isacharunderscore}{\kern0pt}param\ k\ q\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}THE\ f{\isachardot}{\kern0pt}\ \ {\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ f\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}\ P\ Q\ R{\isachardot}{\kern0pt}\ k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}param\ k\ q\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ insert\ assms{\isacharcomma}{\kern0pt}\ auto{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymequiv}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ P{\isacharcomma}{\kern0pt}q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}inj\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isacharcolon}{\kern0pt}\ P\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}el{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharcolon}{\kern0pt}\ P\ {\isasymtimes}\isactrlsub c\ Q\ {\isasymrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymin}\isactrlsub c\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\isactrlsub c\ Q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\isactrlbsub {\isacharbrackleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharcomma}{\kern0pt}q{\isacharbrackright}{\kern0pt}\isactrlesub \ {\isasymcirc}\isactrlsub c\ p\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}id\ P{\isacharcomma}{\kern0pt}\ q\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub P\isactrlesub {\isasymrangle}\ \ {\isasymcirc}\isactrlsub c\ p{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ right{\isacharunderscore}{\kern0pt}param{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}p{\isacharcomma}{\kern0pt}\ q{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}extract{\isacharunderscore}{\kern0pt}left\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Exponential Set Facts%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.7 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}X\isactrlbsup one\isactrlesup \ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}defn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ X\ one{\isachardoublequoteclose}\ \isakeyword{and}\ e{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ one\ {\isasymtimes}\isactrlsub c\ X\isactrlbsup one\isactrlesup \ {\isasymrightarrow}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ i{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharcolon}{\kern0pt}\ one\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}inv\ \isakeyword{where}\ i{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharunderscore}{\kern0pt}inv{\isacharcolon}{\kern0pt}\ one{\isasymrightarrow}\ \ one\ {\isasymtimes}\isactrlsub c\ one\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}\ {\isasymand}\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i{\isacharunderscore}{\kern0pt}inv\ {\isasymcirc}\isactrlsub c\ i\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one\ {\isasymtimes}\isactrlsub c\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}diagonal\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ diagonal{\isacharunderscore}{\kern0pt}def\ i{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i{\isacharunderscore}{\kern0pt}inv{\isacharcolon}{\kern0pt}\ one{\isasymrightarrow}\ \ one\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ inj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}injective{\isacharparenleft}{\kern0pt}e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ e{\isacharunderscore}{\kern0pt}defn\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}X{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}injective{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ surj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ codomain\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ e{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ witness{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ one\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv\ {\isasymin}\isactrlsub c\ one\ {\isasymtimes}\isactrlsub c\ X\isactrlbsup one\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ square{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ y\ {\isasymcirc}\isactrlsub c\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}defn\ i{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ y{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ domain\ e\ {\isasymand}\ e\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}type\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}y\ {\isasymcirc}\isactrlsub c\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ i{\isacharunderscore}{\kern0pt}inv{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}{\kern0pt}\ typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ i{\isacharunderscore}{\kern0pt}iso\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ inj\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism\ surj\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\isactrlbsup one\isactrlesup \ {\isasymcong}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ e{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ one{\isacharunderscore}{\kern0pt}x{\isacharunderscore}{\kern0pt}A{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.8 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymcong}\ one{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isasymalpha}\isactrlbsub X\isactrlesub {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymemptyset}\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}z{\isachardot}{\kern0pt}\ z\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymlongrightarrow}\ z{\isacharequal}{\kern0pt}f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ z{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ j{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}j{\isacharcolon}{\kern0pt}{\isasymemptyset}\ {\isasymrightarrow}\ {\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ one\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ empty{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}X\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ psi{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharcolon}{\kern0pt}\ {\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ {\isasymemptyset}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}\ {\isasymtimes}\isactrlsub c\ one{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ j\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ j{\isacharunderscore}{\kern0pt}iso\ \isacommand{by}\isamarkupfalse%
\ fastforce\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}sharp\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ z\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ comp{\isacharunderscore}{\kern0pt}type\ emptyset{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ one{\isacharunderscore}{\kern0pt}separator{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ fsharp{\isacharunderscore}{\kern0pt}type\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ z{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}{\isacharbang}{\kern0pt}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\isactrlbsup {\isasymemptyset}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}f\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ \isakeyword{in}\ ex{\isadigit{1}}I{\isacharcomma}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\isactrlbsup {\isasymemptyset}\isactrlesup \ {\isasymcong}\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}one\isactrlbsup X\isactrlesup \ {\isasymcong}\ one{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ nonempty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}one\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ nonempty{\isacharunderscore}{\kern0pt}def\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}defn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ one\ X{\isachardoublequoteclose}\ \isakeyword{and}\ e{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniqueness{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isasymin}\isactrlsub c\ one\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ X\ {\isasymtimes}\isactrlsub c\ one\ \ {\isasymrightarrow}\ one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ e{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ uniquess{\isacharunderscore}{\kern0pt}form{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isasymin}\isactrlsub c\ one\isactrlbsup X\isactrlesup \ {\isasymlongrightarrow}\ e\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymbeta}\isactrlbsub X\ {\isasymtimes}\isactrlsub c\ one\isactrlesub {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique\ uniqueness\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ ex{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}{\isacharbang}{\kern0pt}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ one\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ e{\isacharunderscore}{\kern0pt}defn\ nonempty\ nonempty{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique\ uniqueness{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}one\isactrlbsup X\isactrlesup \ {\isasymcong}\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ex{\isadigit{1}}\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The lemma below corresponds to Proposition 2.5.9 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}rule{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymcong}\ X\isactrlbsup A\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ Z\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ X\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymand}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}fflat{\isacharunderscore}{\kern0pt}gflat{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ projection{\isacharunderscore}{\kern0pt}property{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ projection{\isacharunderscore}{\kern0pt}property{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}f\isactrlsup {\isasymflat}\ {\isacharcomma}{\kern0pt}g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ f\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ g\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ h\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ Z\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ computation{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacartoucheclose}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ unqiueness{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ \ f\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ computation{\isadigit{1}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ \ \ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \isactrlsub f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ computation{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}g\ {\isacharequal}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}{\isacartoucheclose}\ {\isacartoucheopen}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\ {\isasymcirc}\isactrlsub c\ h\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ unqiueness{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ \ g\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ computation{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}flat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\isactrlsup {\isasymflat}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ g\isactrlsup {\isasymflat}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unique\ unqiueness{\isadigit{1}}\ unqiueness{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sharp{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}fflat{\isacharunderscore}{\kern0pt}gflat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}f\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}\ g\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ \ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isacharcomma}{\kern0pt}{\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ X\ Y\isactrlbsup A\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}{\isasymrangle}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}property{\isadigit{1}}\ h{\isacharunderscore}{\kern0pt}property{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ Y{\isacharparenright}{\kern0pt}\isactrlbsup A\isactrlesup \ {\isasymcong}\ X\isactrlbsup A\isactrlesup \ {\isasymtimes}\isactrlsub c\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ cart{\isacharunderscore}{\kern0pt}prods{\isacharunderscore}{\kern0pt}isomorphic\ fst{\isacharunderscore}{\kern0pt}conv\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exponential{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}distribution{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymcong}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ H\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}h{\isachardot}{\kern0pt}\ h\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h\ {\isacharequal}{\kern0pt}\ g\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}h{\isadigit{2}}{\isachardot}{\kern0pt}\ h{\isadigit{2}}\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ f\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sharp{\isacharunderscore}{\kern0pt}comp\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ h\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}h\ {\isacharcolon}{\kern0pt}\ H\ {\isasymrightarrow}\ Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ h\isactrlsup {\isasymflat}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub cH{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ Z{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\isactrlsup {\isasymflat}\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H\ {\isasymrightarrow}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}xyh{\isachardot}{\kern0pt}\ xyh\ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ xyh\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ l{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xyh\ {\isasymin}\isactrlsub c\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ H{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ xy\ \isakeyword{and}\ z\ \isakeyword{where}\ xy{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isasymin}\isactrlsub c\ X\ {\isasymCoprod}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ z{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\isactrlsub c\ H{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isakeyword{and}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xyh\ {\isacharequal}{\kern0pt}\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ \ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\ \isakeyword{and}\ xy{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isacharequal}{\kern0pt}\ \ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}ap\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ \ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}x{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isacharcomma}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ X\ {\isasymand}\ xy\ {\isacharequal}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ xy{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}xy\ {\isacharequal}{\kern0pt}\ \ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ coprojs{\isacharunderscore}{\kern0pt}jointly{\isacharunderscore}{\kern0pt}surj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ xyh\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\ H{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}ap\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\isactrlsup {\isasymflat}\ {\isasymamalg}\ g\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ {\isacharparenleft}{\kern0pt}X\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Y\ {\isasymtimes}\isactrlsub c\ H{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}coproj\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ \ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ \ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}eqs\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\isactrlsup {\isasymflat}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}id\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}y{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymlangle}right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymcirc}\isactrlsub c\ y{\isacharcomma}{\kern0pt}\ h\ {\isasymcirc}\isactrlsub c\ z{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ h{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}xy{\isacharcomma}{\kern0pt}z{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ xy{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ h\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\ xyh{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}\ xyh{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymamalg}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Z\ {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ X\ Y\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Z\isactrlbsup {\isacharparenleft}{\kern0pt}X\ {\isasymCoprod}\ Y{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ h{\isacharparenright}{\kern0pt}\isactrlsup {\isasymflat}\ {\isasymcirc}\isactrlsub c\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dist{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}coprod{\isacharunderscore}{\kern0pt}inv{\isadigit{2}}\ X\ Y\ H{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eqs\ g{\isacharunderscore}{\kern0pt}eqs\ h{\isacharunderscore}{\kern0pt}type\ sharp{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}flat\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ canonical{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}prod\ cart{\isacharunderscore}{\kern0pt}prods{\isacharunderscore}{\kern0pt}isomorphic\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ prod{\isachardot}{\kern0pt}sel{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ j{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}j{\isacharcolon}{\kern0pt}\ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ one{\isasymtimes}\isactrlsub c\ {\isasymemptyset}\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\ \isakeyword{and}\ j{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ one{\isacharunderscore}{\kern0pt}x{\isacharunderscore}{\kern0pt}A{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ nonempty{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ e\ \isakeyword{where}\ e{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}e{\isacharcolon}{\kern0pt}\ X{\isasymtimes}\isactrlsub c\ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ iso{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}e\ {\isasymcirc}\isactrlsub c\ y\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}{\isasymemptyset}\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ j\ {\isacharcolon}{\kern0pt}\ \ {\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymemptyset}\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ function{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}A\isactrlbsup Y\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ A\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}{\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ X\isactrlbsup Y\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ A\isactrlbsup Y\isactrlesup \ {\isasymrightarrow}\ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idXY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ \ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ calculation\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\ X{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idAY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}X\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\isactrlbsup Y\isactrlesup \isactrlsub f\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ calculation\ exp{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}factors{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}id\ A{\isacharparenright}{\kern0pt}\isactrlbsup Y\isactrlesup \isactrlsub f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ idA{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ exponential{\isacharunderscore}{\kern0pt}object{\isacharunderscore}{\kern0pt}identity{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ X\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ eval{\isacharunderscore}{\kern0pt}func\ A\ Y{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ \ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup Y\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ \ {\isachardoublequoteopen}A\isactrlbsup Y\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ idAY\ idXY\ id{\isacharunderscore}{\kern0pt}isomorphism\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic\ phi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type\ psi{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ expset{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}tower{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup \ {\isasymcong}\ A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ B\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}dbsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasympsi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\ {\isacharcolon}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasympsi}sharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup \ {\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z{\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}C{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z{\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}C\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}B{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ C\ {\isasymtimes}\isactrlsub c\ A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup B\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ C\ {\isasymtimes}\isactrlsub c\ A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup B\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasymphi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ \ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ associate{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ \ associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ meson\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ B\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ B\ {\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ C\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z{\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup \ {\isasymrightarrow}\ A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isasympsi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ domain{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ associate{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}crossprod{\isacharunderscore}{\kern0pt}ap\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup {\isacharparenright}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ B{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isasymtimes}\isactrlsub f\ {\isasymphi}\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}left\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}associate{\isacharunderscore}{\kern0pt}right\ B\ C\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B{\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacartoucheopen}{\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup B\isactrlesup \isactrlbsup C\isactrlesup {\isacharparenright}{\kern0pt}{\isacartoucheclose}\ {\isacartoucheopen}{\isasympsi}\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\isactrlsup {\isasymsharp}\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}A\isactrlbsup {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\isactrlsub c\ C{\isacharparenright}{\kern0pt}\isactrlesup {\isacharparenright}{\kern0pt}{\isacartoucheclose}\ {\isasymphi}dbsharp{\isacharunderscore}{\kern0pt}type\ {\isasympsi}sharp{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup A\isactrlesup \ {\isasymcong}\ \ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}{\isacharcolon}{\kern0pt}\ X\ {\isasymrightarrow}\ A\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}symmetric\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasympsi}\ \isakeyword{where}\ {\isasympsi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasympsi}{\isacharcolon}{\kern0pt}\ A\ {\isasymrightarrow}\ X\ {\isasymand}\ isomorphism{\isacharparenleft}{\kern0pt}{\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ isomorphism{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ idA{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ isomorphism{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ X{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isacharcolon}{\kern0pt}\ A{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ fsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ g\ \isakeyword{where}\ g{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ Y\ A{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ \ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g{\isacharcolon}{\kern0pt}\ X{\isasymtimes}\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ gsharp{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ presburger{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}gsharp{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ A{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ idYA{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup A\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup A\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ f{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ g{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}type\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ {\isasympsi}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ idYA{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ \isacommand{by}\isamarkupfalse%
\ auto\ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ idA\ idYA{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ g\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ A\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ gsharp{\isacharunderscore}{\kern0pt}fsharp{\isacharunderscore}{\kern0pt}id{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ Y{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ X{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ idYX{\isacharunderscore}{\kern0pt}type{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}\ Y\isactrlbsup X\isactrlesup \ {\isasymrightarrow}\ Y\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}type\ identity{\isacharunderscore}{\kern0pt}distributes{\isacharunderscore}{\kern0pt}across{\isacharunderscore}{\kern0pt}composition\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup A\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative\ fsharp{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ fsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ A\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f\isactrlsup {\isasymsharp}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ fsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isasymphi}\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ f{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasympsi}\ {\isasymcirc}\isactrlsub c\ {\isasymphi}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod\ idYX{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}X{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ id{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasympsi}{\isacharunderscore}{\kern0pt}def\ idYX{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ g\isactrlsup {\isasymsharp}\ {\isasymcirc}\isactrlsub c\ f\isactrlsup {\isasymsharp}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ Y\ X\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ X\ {\isasymtimes}\isactrlsub f\ id\isactrlsub c\ {\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi\ comp{\isacharunderscore}{\kern0pt}monic{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monic\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso\ fsharp{\isacharunderscore}{\kern0pt}gsharp{\isacharunderscore}{\kern0pt}id\ fsharp{\isacharunderscore}{\kern0pt}type\ gsharp{\isacharunderscore}{\kern0pt}fsharp{\isacharunderscore}{\kern0pt}id\ gsharp{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}isomorphism\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ iso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}epi{\isacharunderscore}{\kern0pt}and{\isacharunderscore}{\kern0pt}monic{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasymcong}\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}B\ {\isasymcong}\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}A\isactrlbsup B\isactrlesup \ {\isasymcong}\ \ X\isactrlbsup Y\isactrlesup {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}left\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ empty{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}nonempty{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ X{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ one{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ exp{\isacharunderscore}{\kern0pt}pres{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}right\ isomorphic{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}transitive\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ exp{\isacharunderscore}{\kern0pt}empty\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nonempty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}nonempty\ X{\isachardoublequoteclose}\ {\isachardoublequoteopen}nonempty\ Y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}nonempty{\isacharparenleft}{\kern0pt}Y\isactrlbsup X\isactrlesup {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ nonempty{\isacharunderscore}{\kern0pt}def\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty{\isacharunderscore}{\kern0pt}converse{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Y\isactrlbsup X\isactrlesup \ {\isasymcong}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ Y\ {\isasymand}\ nonempty\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def\ exp{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ assms\ no{\isacharunderscore}{\kern0pt}el{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}empty\ nonempty{\isacharunderscore}{\kern0pt}def\ nonempty{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nonempty\ single{\isacharunderscore}{\kern0pt}elem{\isacharunderscore}{\kern0pt}iso{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The definition below corresponds to Definition 2.5.11 in Halvorson.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ powerset\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cset\ {\isasymRightarrow}\ cset{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymP}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}{\isasymP}\ X\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\isactrlbsup X\isactrlesup {\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sets{\isacharunderscore}{\kern0pt}squared{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}A\isactrlbsup {\isasymOmega}\isactrlesup \ {\isasymcong}\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ {\isasymphi}\ \isakeyword{where}\ {\isasymphi}{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymphi}{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isacharcolon}{\kern0pt}\ A\isactrlbsup {\isasymOmega}\isactrlesup \ {\isasymrightarrow}\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}injective\ {\isasymphi}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold\ injective{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ g\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ g{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ eqs{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ one{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ one\ {\isasymLongrightarrow}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ Z\ {\isacharequal}{\kern0pt}\ one{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ A{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ A\ {\isacharequal}{\kern0pt}\ {\isasymOmega}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ one\ {\isasymLongrightarrow}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ one\ {\isasymLongrightarrow}\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ one\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ \ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isasymin}\isactrlsub c\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isakeyword{where}\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isasymand}\ a{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\ {\isasymand}\ a{\isadigit{2}}\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ comp{\isacharunderscore}{\kern0pt}type\ f{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ eqs\ phi{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g\ {\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}smt\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ g{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ g{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymcirc}\isactrlsub c\ g\ {\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isasymrangle}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlangle}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharcomma}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{1}}\ equation{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ equation{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ \ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ one{\isacharunderscore}{\kern0pt}separator{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ Y\ {\isacharequal}{\kern0pt}\ A{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ {\isacharcolon}{\kern0pt}\ {\isasymOmega}\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g\ {\isacharcolon}{\kern0pt}\ {\isasymOmega}\ {\isasymtimes}\isactrlsub c\ one\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ typecheck{\isacharunderscore}{\kern0pt}cfuncs\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub c\ one\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub c\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ w\ i\ \isakeyword{where}\ \ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}w\ {\isasymin}\isactrlsub c\ {\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}i\ {\isasymin}\isactrlsub c\ one{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}w{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isacharequal}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}w\ {\isacharequal}{\kern0pt}\ {\isasymf}{\isacharparenright}{\kern0pt}\ {\isasymor}\ {\isacharparenleft}{\kern0pt}w\ {\isacharequal}{\kern0pt}\ {\isasymt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ true{\isacharunderscore}{\kern0pt}false{\isacharunderscore}{\kern0pt}only{\isacharunderscore}{\kern0pt}truth{\isacharunderscore}{\kern0pt}values\ x{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymor}\ {\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ case{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{1}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymf}{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ false{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymf}{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{1}}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ case{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}def{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ case{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}eq\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymt}{\isacharcomma}{\kern0pt}f\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f\ {\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}type\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ true{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ g{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ equation{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id\isactrlsub c\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ \ {\isasymt}{\isacharcomma}{\kern0pt}g\ {\isasymcirc}\isactrlsub c\ i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ i{\isacharunderscore}{\kern0pt}def\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod\ i{\isacharunderscore}{\kern0pt}def\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq\ id{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}i{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ x{\isacharunderscore}{\kern0pt}eq\ x{\isacharunderscore}{\kern0pt}type\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ calculation\ x{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ id\isactrlsub c\ {\isasymOmega}\ {\isasymtimes}\isactrlsub f\ g\ {\isasymcirc}\isactrlsub c\ id{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ f{\isacharunderscore}{\kern0pt}type\ g{\isacharunderscore}{\kern0pt}type\ same{\isacharunderscore}{\kern0pt}evals{\isacharunderscore}{\kern0pt}equal\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}monomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ injective{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}monomorphism\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}surjective{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ codomain\ {\isasymphi}{\isachardoublequoteclose}\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\isactrlsub c\ A\ {\isasymtimes}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isakeyword{where}\ y{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}\ {\isasymand}\ a{\isadigit{1}}\ {\isasymin}\isactrlsub c\ A\ {\isasymand}\ a{\isadigit{2}}\ {\isasymin}\isactrlsub c\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ cart{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}decomp\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ aua{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcolon}{\kern0pt}\ one\ {\isasymCoprod}\ one\ {\isasymrightarrow}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isanewline
\ \ \ \ \isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ f{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ one{\isacharparenright}{\kern0pt}\isactrlsup {\isasymsharp}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f{\isacharunderscore}{\kern0pt}type{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\isactrlsub c\ A\isactrlbsup {\isasymOmega}\isactrlesup {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ aua\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}type\ comp{\isacharunderscore}{\kern0pt}type\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}type\ transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ a{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ true{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymt}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymt}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ aua\ f{\isacharunderscore}{\kern0pt}def\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ {\isasymt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}type\ aua\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}coproj\ one\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}true{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ left{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}is{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ a{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub {\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}{\isasymrangle}\ {\isasymcirc}\isactrlsub c\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}\ {\isasymcirc}\isactrlsub c\ {\isasymbeta}\isactrlbsub A\isactrlbsup {\isasymOmega}\isactrlesup \isactrlesub \ {\isasymcirc}\isactrlsub c\ f{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}A\isactrlbsup {\isasymOmega}\isactrlesup {\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ f{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ id{\isacharunderscore}{\kern0pt}type\ one{\isacharunderscore}{\kern0pt}unique{\isacharunderscore}{\kern0pt}element\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}comp\ terminal{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type\ false{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymf}{\isacharcomma}{\kern0pt}\ f\ {\isasymcirc}\isactrlsub c\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}\ id{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ cfunc{\isacharunderscore}{\kern0pt}cross{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval{\isacharunderscore}{\kern0pt}func\ A\ {\isasymOmega}\ {\isasymcirc}\isactrlsub c\ {\isacharparenleft}{\kern0pt}id{\isacharparenleft}{\kern0pt}{\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub f\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj\ {\isasymOmega}\ one{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ {\isasymlangle}{\isasymf}{\isacharcomma}{\kern0pt}\ id{\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ metis\ \ aua\ f{\isacharunderscore}{\kern0pt}def\ flat{\isacharunderscore}{\kern0pt}cancels{\isacharunderscore}{\kern0pt}sharp\ inv{\isacharunderscore}{\kern0pt}transpose{\isacharunderscore}{\kern0pt}func{\isacharunderscore}{\kern0pt}def{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ case{\isacharunderscore}{\kern0pt}bool\ \ {\isasymcirc}\isactrlsub c\ {\isasymf}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ smt\ aua\ comp{\isacharunderscore}{\kern0pt}associative{\isadigit{2}}\ left{\isacharunderscore}{\kern0pt}cart{\isacharunderscore}{\kern0pt}proj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}prod{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isadigit{1}}\ {\isasymamalg}\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\isactrlsub c\ right{\isacharunderscore}{\kern0pt}coproj\ one\ one{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}false{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ right{\isacharunderscore}{\kern0pt}coproj{\isacharunderscore}{\kern0pt}cfunc{\isacharunderscore}{\kern0pt}coprod\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymphi}\ {\isasymcirc}\isactrlsub c\ f\ \ {\isacharequal}{\kern0pt}\ {\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}a{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}typecheck{\isacharunderscore}{\kern0pt}cfuncs{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ a{\isadigit{1}}{\isacharunderscore}{\kern0pt}is\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}is\ cfunc{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\isactrlsub c\ domain\ {\isasymphi}\ {\isasymand}\ {\isasymphi}\ {\isasymcirc}\isactrlsub c\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ cfunc{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}type\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}epimorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ surjective{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}epimorphism{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}isomorphism{\isacharparenleft}{\kern0pt}{\isasymphi}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}monomorphism\ {\isasymphi}{\isacartoucheclose}\ epi{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}iso{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymphi}{\isacharunderscore}{\kern0pt}type\ is{\isacharunderscore}{\kern0pt}isomorphic{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/ETCS/HOL-ETCS/Exponential_Objects.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%27=5%:%
%:%39=7%:%
%:%41=8%:%
%:%42=8%:%
%:%43=9%:%
%:%44=10%:%
%:%45=11%:%
%:%46=12%:%
%:%47=13%:%
%:%48=14%:%
%:%49=15%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=19%:%
%:%54=20%:%
%:%55=20%:%
%:%56=21%:%
%:%57=22%:%
%:%60=23%:%
%:%64=23%:%
%:%65=23%:%
%:%66=24%:%
%:%67=24%:%
%:%68=25%:%
%:%69=25%:%
%:%70=26%:%
%:%71=26%:%
%:%72=27%:%
%:%73=27%:%
%:%74=27%:%
%:%75=28%:%
%:%76=28%:%
%:%77=28%:%
%:%78=29%:%
%:%79=29%:%
%:%80=30%:%
%:%81=30%:%
%:%82=30%:%
%:%83=31%:%
%:%84=31%:%
%:%85=32%:%
%:%86=32%:%
%:%87=32%:%
%:%88=33%:%
%:%89=33%:%
%:%90=34%:%
%:%91=35%:%
%:%92=35%:%
%:%93=36%:%
%:%94=36%:%
%:%95=36%:%
%:%96=37%:%
%:%97=37%:%
%:%98=38%:%
%:%99=38%:%
%:%100=38%:%
%:%101=39%:%
%:%102=39%:%
%:%103=40%:%
%:%104=40%:%
%:%105=40%:%
%:%106=41%:%
%:%107=41%:%
%:%108=41%:%
%:%109=42%:%
%:%110=42%:%
%:%111=42%:%
%:%112=43%:%
%:%113=43%:%
%:%114=43%:%
%:%115=44%:%
%:%116=44%:%
%:%117=44%:%
%:%118=45%:%
%:%119=45%:%
%:%120=45%:%
%:%121=46%:%
%:%131=48%:%
%:%133=49%:%
%:%134=49%:%
%:%135=50%:%
%:%138=51%:%
%:%142=51%:%
%:%143=51%:%
%:%148=51%:%
%:%151=52%:%
%:%152=53%:%
%:%153=53%:%
%:%154=54%:%
%:%155=55%:%
%:%158=56%:%
%:%162=56%:%
%:%163=56%:%
%:%164=57%:%
%:%165=57%:%
%:%179=59%:%
%:%191=61%:%
%:%193=62%:%
%:%194=62%:%
%:%195=63%:%
%:%196=64%:%
%:%197=65%:%
%:%198=65%:%
%:%199=66%:%
%:%200=67%:%
%:%203=68%:%
%:%207=68%:%
%:%208=68%:%
%:%209=68%:%
%:%214=68%:%
%:%217=69%:%
%:%218=70%:%
%:%219=70%:%
%:%220=71%:%
%:%221=72%:%
%:%224=73%:%
%:%228=73%:%
%:%229=73%:%
%:%230=73%:%
%:%235=73%:%
%:%238=74%:%
%:%239=75%:%
%:%240=75%:%
%:%241=76%:%
%:%244=77%:%
%:%248=77%:%
%:%249=77%:%
%:%258=79%:%
%:%260=80%:%
%:%261=80%:%
%:%262=81%:%
%:%263=82%:%
%:%266=83%:%
%:%270=83%:%
%:%271=83%:%
%:%272=83%:%
%:%281=85%:%
%:%283=86%:%
%:%284=86%:%
%:%285=87%:%
%:%286=88%:%
%:%293=89%:%
%:%294=89%:%
%:%295=90%:%
%:%296=90%:%
%:%297=91%:%
%:%298=91%:%
%:%299=91%:%
%:%300=92%:%
%:%301=92%:%
%:%302=93%:%
%:%303=93%:%
%:%304=94%:%
%:%305=94%:%
%:%306=95%:%
%:%307=96%:%
%:%308=96%:%
%:%309=97%:%
%:%310=97%:%
%:%311=97%:%
%:%312=98%:%
%:%313=98%:%
%:%314=99%:%
%:%315=99%:%
%:%316=99%:%
%:%317=100%:%
%:%318=100%:%
%:%319=101%:%
%:%320=101%:%
%:%321=101%:%
%:%322=102%:%
%:%323=102%:%
%:%324=103%:%
%:%325=103%:%
%:%326=104%:%
%:%327=104%:%
%:%328=105%:%
%:%329=105%:%
%:%330=105%:%
%:%331=106%:%
%:%337=106%:%
%:%340=107%:%
%:%341=108%:%
%:%342=108%:%
%:%343=109%:%
%:%346=110%:%
%:%350=110%:%
%:%351=110%:%
%:%360=112%:%
%:%362=113%:%
%:%363=113%:%
%:%364=114%:%
%:%367=115%:%
%:%371=115%:%
%:%372=115%:%
%:%373=115%:%
%:%378=115%:%
%:%381=116%:%
%:%382=116%:%
%:%383=117%:%
%:%384=118%:%
%:%387=119%:%
%:%391=119%:%
%:%392=119%:%
%:%397=119%:%
%:%400=120%:%
%:%401=121%:%
%:%402=121%:%
%:%403=122%:%
%:%404=123%:%
%:%405=124%:%
%:%408=125%:%
%:%412=125%:%
%:%413=125%:%
%:%414=125%:%
%:%428=127%:%
%:%440=129%:%
%:%442=130%:%
%:%443=130%:%
%:%444=131%:%
%:%445=132%:%
%:%446=133%:%
%:%447=133%:%
%:%448=134%:%
%:%449=135%:%
%:%452=136%:%
%:%456=136%:%
%:%457=136%:%
%:%458=137%:%
%:%459=137%:%
%:%460=138%:%
%:%461=138%:%
%:%462=139%:%
%:%463=139%:%
%:%464=139%:%
%:%465=140%:%
%:%466=140%:%
%:%467=141%:%
%:%468=141%:%
%:%469=142%:%
%:%470=142%:%
%:%471=143%:%
%:%472=143%:%
%:%473=143%:%
%:%474=144%:%
%:%475=144%:%
%:%476=145%:%
%:%482=145%:%
%:%485=146%:%
%:%486=147%:%
%:%487=147%:%
%:%488=148%:%
%:%489=149%:%
%:%492=150%:%
%:%496=150%:%
%:%497=150%:%
%:%502=150%:%
%:%505=151%:%
%:%506=152%:%
%:%507=152%:%
%:%508=153%:%
%:%509=154%:%
%:%512=155%:%
%:%516=155%:%
%:%517=155%:%
%:%526=157%:%
%:%528=158%:%
%:%529=158%:%
%:%530=159%:%
%:%531=160%:%
%:%534=161%:%
%:%538=161%:%
%:%539=161%:%
%:%540=162%:%
%:%541=162%:%
%:%550=164%:%
%:%552=165%:%
%:%553=165%:%
%:%554=166%:%
%:%557=167%:%
%:%561=167%:%
%:%562=167%:%
%:%563=167%:%
%:%572=169%:%
%:%574=170%:%
%:%575=170%:%
%:%576=171%:%
%:%583=172%:%
%:%584=172%:%
%:%585=173%:%
%:%586=173%:%
%:%587=174%:%
%:%588=174%:%
%:%589=174%:%
%:%590=175%:%
%:%591=175%:%
%:%592=176%:%
%:%593=176%:%
%:%594=177%:%
%:%595=177%:%
%:%596=178%:%
%:%597=178%:%
%:%598=178%:%
%:%599=179%:%
%:%600=179%:%
%:%601=179%:%
%:%602=180%:%
%:%608=180%:%
%:%611=181%:%
%:%612=182%:%
%:%613=182%:%
%:%614=183%:%
%:%615=184%:%
%:%618=185%:%
%:%622=185%:%
%:%623=185%:%
%:%628=185%:%
%:%631=186%:%
%:%632=187%:%
%:%633=187%:%
%:%634=188%:%
%:%635=189%:%
%:%642=190%:%
%:%643=190%:%
%:%644=191%:%
%:%645=191%:%
%:%646=192%:%
%:%647=192%:%
%:%648=192%:%
%:%649=193%:%
%:%650=193%:%
%:%651=194%:%
%:%652=194%:%
%:%653=194%:%
%:%654=195%:%
%:%655=196%:%
%:%656=196%:%
%:%657=197%:%
%:%658=197%:%
%:%659=197%:%
%:%660=198%:%
%:%661=198%:%
%:%662=198%:%
%:%663=199%:%
%:%664=199%:%
%:%665=199%:%
%:%666=200%:%
%:%667=200%:%
%:%668=200%:%
%:%669=201%:%
%:%670=201%:%
%:%671=201%:%
%:%672=202%:%
%:%673=202%:%
%:%674=202%:%
%:%675=203%:%
%:%676=203%:%
%:%677=203%:%
%:%678=204%:%
%:%684=204%:%
%:%687=205%:%
%:%688=206%:%
%:%689=206%:%
%:%690=207%:%
%:%691=208%:%
%:%692=209%:%
%:%693=210%:%
%:%700=211%:%
%:%701=211%:%
%:%702=212%:%
%:%703=212%:%
%:%704=213%:%
%:%705=213%:%
%:%706=213%:%
%:%707=214%:%
%:%708=214%:%
%:%709=215%:%
%:%710=215%:%
%:%711=215%:%
%:%712=216%:%
%:%713=216%:%
%:%714=217%:%
%:%715=217%:%
%:%716=218%:%
%:%717=218%:%
%:%718=219%:%
%:%719=219%:%
%:%720=219%:%
%:%721=220%:%
%:%722=220%:%
%:%723=220%:%
%:%724=221%:%
%:%725=221%:%
%:%726=222%:%
%:%732=222%:%
%:%735=223%:%
%:%736=224%:%
%:%737=224%:%
%:%738=225%:%
%:%739=226%:%
%:%740=227%:%
%:%743=228%:%
%:%747=228%:%
%:%748=228%:%
%:%749=229%:%
%:%750=229%:%
%:%751=230%:%
%:%752=230%:%
%:%753=231%:%
%:%754=231%:%
%:%755=232%:%
%:%756=232%:%
%:%757=233%:%
%:%758=233%:%
%:%759=234%:%
%:%760=234%:%
%:%761=235%:%
%:%762=235%:%
%:%763=236%:%
%:%764=236%:%
%:%765=237%:%
%:%766=237%:%
%:%767=237%:%
%:%768=238%:%
%:%769=238%:%
%:%770=239%:%
%:%771=239%:%
%:%772=239%:%
%:%773=240%:%
%:%774=240%:%
%:%775=241%:%
%:%776=241%:%
%:%777=241%:%
%:%778=241%:%
%:%779=242%:%
%:%780=242%:%
%:%781=242%:%
%:%782=243%:%
%:%783=243%:%
%:%784=244%:%
%:%785=244%:%
%:%786=244%:%
%:%787=245%:%
%:%788=245%:%
%:%789=246%:%
%:%790=246%:%
%:%791=246%:%
%:%792=247%:%
%:%793=247%:%
%:%794=248%:%
%:%800=248%:%
%:%803=249%:%
%:%804=250%:%
%:%805=250%:%
%:%806=251%:%
%:%813=252%:%
%:%814=252%:%
%:%815=253%:%
%:%816=253%:%
%:%817=254%:%
%:%818=254%:%
%:%819=254%:%
%:%820=255%:%
%:%821=255%:%
%:%822=256%:%
%:%823=256%:%
%:%824=256%:%
%:%825=257%:%
%:%826=257%:%
%:%827=257%:%
%:%828=258%:%
%:%829=259%:%
%:%830=259%:%
%:%831=260%:%
%:%832=260%:%
%:%833=261%:%
%:%834=261%:%
%:%835=262%:%
%:%836=262%:%
%:%837=263%:%
%:%838=263%:%
%:%839=264%:%
%:%840=264%:%
%:%841=265%:%
%:%842=265%:%
%:%843=266%:%
%:%844=267%:%
%:%845=267%:%
%:%846=268%:%
%:%847=268%:%
%:%848=268%:%
%:%849=269%:%
%:%850=270%:%
%:%851=270%:%
%:%852=271%:%
%:%853=271%:%
%:%854=272%:%
%:%855=273%:%
%:%856=273%:%
%:%857=274%:%
%:%858=274%:%
%:%859=275%:%
%:%860=276%:%
%:%861=276%:%
%:%862=277%:%
%:%863=277%:%
%:%864=278%:%
%:%865=278%:%
%:%866=279%:%
%:%867=279%:%
%:%868=280%:%
%:%869=280%:%
%:%870=280%:%
%:%871=281%:%
%:%872=281%:%
%:%873=281%:%
%:%874=282%:%
%:%875=282%:%
%:%876=282%:%
%:%877=283%:%
%:%878=283%:%
%:%879=284%:%
%:%880=284%:%
%:%881=284%:%
%:%882=285%:%
%:%883=285%:%
%:%884=285%:%
%:%885=286%:%
%:%886=286%:%
%:%887=286%:%
%:%888=287%:%
%:%889=287%:%
%:%890=288%:%
%:%891=288%:%
%:%892=288%:%
%:%893=289%:%
%:%894=289%:%
%:%895=289%:%
%:%896=290%:%
%:%897=290%:%
%:%898=291%:%
%:%899=291%:%
%:%900=291%:%
%:%901=292%:%
%:%902=292%:%
%:%903=293%:%
%:%904=293%:%
%:%905=293%:%
%:%906=294%:%
%:%907=294%:%
%:%908=295%:%
%:%909=295%:%
%:%910=295%:%
%:%911=296%:%
%:%912=296%:%
%:%913=297%:%
%:%914=297%:%
%:%915=298%:%
%:%916=298%:%
%:%917=299%:%
%:%918=299%:%
%:%919=300%:%
%:%920=300%:%
%:%921=300%:%
%:%922=301%:%
%:%923=301%:%
%:%924=302%:%
%:%934=304%:%
%:%935=305%:%
%:%937=306%:%
%:%938=306%:%
%:%939=307%:%
%:%940=308%:%
%:%941=309%:%
%:%942=310%:%
%:%945=311%:%
%:%949=311%:%
%:%950=311%:%
%:%951=312%:%
%:%952=312%:%
%:%953=313%:%
%:%954=313%:%
%:%955=314%:%
%:%956=314%:%
%:%957=315%:%
%:%958=315%:%
%:%959=316%:%
%:%960=316%:%
%:%961=317%:%
%:%962=317%:%
%:%963=318%:%
%:%964=319%:%
%:%965=319%:%
%:%966=320%:%
%:%967=320%:%
%:%968=321%:%
%:%969=321%:%
%:%970=322%:%
%:%971=322%:%
%:%972=322%:%
%:%973=323%:%
%:%974=323%:%
%:%975=324%:%
%:%976=324%:%
%:%977=324%:%
%:%978=325%:%
%:%979=325%:%
%:%980=326%:%
%:%981=326%:%
%:%982=326%:%
%:%983=327%:%
%:%984=327%:%
%:%985=328%:%
%:%986=328%:%
%:%987=328%:%
%:%988=329%:%
%:%989=329%:%
%:%990=330%:%
%:%991=330%:%
%:%992=331%:%
%:%993=331%:%
%:%994=332%:%
%:%995=332%:%
%:%996=333%:%
%:%997=334%:%
%:%998=334%:%
%:%999=334%:%
%:%1000=335%:%
%:%1001=335%:%
%:%1002=335%:%
%:%1003=336%:%
%:%1004=337%:%
%:%1005=337%:%
%:%1006=338%:%
%:%1007=338%:%
%:%1008=339%:%
%:%1009=339%:%
%:%1010=340%:%
%:%1011=340%:%
%:%1012=340%:%
%:%1013=341%:%
%:%1014=341%:%
%:%1015=341%:%
%:%1016=342%:%
%:%1017=342%:%
%:%1018=342%:%
%:%1019=343%:%
%:%1020=343%:%
%:%1021=343%:%
%:%1022=344%:%
%:%1023=344%:%
%:%1024=344%:%
%:%1025=345%:%
%:%1026=345%:%
%:%1027=345%:%
%:%1028=346%:%
%:%1029=346%:%
%:%1030=347%:%
%:%1031=347%:%
%:%1032=347%:%
%:%1033=348%:%
%:%1034=348%:%
%:%1035=348%:%
%:%1036=349%:%
%:%1037=349%:%
%:%1038=349%:%
%:%1039=350%:%
%:%1040=350%:%
%:%1041=351%:%
%:%1042=351%:%
%:%1043=351%:%
%:%1044=352%:%
%:%1045=352%:%
%:%1046=352%:%
%:%1047=353%:%
%:%1048=353%:%
%:%1049=353%:%
%:%1050=354%:%
%:%1051=354%:%
%:%1052=355%:%
%:%1053=355%:%
%:%1054=356%:%
%:%1055=356%:%
%:%1056=356%:%
%:%1057=357%:%
%:%1058=357%:%
%:%1059=357%:%
%:%1060=358%:%
%:%1061=358%:%
%:%1062=358%:%
%:%1063=359%:%
%:%1064=359%:%
%:%1065=360%:%
%:%1066=360%:%
%:%1067=360%:%
%:%1068=361%:%
%:%1069=361%:%
%:%1070=361%:%
%:%1071=362%:%
%:%1086=364%:%
%:%1090=366%:%
%:%1100=368%:%
%:%1101=368%:%
%:%1102=369%:%
%:%1103=370%:%
%:%1104=371%:%
%:%1105=371%:%
%:%1106=372%:%
%:%1107=373%:%
%:%1110=374%:%
%:%1114=374%:%
%:%1115=374%:%
%:%1116=374%:%
%:%1117=374%:%
%:%1122=374%:%
%:%1125=375%:%
%:%1126=376%:%
%:%1127=376%:%
%:%1128=377%:%
%:%1129=378%:%
%:%1132=379%:%
%:%1136=379%:%
%:%1137=379%:%
%:%1138=379%:%
%:%1143=379%:%
%:%1146=380%:%
%:%1147=381%:%
%:%1148=381%:%
%:%1149=382%:%
%:%1150=383%:%
%:%1151=384%:%
%:%1158=385%:%
%:%1159=385%:%
%:%1160=386%:%
%:%1161=386%:%
%:%1162=387%:%
%:%1163=387%:%
%:%1164=387%:%
%:%1165=388%:%
%:%1166=388%:%
%:%1167=388%:%
%:%1168=389%:%
%:%1169=389%:%
%:%1170=389%:%
%:%1171=390%:%
%:%1172=390%:%
%:%1173=390%:%
%:%1174=391%:%
%:%1175=391%:%
%:%1176=391%:%
%:%1177=392%:%
%:%1178=392%:%
%:%1179=392%:%
%:%1180=393%:%
%:%1181=393%:%
%:%1182=394%:%
%:%1183=394%:%
%:%1184=394%:%
%:%1185=395%:%
%:%1186=395%:%
%:%1187=396%:%
%:%1202=398%:%
%:%1212=400%:%
%:%1213=400%:%
%:%1214=401%:%
%:%1215=402%:%
%:%1216=403%:%
%:%1217=403%:%
%:%1218=404%:%
%:%1219=405%:%
%:%1222=406%:%
%:%1226=406%:%
%:%1227=406%:%
%:%1228=406%:%
%:%1229=407%:%
%:%1230=407%:%
%:%1235=407%:%
%:%1238=408%:%
%:%1239=409%:%
%:%1240=409%:%
%:%1241=410%:%
%:%1242=411%:%
%:%1245=412%:%
%:%1249=412%:%
%:%1250=412%:%
%:%1251=413%:%
%:%1252=413%:%
%:%1257=413%:%
%:%1260=414%:%
%:%1261=415%:%
%:%1262=415%:%
%:%1263=416%:%
%:%1264=417%:%
%:%1271=418%:%
%:%1272=418%:%
%:%1273=419%:%
%:%1274=419%:%
%:%1275=420%:%
%:%1276=420%:%
%:%1277=420%:%
%:%1278=421%:%
%:%1279=421%:%
%:%1280=422%:%
%:%1281=422%:%
%:%1282=422%:%
%:%1283=423%:%
%:%1284=423%:%
%:%1285=424%:%
%:%1286=424%:%
%:%1287=425%:%
%:%1288=425%:%
%:%1289=426%:%
%:%1290=426%:%
%:%1291=427%:%
%:%1292=428%:%
%:%1293=428%:%
%:%1294=429%:%
%:%1295=429%:%
%:%1296=429%:%
%:%1297=430%:%
%:%1298=430%:%
%:%1299=430%:%
%:%1300=431%:%
%:%1301=431%:%
%:%1302=432%:%
%:%1303=432%:%
%:%1304=432%:%
%:%1305=433%:%
%:%1306=433%:%
%:%1307=433%:%
%:%1308=434%:%
%:%1309=434%:%
%:%1310=434%:%
%:%1311=435%:%
%:%1312=435%:%
%:%1313=436%:%
%:%1314=436%:%
%:%1315=437%:%
%:%1321=437%:%
%:%1324=438%:%
%:%1325=439%:%
%:%1326=439%:%
%:%1327=440%:%
%:%1328=441%:%
%:%1335=442%:%
%:%1336=442%:%
%:%1337=443%:%
%:%1338=443%:%
%:%1339=444%:%
%:%1340=444%:%
%:%1341=444%:%
%:%1342=445%:%
%:%1343=445%:%
%:%1344=446%:%
%:%1345=446%:%
%:%1346=446%:%
%:%1347=447%:%
%:%1348=447%:%
%:%1349=448%:%
%:%1350=448%:%
%:%1351=449%:%
%:%1352=449%:%
%:%1353=450%:%
%:%1354=450%:%
%:%1355=450%:%
%:%1356=451%:%
%:%1357=451%:%
%:%1358=452%:%
%:%1359=452%:%
%:%1360=452%:%
%:%1361=453%:%
%:%1362=453%:%
%:%1363=454%:%
%:%1364=454%:%
%:%1365=455%:%
%:%1366=455%:%
%:%1367=456%:%
%:%1368=456%:%
%:%1369=456%:%
%:%1370=457%:%
%:%1371=457%:%
%:%1372=458%:%
%:%1373=458%:%
%:%1374=459%:%
%:%1375=460%:%
%:%1376=460%:%
%:%1377=460%:%
%:%1378=461%:%
%:%1379=461%:%
%:%1380=461%:%
%:%1381=462%:%
%:%1382=462%:%
%:%1383=462%:%
%:%1384=463%:%
%:%1385=463%:%
%:%1386=463%:%
%:%1387=464%:%
%:%1388=464%:%
%:%1389=464%:%
%:%1390=465%:%
%:%1391=465%:%
%:%1392=465%:%
%:%1393=466%:%
%:%1394=466%:%
%:%1395=467%:%
%:%1396=467%:%
%:%1397=467%:%
%:%1398=468%:%
%:%1399=468%:%
%:%1400=469%:%
%:%1401=469%:%
%:%1402=469%:%
%:%1403=470%:%
%:%1404=470%:%
%:%1405=471%:%
%:%1406=471%:%
%:%1407=471%:%
%:%1408=472%:%
%:%1409=472%:%
%:%1410=472%:%
%:%1411=473%:%
%:%1412=473%:%
%:%1413=473%:%
%:%1414=474%:%
%:%1415=474%:%
%:%1416=475%:%
%:%1417=475%:%
%:%1418=475%:%
%:%1419=476%:%
%:%1420=476%:%
%:%1421=476%:%
%:%1422=477%:%
%:%1423=477%:%
%:%1424=478%:%
%:%1439=480%:%
%:%1449=482%:%
%:%1450=482%:%
%:%1451=483%:%
%:%1452=484%:%
%:%1453=485%:%
%:%1454=485%:%
%:%1455=486%:%
%:%1458=487%:%
%:%1462=487%:%
%:%1463=487%:%
%:%1464=487%:%
%:%1469=487%:%
%:%1472=488%:%
%:%1473=489%:%
%:%1474=489%:%
%:%1475=490%:%
%:%1476=491%:%
%:%1477=492%:%
%:%1478=492%:%
%:%1479=493%:%
%:%1480=494%:%
%:%1481=495%:%
%:%1484=496%:%
%:%1488=496%:%
%:%1489=496%:%
%:%1490=496%:%
%:%1491=497%:%
%:%1492=497%:%
%:%1497=497%:%
%:%1500=498%:%
%:%1501=499%:%
%:%1502=499%:%
%:%1503=500%:%
%:%1504=501%:%
%:%1505=502%:%
%:%1512=503%:%
%:%1513=503%:%
%:%1514=504%:%
%:%1515=504%:%
%:%1516=505%:%
%:%1517=505%:%
%:%1518=505%:%
%:%1519=506%:%
%:%1520=506%:%
%:%1521=506%:%
%:%1522=507%:%
%:%1523=507%:%
%:%1524=507%:%
%:%1525=508%:%
%:%1531=508%:%
%:%1534=509%:%
%:%1535=510%:%
%:%1536=510%:%
%:%1537=511%:%
%:%1538=512%:%
%:%1539=513%:%
%:%1540=514%:%
%:%1547=515%:%
%:%1548=515%:%
%:%1549=516%:%
%:%1550=516%:%
%:%1551=517%:%
%:%1552=517%:%
%:%1553=517%:%
%:%1554=518%:%
%:%1555=518%:%
%:%1556=518%:%
%:%1557=519%:%
%:%1558=519%:%
%:%1559=519%:%
%:%1560=520%:%
%:%1561=520%:%
%:%1562=520%:%
%:%1563=521%:%
%:%1564=521%:%
%:%1565=521%:%
%:%1566=522%:%
%:%1567=522%:%
%:%1568=522%:%
%:%1569=523%:%
%:%1570=523%:%
%:%1571=523%:%
%:%1572=524%:%
%:%1573=524%:%
%:%1574=524%:%
%:%1575=525%:%
%:%1576=525%:%
%:%1577=525%:%
%:%1578=526%:%
%:%1579=526%:%
%:%1580=526%:%
%:%1581=527%:%
%:%1582=527%:%
%:%1583=527%:%
%:%1584=528%:%
%:%1585=528%:%
%:%1586=528%:%
%:%1587=529%:%
%:%1588=529%:%
%:%1589=529%:%
%:%1590=530%:%
%:%1591=530%:%
%:%1592=530%:%
%:%1593=531%:%
%:%1594=531%:%
%:%1595=532%:%
%:%1601=532%:%
%:%1604=533%:%
%:%1605=534%:%
%:%1606=534%:%
%:%1607=535%:%
%:%1608=536%:%
%:%1609=537%:%
%:%1612=538%:%
%:%1616=538%:%
%:%1617=538%:%
%:%1618=539%:%
%:%1619=539%:%
%:%1620=540%:%
%:%1621=540%:%
%:%1622=541%:%
%:%1623=541%:%
%:%1624=542%:%
%:%1625=542%:%
%:%1626=543%:%
%:%1627=543%:%
%:%1628=543%:%
%:%1629=544%:%
%:%1630=544%:%
%:%1631=545%:%
%:%1632=545%:%
%:%1633=545%:%
%:%1634=546%:%
%:%1635=546%:%
%:%1636=547%:%
%:%1637=547%:%
%:%1638=548%:%
%:%1639=548%:%
%:%1640=549%:%
%:%1641=549%:%
%:%1642=549%:%
%:%1643=550%:%
%:%1644=550%:%
%:%1645=551%:%
%:%1646=551%:%
%:%1647=551%:%
%:%1648=552%:%
%:%1649=552%:%
%:%1650=552%:%
%:%1651=553%:%
%:%1652=553%:%
%:%1653=553%:%
%:%1654=554%:%
%:%1655=554%:%
%:%1656=554%:%
%:%1657=555%:%
%:%1658=555%:%
%:%1659=555%:%
%:%1660=556%:%
%:%1661=556%:%
%:%1662=556%:%
%:%1663=557%:%
%:%1664=557%:%
%:%1665=557%:%
%:%1666=558%:%
%:%1667=558%:%
%:%1668=558%:%
%:%1669=559%:%
%:%1670=559%:%
%:%1671=559%:%
%:%1672=560%:%
%:%1673=560%:%
%:%1674=560%:%
%:%1675=561%:%
%:%1676=561%:%
%:%1677=561%:%
%:%1678=562%:%
%:%1679=562%:%
%:%1680=562%:%
%:%1681=563%:%
%:%1682=563%:%
%:%1683=563%:%
%:%1684=564%:%
%:%1685=564%:%
%:%1686=565%:%
%:%1687=565%:%
%:%1688=566%:%
%:%1689=566%:%
%:%1690=566%:%
%:%1691=567%:%
%:%1692=567%:%
%:%1693=567%:%
%:%1694=568%:%
%:%1700=568%:%
%:%1703=569%:%
%:%1704=570%:%
%:%1705=570%:%
%:%1706=571%:%
%:%1707=572%:%
%:%1708=573%:%
%:%1711=574%:%
%:%1715=574%:%
%:%1716=574%:%
%:%1717=575%:%
%:%1718=575%:%
%:%1719=576%:%
%:%1720=576%:%
%:%1721=577%:%
%:%1722=578%:%
%:%1723=578%:%
%:%1724=579%:%
%:%1725=579%:%
%:%1726=580%:%
%:%1727=580%:%
%:%1728=581%:%
%:%1729=581%:%
%:%1730=582%:%
%:%1731=582%:%
%:%1732=582%:%
%:%1733=583%:%
%:%1734=583%:%
%:%1735=584%:%
%:%1736=584%:%
%:%1737=585%:%
%:%1738=585%:%
%:%1739=586%:%
%:%1740=586%:%
%:%1741=586%:%
%:%1742=587%:%
%:%1743=587%:%
%:%1744=588%:%
%:%1745=588%:%
%:%1746=589%:%
%:%1747=590%:%
%:%1748=590%:%
%:%1749=591%:%
%:%1750=591%:%
%:%1751=591%:%
%:%1752=592%:%
%:%1753=592%:%
%:%1754=592%:%
%:%1755=593%:%
%:%1756=593%:%
%:%1757=593%:%
%:%1758=594%:%
%:%1759=594%:%
%:%1760=595%:%
%:%1761=595%:%
%:%1762=595%:%
%:%1763=596%:%
%:%1764=596%:%
%:%1765=597%:%
%:%1766=597%:%
%:%1767=597%:%
%:%1768=598%:%
%:%1769=598%:%
%:%1770=599%:%
%:%1771=599%:%
%:%1772=599%:%
%:%1773=600%:%
%:%1774=600%:%
%:%1775=601%:%
%:%1776=601%:%
%:%1777=601%:%
%:%1778=602%:%
%:%1779=602%:%
%:%1780=603%:%
%:%1781=603%:%
%:%1782=603%:%
%:%1783=604%:%
%:%1784=604%:%
%:%1785=605%:%
%:%1786=605%:%
%:%1787=605%:%
%:%1788=606%:%
%:%1789=606%:%
%:%1790=606%:%
%:%1791=607%:%
%:%1792=607%:%
%:%1793=607%:%
%:%1794=608%:%
%:%1795=608%:%
%:%1796=608%:%
%:%1797=609%:%
%:%1798=609%:%
%:%1799=609%:%
%:%1800=610%:%
%:%1801=610%:%
%:%1802=610%:%
%:%1803=611%:%
%:%1804=611%:%
%:%1805=611%:%
%:%1806=612%:%
%:%1807=612%:%
%:%1808=612%:%
%:%1809=613%:%
%:%1810=613%:%
%:%1811=613%:%
%:%1812=614%:%
%:%1813=614%:%
%:%1814=614%:%
%:%1815=615%:%
%:%1816=615%:%
%:%1817=615%:%
%:%1818=616%:%
%:%1819=616%:%
%:%1820=616%:%
%:%1821=617%:%
%:%1822=617%:%
%:%1823=617%:%
%:%1824=618%:%
%:%1825=618%:%
%:%1826=618%:%
%:%1827=619%:%
%:%1828=619%:%
%:%1829=619%:%
%:%1830=620%:%
%:%1831=620%:%
%:%1832=621%:%
%:%1833=621%:%
%:%1834=621%:%
%:%1835=622%:%
%:%1836=623%:%
%:%1837=623%:%
%:%1838=623%:%
%:%1839=624%:%
%:%1840=624%:%
%:%1841=625%:%
%:%1842=625%:%
%:%1843=625%:%
%:%1845=627%:%
%:%1846=628%:%
%:%1847=628%:%
%:%1848=628%:%
%:%1849=629%:%
%:%1850=629%:%
%:%1851=629%:%
%:%1852=630%:%
%:%1853=631%:%
%:%1854=631%:%
%:%1855=631%:%
%:%1856=632%:%
%:%1862=632%:%
%:%1865=633%:%
%:%1866=634%:%
%:%1867=634%:%
%:%1868=635%:%
%:%1869=636%:%
%:%1870=637%:%
%:%1871=638%:%
%:%1878=639%:%
%:%1879=639%:%
%:%1880=640%:%
%:%1881=640%:%
%:%1882=641%:%
%:%1883=641%:%
%:%1884=641%:%
%:%1885=642%:%
%:%1886=642%:%
%:%1887=642%:%
%:%1888=643%:%
%:%1889=643%:%
%:%1890=643%:%
%:%1891=644%:%
%:%1892=644%:%
%:%1893=644%:%
%:%1894=645%:%
%:%1895=645%:%
%:%1896=645%:%
%:%1897=646%:%
%:%1898=646%:%
%:%1899=646%:%
%:%1900=647%:%
%:%1901=647%:%
%:%1902=648%:%
%:%1903=648%:%
%:%1904=649%:%
%:%1905=650%:%
%:%1906=650%:%
%:%1907=651%:%
%:%1908=651%:%
%:%1909=652%:%
%:%1910=653%:%
%:%1911=653%:%
%:%1912=653%:%
%:%1913=654%:%
%:%1914=654%:%
%:%1915=654%:%
%:%1916=655%:%
%:%1917=655%:%
%:%1918=655%:%
%:%1919=656%:%
%:%1920=656%:%
%:%1921=656%:%
%:%1922=657%:%
%:%1923=657%:%
%:%1924=657%:%
%:%1925=658%:%
%:%1926=658%:%
%:%1927=658%:%
%:%1928=659%:%
%:%1929=659%:%
%:%1930=659%:%
%:%1931=660%:%
%:%1932=660%:%
%:%1933=661%:%
%:%1934=661%:%
%:%1935=661%:%
%:%1936=662%:%
%:%1937=662%:%
%:%1938=662%:%
%:%1939=663%:%
%:%1940=664%:%
%:%1941=664%:%
%:%1942=665%:%
%:%1943=665%:%
%:%1944=665%:%
%:%1945=666%:%
%:%1946=666%:%
%:%1947=666%:%
%:%1948=667%:%
%:%1949=667%:%
%:%1950=667%:%
%:%1951=668%:%
%:%1952=668%:%
%:%1953=668%:%
%:%1954=669%:%
%:%1955=669%:%
%:%1956=669%:%
%:%1957=670%:%
%:%1958=670%:%
%:%1959=670%:%
%:%1960=671%:%
%:%1961=671%:%
%:%1962=671%:%
%:%1963=672%:%
%:%1964=672%:%
%:%1965=672%:%
%:%1966=673%:%
%:%1967=673%:%
%:%1968=673%:%
%:%1969=674%:%
%:%1970=674%:%
%:%1971=674%:%
%:%1972=675%:%
%:%1973=675%:%
%:%1974=675%:%
%:%1975=676%:%
%:%1976=676%:%
%:%1977=676%:%
%:%1978=677%:%
%:%1979=677%:%
%:%1980=677%:%
%:%1981=678%:%
%:%1982=678%:%
%:%1983=679%:%
%:%1989=679%:%
%:%1992=680%:%
%:%1993=681%:%
%:%1994=681%:%
%:%1995=682%:%
%:%1996=683%:%
%:%1997=684%:%
%:%2004=685%:%
%:%2005=685%:%
%:%2006=686%:%
%:%2007=686%:%
%:%2008=687%:%
%:%2009=687%:%
%:%2010=687%:%
%:%2011=688%:%
%:%2012=688%:%
%:%2013=689%:%
%:%2014=689%:%
%:%2015=689%:%
%:%2016=690%:%
%:%2017=690%:%
%:%2018=691%:%
%:%2019=691%:%
%:%2020=692%:%
%:%2021=692%:%
%:%2022=693%:%
%:%2023=693%:%
%:%2024=694%:%
%:%2025=694%:%
%:%2026=694%:%
%:%2027=695%:%
%:%2028=695%:%
%:%2029=695%:%
%:%2030=696%:%
%:%2031=696%:%
%:%2032=696%:%
%:%2033=697%:%
%:%2034=697%:%
%:%2035=697%:%
%:%2036=698%:%
%:%2037=698%:%
%:%2038=698%:%
%:%2039=699%:%
%:%2040=699%:%
%:%2041=699%:%
%:%2042=700%:%
%:%2043=700%:%
%:%2044=700%:%
%:%2045=701%:%
%:%2046=701%:%
%:%2047=701%:%
%:%2048=702%:%
%:%2049=702%:%
%:%2050=703%:%
%:%2056=703%:%
%:%2059=704%:%
%:%2060=705%:%
%:%2061=705%:%
%:%2062=706%:%
%:%2063=707%:%
%:%2066=708%:%
%:%2070=708%:%
%:%2071=708%:%
%:%2072=708%:%
%:%2077=708%:%
%:%2080=709%:%
%:%2081=710%:%
%:%2082=710%:%
%:%2083=711%:%
%:%2084=712%:%
%:%2087=713%:%
%:%2091=713%:%
%:%2092=713%:%
%:%2093=713%:%
%:%2098=713%:%
%:%2101=714%:%
%:%2102=715%:%
%:%2103=715%:%
%:%2104=716%:%
%:%2105=717%:%
%:%2106=718%:%
%:%2109=719%:%
%:%2113=719%:%
%:%2114=719%:%
%:%2115=719%:%
%:%2120=719%:%
%:%2123=720%:%
%:%2124=721%:%
%:%2125=721%:%
%:%2126=722%:%
%:%2127=723%:%
%:%2128=724%:%
%:%2131=725%:%
%:%2135=725%:%
%:%2136=725%:%
%:%2137=725%:%
%:%2142=725%:%
%:%2145=726%:%
%:%2146=727%:%
%:%2147=727%:%
%:%2148=728%:%
%:%2149=729%:%
%:%2150=730%:%
%:%2151=731%:%
%:%2158=732%:%
%:%2159=732%:%
%:%2160=733%:%
%:%2161=733%:%
%:%2162=734%:%
%:%2163=734%:%
%:%2164=734%:%
%:%2165=735%:%
%:%2166=735%:%
%:%2167=735%:%
%:%2168=736%:%
%:%2169=736%:%
%:%2170=736%:%
%:%2171=737%:%
%:%2172=737%:%
%:%2173=737%:%
%:%2174=738%:%
%:%2175=738%:%
%:%2176=738%:%
%:%2177=739%:%
%:%2178=739%:%
%:%2179=739%:%
%:%2180=740%:%
%:%2181=740%:%
%:%2182=740%:%
%:%2183=741%:%
%:%2184=741%:%
%:%2185=741%:%
%:%2186=742%:%
%:%2187=742%:%
%:%2188=742%:%
%:%2189=743%:%
%:%2190=743%:%
%:%2191=743%:%
%:%2192=744%:%
%:%2193=744%:%
%:%2194=744%:%
%:%2195=745%:%
%:%2196=745%:%
%:%2197=745%:%
%:%2198=746%:%
%:%2199=746%:%
%:%2200=746%:%
%:%2201=747%:%
%:%2202=747%:%
%:%2203=747%:%
%:%2204=748%:%
%:%2205=748%:%
%:%2206=749%:%
%:%2221=751%:%
%:%2231=753%:%
%:%2232=753%:%
%:%2233=754%:%
%:%2234=755%:%
%:%2235=756%:%
%:%2236=756%:%
%:%2237=757%:%
%:%2238=758%:%
%:%2245=759%:%
%:%2246=759%:%
%:%2247=760%:%
%:%2248=760%:%
%:%2249=761%:%
%:%2250=761%:%
%:%2251=761%:%
%:%2252=762%:%
%:%2253=762%:%
%:%2254=762%:%
%:%2255=763%:%
%:%2256=763%:%
%:%2257=764%:%
%:%2263=764%:%
%:%2266=765%:%
%:%2267=766%:%
%:%2268=766%:%
%:%2269=767%:%
%:%2270=768%:%
%:%2271=769%:%
%:%2274=770%:%
%:%2278=770%:%
%:%2279=770%:%
%:%2280=770%:%
%:%2285=770%:%
%:%2288=771%:%
%:%2289=772%:%
%:%2290=772%:%
%:%2291=773%:%
%:%2292=774%:%
%:%2293=775%:%
%:%2294=776%:%
%:%2301=777%:%
%:%2302=777%:%
%:%2303=778%:%
%:%2304=778%:%
%:%2305=779%:%
%:%2306=779%:%
%:%2307=779%:%
%:%2308=780%:%
%:%2309=780%:%
%:%2310=780%:%
%:%2311=781%:%
%:%2312=781%:%
%:%2313=781%:%
%:%2314=782%:%
%:%2315=782%:%
%:%2316=782%:%
%:%2317=783%:%
%:%2318=783%:%
%:%2319=784%:%
%:%2325=784%:%
%:%2328=785%:%
%:%2329=786%:%
%:%2330=786%:%
%:%2331=787%:%
%:%2332=788%:%
%:%2333=789%:%
%:%2334=789%:%
%:%2335=790%:%
%:%2336=791%:%
%:%2343=792%:%
%:%2344=792%:%
%:%2345=793%:%
%:%2346=793%:%
%:%2347=794%:%
%:%2348=794%:%
%:%2349=794%:%
%:%2350=795%:%
%:%2351=795%:%
%:%2352=795%:%
%:%2353=796%:%
%:%2354=796%:%
%:%2355=797%:%
%:%2361=797%:%
%:%2364=798%:%
%:%2365=799%:%
%:%2366=799%:%
%:%2367=800%:%
%:%2368=801%:%
%:%2369=802%:%
%:%2372=803%:%
%:%2376=803%:%
%:%2377=803%:%
%:%2378=803%:%
%:%2383=803%:%
%:%2386=804%:%
%:%2387=805%:%
%:%2388=805%:%
%:%2389=806%:%
%:%2390=807%:%
%:%2391=808%:%
%:%2392=809%:%
%:%2399=810%:%
%:%2400=810%:%
%:%2401=811%:%
%:%2402=811%:%
%:%2403=812%:%
%:%2404=812%:%
%:%2405=812%:%
%:%2406=813%:%
%:%2407=813%:%
%:%2408=813%:%
%:%2409=814%:%
%:%2410=814%:%
%:%2411=814%:%
%:%2412=815%:%
%:%2413=815%:%
%:%2414=815%:%
%:%2415=816%:%
%:%2416=816%:%
%:%2417=817%:%
%:%2432=819%:%
%:%2444=821%:%
%:%2446=822%:%
%:%2447=822%:%
%:%2448=823%:%
%:%2455=824%:%
%:%2456=824%:%
%:%2457=825%:%
%:%2458=825%:%
%:%2459=826%:%
%:%2460=826%:%
%:%2461=826%:%
%:%2462=827%:%
%:%2463=827%:%
%:%2464=828%:%
%:%2465=828%:%
%:%2466=828%:%
%:%2467=829%:%
%:%2468=829%:%
%:%2470=831%:%
%:%2471=832%:%
%:%2472=832%:%
%:%2473=833%:%
%:%2474=833%:%
%:%2475=833%:%
%:%2476=834%:%
%:%2477=834%:%
%:%2478=835%:%
%:%2479=836%:%
%:%2480=836%:%
%:%2481=837%:%
%:%2482=837%:%
%:%2483=838%:%
%:%2484=839%:%
%:%2485=839%:%
%:%2486=840%:%
%:%2487=840%:%
%:%2488=841%:%
%:%2489=841%:%
%:%2490=842%:%
%:%2491=842%:%
%:%2492=843%:%
%:%2493=843%:%
%:%2494=844%:%
%:%2495=844%:%
%:%2496=844%:%
%:%2497=845%:%
%:%2498=845%:%
%:%2499=845%:%
%:%2500=846%:%
%:%2501=847%:%
%:%2502=847%:%
%:%2503=848%:%
%:%2504=848%:%
%:%2505=848%:%
%:%2506=849%:%
%:%2507=850%:%
%:%2508=850%:%
%:%2509=851%:%
%:%2510=851%:%
%:%2511=851%:%
%:%2512=852%:%
%:%2513=852%:%
%:%2514=852%:%
%:%2515=853%:%
%:%2516=853%:%
%:%2517=853%:%
%:%2518=854%:%
%:%2519=854%:%
%:%2520=855%:%
%:%2521=855%:%
%:%2522=856%:%
%:%2523=857%:%
%:%2524=857%:%
%:%2525=858%:%
%:%2526=858%:%
%:%2527=858%:%
%:%2528=859%:%
%:%2529=859%:%
%:%2530=859%:%
%:%2531=860%:%
%:%2532=860%:%
%:%2533=860%:%
%:%2534=861%:%
%:%2544=863%:%
%:%2546=864%:%
%:%2547=864%:%
%:%2548=865%:%
%:%2555=866%:%
%:%2556=866%:%
%:%2557=867%:%
%:%2558=867%:%
%:%2559=868%:%
%:%2560=868%:%
%:%2561=868%:%
%:%2562=869%:%
%:%2563=869%:%
%:%2564=870%:%
%:%2565=870%:%
%:%2566=871%:%
%:%2567=871%:%
%:%2568=872%:%
%:%2569=872%:%
%:%2570=873%:%
%:%2571=873%:%
%:%2572=874%:%
%:%2573=874%:%
%:%2574=874%:%
%:%2575=875%:%
%:%2576=875%:%
%:%2577=876%:%
%:%2578=877%:%
%:%2579=877%:%
%:%2580=877%:%
%:%2581=878%:%
%:%2582=878%:%
%:%2583=878%:%
%:%2584=879%:%
%:%2585=879%:%
%:%2586=880%:%
%:%2587=880%:%
%:%2588=880%:%
%:%2589=881%:%
%:%2590=881%:%
%:%2591=881%:%
%:%2592=882%:%
%:%2593=882%:%
%:%2594=883%:%
%:%2595=883%:%
%:%2596=883%:%
%:%2597=884%:%
%:%2598=884%:%
%:%2599=885%:%
%:%2600=885%:%
%:%2601=885%:%
%:%2602=886%:%
%:%2603=886%:%
%:%2604=886%:%
%:%2605=887%:%
%:%2611=887%:%
%:%2614=888%:%
%:%2615=889%:%
%:%2616=889%:%
%:%2617=890%:%
%:%2624=891%:%
%:%2625=891%:%
%:%2626=892%:%
%:%2627=892%:%
%:%2628=893%:%
%:%2629=893%:%
%:%2630=893%:%
%:%2631=894%:%
%:%2632=894%:%
%:%2633=895%:%
%:%2634=895%:%
%:%2635=896%:%
%:%2636=896%:%
%:%2637=897%:%
%:%2638=897%:%
%:%2639=898%:%
%:%2640=898%:%
%:%2641=899%:%
%:%2642=899%:%
%:%2643=899%:%
%:%2644=900%:%
%:%2645=900%:%
%:%2646=900%:%
%:%2647=901%:%
%:%2648=901%:%
%:%2649=902%:%
%:%2650=902%:%
%:%2651=903%:%
%:%2652=903%:%
%:%2653=903%:%
%:%2654=904%:%
%:%2664=906%:%
%:%2666=907%:%
%:%2667=907%:%
%:%2668=908%:%
%:%2675=909%:%
%:%2676=909%:%
%:%2677=910%:%
%:%2678=910%:%
%:%2679=911%:%
%:%2680=911%:%
%:%2681=912%:%
%:%2682=912%:%
%:%2683=913%:%
%:%2684=913%:%
%:%2685=914%:%
%:%2686=914%:%
%:%2687=915%:%
%:%2688=915%:%
%:%2689=916%:%
%:%2690=916%:%
%:%2691=917%:%
%:%2692=917%:%
%:%2693=918%:%
%:%2694=918%:%
%:%2695=919%:%
%:%2696=919%:%
%:%2697=920%:%
%:%2698=920%:%
%:%2699=921%:%
%:%2700=921%:%
%:%2701=922%:%
%:%2702=923%:%
%:%2703=923%:%
%:%2707=927%:%
%:%2708=928%:%
%:%2709=928%:%
%:%2710=929%:%
%:%2711=929%:%
%:%2712=930%:%
%:%2713=930%:%
%:%2714=931%:%
%:%2715=931%:%
%:%2716=932%:%
%:%2717=932%:%
%:%2718=933%:%
%:%2719=933%:%
%:%2720=933%:%
%:%2721=934%:%
%:%2722=934%:%
%:%2723=935%:%
%:%2724=935%:%
%:%2725=935%:%
%:%2726=936%:%
%:%2727=936%:%
%:%2728=937%:%
%:%2729=937%:%
%:%2730=937%:%
%:%2731=938%:%
%:%2732=938%:%
%:%2733=939%:%
%:%2734=939%:%
%:%2735=940%:%
%:%2736=940%:%
%:%2737=941%:%
%:%2738=941%:%
%:%2741=944%:%
%:%2742=945%:%
%:%2743=945%:%
%:%2744=946%:%
%:%2745=946%:%
%:%2746=947%:%
%:%2747=947%:%
%:%2748=948%:%
%:%2749=948%:%
%:%2750=949%:%
%:%2751=949%:%
%:%2752=950%:%
%:%2753=951%:%
%:%2754=951%:%
%:%2755=952%:%
%:%2756=952%:%
%:%2757=953%:%
%:%2758=953%:%
%:%2759=953%:%
%:%2760=954%:%
%:%2761=954%:%
%:%2762=955%:%
%:%2763=955%:%
%:%2764=956%:%
%:%2765=956%:%
%:%2766=957%:%
%:%2767=957%:%
%:%2768=957%:%
%:%2769=958%:%
%:%2770=958%:%
%:%2771=958%:%
%:%2772=959%:%
%:%2773=959%:%
%:%2774=960%:%
%:%2775=960%:%
%:%2776=961%:%
%:%2777=961%:%
%:%2778=962%:%
%:%2779=962%:%
%:%2780=963%:%
%:%2781=963%:%
%:%2782=964%:%
%:%2783=964%:%
%:%2784=965%:%
%:%2785=965%:%
%:%2786=965%:%
%:%2787=966%:%
%:%2788=966%:%
%:%2789=966%:%
%:%2790=967%:%
%:%2791=967%:%
%:%2792=967%:%
%:%2793=968%:%
%:%2794=968%:%
%:%2795=969%:%
%:%2796=969%:%
%:%2797=969%:%
%:%2798=970%:%
%:%2799=970%:%
%:%2800=971%:%
%:%2801=971%:%
%:%2802=971%:%
%:%2803=972%:%
%:%2804=972%:%
%:%2805=972%:%
%:%2806=973%:%
%:%2807=973%:%
%:%2808=974%:%
%:%2809=974%:%
%:%2810=975%:%
%:%2811=975%:%
%:%2812=976%:%
%:%2813=976%:%
%:%2814=976%:%
%:%2815=977%:%
%:%2816=977%:%
%:%2817=977%:%
%:%2818=978%:%
%:%2824=978%:%
%:%2827=979%:%
%:%2828=980%:%
%:%2829=980%:%
%:%2830=981%:%
%:%2837=982%:%
%:%2838=982%:%
%:%2839=983%:%
%:%2840=983%:%
%:%2841=984%:%
%:%2842=984%:%
%:%2843=985%:%
%:%2844=985%:%
%:%2845=986%:%
%:%2846=986%:%
%:%2847=987%:%
%:%2848=987%:%
%:%2849=988%:%
%:%2850=988%:%
%:%2851=989%:%
%:%2852=989%:%
%:%2853=990%:%
%:%2854=990%:%
%:%2855=991%:%
%:%2856=991%:%
%:%2857=992%:%
%:%2858=992%:%
%:%2859=993%:%
%:%2860=993%:%
%:%2861=994%:%
%:%2862=994%:%
%:%2868=1000%:%
%:%2869=1001%:%
%:%2870=1001%:%
%:%2871=1002%:%
%:%2872=1002%:%
%:%2873=1003%:%
%:%2874=1003%:%
%:%2875=1004%:%
%:%2876=1004%:%
%:%2877=1005%:%
%:%2878=1005%:%
%:%2879=1006%:%
%:%2880=1007%:%
%:%2881=1007%:%
%:%2882=1007%:%
%:%2883=1008%:%
%:%2884=1008%:%
%:%2885=1008%:%
%:%2886=1009%:%
%:%2887=1009%:%
%:%2888=1010%:%
%:%2889=1010%:%
%:%2890=1010%:%
%:%2891=1011%:%
%:%2892=1011%:%
%:%2893=1012%:%
%:%2894=1012%:%
%:%2895=1012%:%
%:%2896=1013%:%
%:%2897=1013%:%
%:%2898=1013%:%
%:%2899=1014%:%
%:%2900=1014%:%
%:%2901=1014%:%
%:%2902=1015%:%
%:%2903=1015%:%
%:%2904=1016%:%
%:%2905=1016%:%
%:%2906=1016%:%
%:%2907=1017%:%
%:%2908=1017%:%
%:%2909=1018%:%
%:%2910=1018%:%
%:%2911=1018%:%
%:%2912=1019%:%
%:%2913=1019%:%
%:%2914=1020%:%
%:%2915=1020%:%
%:%2916=1021%:%
%:%2917=1021%:%
%:%2918=1022%:%
%:%2919=1023%:%
%:%2920=1023%:%
%:%2921=1023%:%
%:%2922=1024%:%
%:%2923=1024%:%
%:%2924=1024%:%
%:%2925=1025%:%
%:%2926=1025%:%
%:%2927=1026%:%
%:%2928=1026%:%
%:%2929=1026%:%
%:%2930=1027%:%
%:%2931=1027%:%
%:%2932=1028%:%
%:%2933=1028%:%
%:%2934=1028%:%
%:%2935=1029%:%
%:%2936=1029%:%
%:%2937=1029%:%
%:%2938=1030%:%
%:%2939=1030%:%
%:%2940=1030%:%
%:%2941=1031%:%
%:%2942=1031%:%
%:%2943=1032%:%
%:%2944=1032%:%
%:%2945=1032%:%
%:%2946=1033%:%
%:%2947=1033%:%
%:%2948=1034%:%
%:%2949=1034%:%
%:%2950=1034%:%
%:%2951=1035%:%
%:%2952=1035%:%
%:%2953=1036%:%
%:%2954=1036%:%
%:%2955=1037%:%
%:%2956=1037%:%
%:%2957=1038%:%
%:%2958=1038%:%
%:%2959=1039%:%
%:%2960=1039%:%
%:%2961=1040%:%
%:%2962=1040%:%
%:%2963=1041%:%
%:%2964=1041%:%
%:%2965=1042%:%
%:%2966=1042%:%
%:%2967=1043%:%
%:%2968=1043%:%
%:%2969=1044%:%
%:%2970=1044%:%
%:%2971=1045%:%
%:%2972=1045%:%
%:%2973=1046%:%
%:%2974=1046%:%
%:%2975=1047%:%
%:%2976=1047%:%
%:%2977=1048%:%
%:%2978=1048%:%
%:%2979=1049%:%
%:%2980=1049%:%
%:%2981=1050%:%
%:%2982=1050%:%
%:%2983=1051%:%
%:%2984=1051%:%
%:%2985=1051%:%
%:%2986=1052%:%
%:%2987=1053%:%
%:%2988=1053%:%
%:%2989=1053%:%
%:%2990=1054%:%
%:%2991=1054%:%
%:%2992=1055%:%
%:%2993=1055%:%
%:%2994=1056%:%
%:%2995=1056%:%
%:%2996=1057%:%
%:%2997=1057%:%
%:%2998=1057%:%
%:%2999=1058%:%
%:%3000=1058%:%
%:%3001=1059%:%
%:%3002=1059%:%
%:%3003=1060%:%
%:%3004=1060%:%
%:%3005=1061%:%
%:%3006=1061%:%
%:%3007=1061%:%
%:%3008=1062%:%
%:%3009=1062%:%
%:%3010=1062%:%
%:%3011=1063%:%
%:%3012=1063%:%
%:%3013=1063%:%
%:%3014=1064%:%
%:%3015=1064%:%
%:%3016=1064%:%
%:%3017=1065%:%
%:%3018=1065%:%
%:%3019=1065%:%
%:%3020=1066%:%
%:%3021=1066%:%
%:%3022=1067%:%
%:%3023=1067%:%
%:%3024=1067%:%
%:%3025=1068%:%
%:%3026=1068%:%
%:%3027=1068%:%
%:%3028=1069%:%
%:%3029=1069%:%
%:%3030=1069%:%
%:%3031=1070%:%
%:%3032=1070%:%
%:%3033=1070%:%
%:%3034=1071%:%
%:%3035=1071%:%
%:%3036=1071%:%
%:%3037=1072%:%
%:%3038=1072%:%
%:%3039=1073%:%
%:%3040=1073%:%
%:%3041=1073%:%
%:%3042=1074%:%
%:%3043=1074%:%
%:%3044=1075%:%
%:%3045=1075%:%
%:%3046=1075%:%
%:%3047=1076%:%
%:%3048=1076%:%
%:%3049=1077%:%
%:%3050=1077%:%
%:%3051=1077%:%
%:%3052=1078%:%
%:%3053=1078%:%
%:%3054=1079%:%
%:%3055=1079%:%
%:%3056=1079%:%
%:%3057=1080%:%
%:%3058=1080%:%
%:%3059=1081%:%
%:%3060=1081%:%
%:%3061=1081%:%
%:%3062=1082%:%
%:%3063=1082%:%
%:%3064=1083%:%
%:%3065=1083%:%
%:%3066=1084%:%
%:%3067=1084%:%
%:%3068=1085%:%
%:%3069=1085%:%
%:%3070=1085%:%
%:%3071=1086%:%
%:%3072=1086%:%
%:%3073=1086%:%
%:%3074=1087%:%
%:%3075=1087%:%
%:%3076=1088%:%
%:%3077=1088%:%
%:%3078=1089%:%
%:%3079=1089%:%
%:%3080=1089%:%
%:%3081=1090%:%
%:%3082=1090%:%
%:%3083=1090%:%
%:%3084=1091%:%
%:%3085=1091%:%
%:%3086=1091%:%
%:%3087=1092%:%
%:%3088=1092%:%
%:%3089=1092%:%
%:%3090=1093%:%
%:%3091=1093%:%
%:%3092=1093%:%
%:%3093=1094%:%
%:%3094=1094%:%
%:%3095=1095%:%
%:%3096=1095%:%
%:%3097=1095%:%
%:%3098=1096%:%
%:%3099=1096%:%
%:%3100=1096%:%
%:%3101=1097%:%
%:%3102=1097%:%
%:%3103=1097%:%
%:%3104=1098%:%
%:%3105=1098%:%
%:%3106=1098%:%
%:%3107=1099%:%
%:%3108=1099%:%
%:%3109=1099%:%
%:%3110=1100%:%
%:%3111=1100%:%
%:%3112=1101%:%
%:%3113=1101%:%
%:%3114=1101%:%
%:%3115=1102%:%
%:%3116=1102%:%
%:%3117=1103%:%
%:%3118=1103%:%
%:%3119=1103%:%
%:%3120=1104%:%
%:%3121=1104%:%
%:%3122=1105%:%
%:%3123=1105%:%
%:%3124=1105%:%
%:%3125=1106%:%
%:%3126=1106%:%
%:%3127=1107%:%
%:%3128=1107%:%
%:%3129=1107%:%
%:%3130=1108%:%
%:%3131=1108%:%
%:%3132=1109%:%
%:%3133=1109%:%
%:%3134=1109%:%
%:%3135=1110%:%
%:%3136=1110%:%
%:%3137=1111%:%
%:%3138=1111%:%
%:%3139=1112%:%
%:%3140=1112%:%
%:%3141=1113%:%
%:%3142=1113%:%
%:%3143=1114%:%
%:%3144=1114%:%
%:%3145=1114%:%
%:%3147=1116%:%
%:%3148=1117%:%
%:%3149=1117%:%
%:%3150=1117%:%
%:%3151=1118%:%
%:%3152=1118%:%
%:%3153=1119%:%
%:%3154=1119%:%
%:%3155=1120%:%
%:%3156=1120%:%
%:%3157=1120%:%
%:%3158=1121%:%
%:%3159=1121%:%
%:%3160=1122%:%
%:%3166=1122%:%
%:%3169=1123%:%
%:%3170=1124%:%
%:%3171=1124%:%
%:%3172=1125%:%
%:%3173=1126%:%
%:%3180=1127%:%
%:%3181=1127%:%
%:%3182=1128%:%
%:%3183=1128%:%
%:%3184=1129%:%
%:%3185=1129%:%
%:%3186=1129%:%
%:%3187=1130%:%
%:%3188=1130%:%
%:%3189=1131%:%
%:%3190=1131%:%
%:%3191=1131%:%
%:%3192=1132%:%
%:%3193=1132%:%
%:%3194=1133%:%
%:%3195=1133%:%
%:%3196=1133%:%
%:%3197=1134%:%
%:%3198=1134%:%
%:%3199=1135%:%
%:%3200=1135%:%
%:%3201=1136%:%
%:%3202=1136%:%
%:%3203=1137%:%
%:%3204=1137%:%
%:%3205=1137%:%
%:%3206=1138%:%
%:%3212=1138%:%
%:%3215=1139%:%
%:%3216=1140%:%
%:%3217=1140%:%
%:%3218=1141%:%
%:%3219=1142%:%
%:%3226=1143%:%
%:%3227=1143%:%
%:%3228=1144%:%
%:%3229=1144%:%
%:%3230=1145%:%
%:%3231=1145%:%
%:%3232=1145%:%
%:%3233=1146%:%
%:%3234=1146%:%
%:%3235=1147%:%
%:%3236=1147%:%
%:%3237=1147%:%
%:%3238=1148%:%
%:%3239=1148%:%
%:%3240=1149%:%
%:%3241=1149%:%
%:%3242=1150%:%
%:%3243=1150%:%
%:%3244=1151%:%
%:%3245=1151%:%
%:%3246=1151%:%
%:%3247=1152%:%
%:%3248=1152%:%
%:%3249=1153%:%
%:%3250=1153%:%
%:%3251=1153%:%
%:%3252=1154%:%
%:%3253=1155%:%
%:%3254=1155%:%
%:%3255=1156%:%
%:%3256=1156%:%
%:%3257=1157%:%
%:%3258=1157%:%
%:%3259=1158%:%
%:%3260=1159%:%
%:%3261=1159%:%
%:%3262=1159%:%
%:%3263=1160%:%
%:%3264=1160%:%
%:%3265=1160%:%
%:%3266=1161%:%
%:%3267=1161%:%
%:%3268=1162%:%
%:%3269=1162%:%
%:%3270=1162%:%
%:%3271=1163%:%
%:%3272=1163%:%
%:%3273=1164%:%
%:%3274=1164%:%
%:%3275=1164%:%
%:%3276=1165%:%
%:%3277=1165%:%
%:%3278=1165%:%
%:%3279=1166%:%
%:%3280=1166%:%
%:%3281=1166%:%
%:%3282=1167%:%
%:%3283=1167%:%
%:%3284=1167%:%
%:%3285=1168%:%
%:%3286=1168%:%
%:%3287=1168%:%
%:%3288=1169%:%
%:%3289=1169%:%
%:%3290=1170%:%
%:%3291=1170%:%
%:%3292=1170%:%
%:%3293=1171%:%
%:%3294=1171%:%
%:%3295=1172%:%
%:%3296=1172%:%
%:%3297=1172%:%
%:%3298=1173%:%
%:%3299=1173%:%
%:%3300=1174%:%
%:%3301=1174%:%
%:%3302=1174%:%
%:%3303=1175%:%
%:%3304=1175%:%
%:%3305=1176%:%
%:%3306=1176%:%
%:%3307=1177%:%
%:%3308=1177%:%
%:%3309=1178%:%
%:%3310=1178%:%
%:%3311=1179%:%
%:%3312=1179%:%
%:%3313=1180%:%
%:%3314=1181%:%
%:%3315=1181%:%
%:%3316=1181%:%
%:%3317=1182%:%
%:%3318=1182%:%
%:%3319=1182%:%
%:%3320=1183%:%
%:%3321=1183%:%
%:%3322=1184%:%
%:%3323=1184%:%
%:%3324=1184%:%
%:%3325=1185%:%
%:%3326=1185%:%
%:%3327=1186%:%
%:%3328=1186%:%
%:%3329=1186%:%
%:%3330=1187%:%
%:%3331=1187%:%
%:%3332=1187%:%
%:%3333=1188%:%
%:%3334=1188%:%
%:%3335=1188%:%
%:%3336=1189%:%
%:%3337=1189%:%
%:%3338=1189%:%
%:%3339=1190%:%
%:%3340=1190%:%
%:%3341=1190%:%
%:%3342=1191%:%
%:%3343=1191%:%
%:%3344=1192%:%
%:%3345=1192%:%
%:%3346=1192%:%
%:%3347=1193%:%
%:%3348=1193%:%
%:%3349=1194%:%
%:%3350=1194%:%
%:%3351=1194%:%
%:%3352=1195%:%
%:%3353=1195%:%
%:%3354=1196%:%
%:%3355=1196%:%
%:%3356=1196%:%
%:%3357=1197%:%
%:%3358=1197%:%
%:%3359=1198%:%
%:%3360=1198%:%
%:%3361=1199%:%
%:%3362=1199%:%
%:%3363=1200%:%
%:%3364=1200%:%
%:%3365=1201%:%
%:%3371=1201%:%
%:%3374=1202%:%
%:%3375=1203%:%
%:%3376=1203%:%
%:%3377=1204%:%
%:%3384=1205%:%
%:%3385=1205%:%
%:%3386=1206%:%
%:%3387=1206%:%
%:%3388=1207%:%
%:%3389=1208%:%
%:%3390=1209%:%
%:%3391=1209%:%
%:%3392=1209%:%
%:%3393=1210%:%
%:%3394=1211%:%
%:%3395=1211%:%
%:%3396=1212%:%
%:%3397=1213%:%
%:%3398=1214%:%
%:%3399=1214%:%
%:%3400=1214%:%
%:%3401=1215%:%
%:%3402=1216%:%
%:%3403=1216%:%
%:%3404=1217%:%
%:%3405=1217%:%
%:%3406=1218%:%
%:%3407=1218%:%
%:%3408=1219%:%
%:%3409=1219%:%
%:%3410=1220%:%
%:%3411=1220%:%
%:%3412=1221%:%
%:%3413=1221%:%
%:%3414=1222%:%
%:%3415=1222%:%
%:%3416=1223%:%
%:%3417=1224%:%
%:%3418=1224%:%
%:%3419=1225%:%
%:%3420=1225%:%
%:%3421=1226%:%
%:%3422=1226%:%
%:%3423=1227%:%
%:%3424=1227%:%
%:%3425=1228%:%
%:%3426=1228%:%
%:%3427=1229%:%
%:%3428=1229%:%
%:%3429=1230%:%
%:%3430=1231%:%
%:%3431=1231%:%
%:%3432=1232%:%
%:%3433=1232%:%
%:%3434=1233%:%
%:%3435=1234%:%
%:%3436=1234%:%
%:%3437=1235%:%
%:%3438=1235%:%
%:%3439=1235%:%
%:%3440=1236%:%
%:%3441=1236%:%
%:%3442=1237%:%
%:%3443=1237%:%
%:%3444=1237%:%
%:%3445=1238%:%
%:%3446=1238%:%
%:%3447=1239%:%
%:%3448=1239%:%
%:%3449=1239%:%
%:%3450=1240%:%
%:%3451=1240%:%
%:%3452=1240%:%
%:%3453=1241%:%
%:%3454=1241%:%
%:%3455=1241%:%
%:%3456=1242%:%
%:%3457=1242%:%
%:%3458=1242%:%
%:%3459=1243%:%
%:%3460=1243%:%
%:%3461=1243%:%
%:%3462=1244%:%
%:%3463=1244%:%
%:%3464=1245%:%
%:%3465=1245%:%
%:%3466=1245%:%
%:%3467=1246%:%
%:%3468=1246%:%
%:%3469=1247%:%
%:%3470=1247%:%
%:%3471=1247%:%
%:%3472=1248%:%
%:%3473=1248%:%
%:%3474=1248%:%
%:%3475=1249%:%
%:%3476=1249%:%
%:%3477=1249%:%
%:%3478=1250%:%
%:%3479=1250%:%
%:%3480=1251%:%
%:%3481=1251%:%
%:%3482=1251%:%
%:%3483=1252%:%
%:%3484=1252%:%
%:%3485=1253%:%
%:%3486=1253%:%
%:%3487=1253%:%
%:%3488=1254%:%
%:%3489=1254%:%
%:%3490=1255%:%
%:%3491=1255%:%
%:%3492=1255%:%
%:%3493=1256%:%
%:%3494=1256%:%
%:%3495=1257%:%
%:%3496=1257%:%
%:%3497=1257%:%
%:%3498=1258%:%
%:%3499=1258%:%
%:%3500=1259%:%
%:%3501=1259%:%
%:%3502=1259%:%
%:%3503=1260%:%
%:%3504=1260%:%
%:%3505=1261%:%
%:%3506=1261%:%
%:%3507=1261%:%
%:%3508=1262%:%
%:%3509=1262%:%
%:%3510=1263%:%
%:%3511=1263%:%
%:%3512=1263%:%
%:%3513=1263%:%
%:%3514=1263%:%
%:%3515=1264%:%
%:%3516=1264%:%
%:%3517=1265%:%
%:%3518=1265%:%
%:%3519=1266%:%
%:%3520=1266%:%
%:%3521=1267%:%
%:%3522=1267%:%
%:%3523=1268%:%
%:%3524=1268%:%
%:%3525=1269%:%
%:%3526=1269%:%
%:%3527=1270%:%
%:%3528=1270%:%
%:%3529=1271%:%
%:%3530=1271%:%
%:%3531=1272%:%
%:%3532=1272%:%
%:%3533=1273%:%
%:%3534=1273%:%
%:%3535=1274%:%
%:%3536=1275%:%
%:%3537=1275%:%
%:%3538=1276%:%
%:%3539=1276%:%
%:%3540=1277%:%
%:%3541=1278%:%
%:%3542=1278%:%
%:%3543=1279%:%
%:%3544=1279%:%
%:%3545=1279%:%
%:%3546=1280%:%
%:%3547=1280%:%
%:%3548=1280%:%
%:%3549=1281%:%
%:%3550=1281%:%
%:%3551=1281%:%
%:%3552=1282%:%
%:%3553=1282%:%
%:%3554=1283%:%
%:%3555=1283%:%
%:%3556=1283%:%
%:%3557=1284%:%
%:%3558=1284%:%
%:%3559=1285%:%
%:%3560=1285%:%
%:%3561=1285%:%
%:%3562=1286%:%
%:%3563=1286%:%
%:%3564=1287%:%
%:%3565=1287%:%
%:%3566=1287%:%
%:%3567=1288%:%
%:%3568=1288%:%
%:%3569=1288%:%
%:%3570=1289%:%
%:%3571=1289%:%
%:%3572=1289%:%
%:%3573=1290%:%
%:%3574=1290%:%
%:%3575=1291%:%
%:%3576=1291%:%
%:%3577=1291%:%
%:%3578=1292%:%
%:%3579=1292%:%
%:%3580=1292%:%
%:%3581=1293%:%
%:%3582=1293%:%
%:%3583=1293%:%
%:%3584=1294%:%
%:%3585=1294%:%
%:%3586=1295%:%
%:%3587=1295%:%
%:%3588=1295%:%
%:%3589=1296%:%
%:%3590=1296%:%
%:%3591=1296%:%
%:%3592=1297%:%
%:%3593=1297%:%
%:%3594=1297%:%
%:%3595=1298%:%
%:%3596=1298%:%
%:%3597=1299%:%
%:%3598=1299%:%
%:%3599=1299%:%
%:%3600=1300%:%
%:%3601=1300%:%
%:%3602=1301%:%
%:%3603=1301%:%
%:%3604=1301%:%
%:%3605=1302%:%
%:%3606=1302%:%
%:%3607=1303%:%
%:%3608=1303%:%
%:%3609=1303%:%
%:%3610=1304%:%
%:%3611=1304%:%
%:%3612=1305%:%
%:%3613=1305%:%
%:%3614=1305%:%
%:%3615=1305%:%
%:%3616=1305%:%
%:%3617=1306%:%
%:%3618=1306%:%
%:%3619=1307%:%
%:%3620=1307%:%
%:%3621=1308%:%
%:%3622=1308%:%
%:%3623=1309%:%
%:%3624=1309%:%
%:%3625=1310%:%
%:%3631=1310%:%
%:%3634=1311%:%
%:%3635=1312%:%
%:%3636=1312%:%
%:%3637=1313%:%
%:%3638=1314%:%
%:%3645=1315%:%
%:%3646=1315%:%
%:%3647=1316%:%
%:%3648=1316%:%
%:%3649=1317%:%
%:%3650=1317%:%
%:%3651=1317%:%
%:%3652=1318%:%
%:%3653=1318%:%
%:%3654=1319%:%
%:%3655=1319%:%
%:%3656=1319%:%
%:%3657=1320%:%
%:%3658=1320%:%
%:%3659=1321%:%
%:%3660=1321%:%
%:%3661=1322%:%
%:%3662=1322%:%
%:%3663=1323%:%
%:%3664=1323%:%
%:%3665=1323%:%
%:%3666=1324%:%
%:%3667=1324%:%
%:%3668=1325%:%
%:%3669=1325%:%
%:%3670=1325%:%
%:%3671=1326%:%
%:%3672=1327%:%
%:%3673=1327%:%
%:%3674=1328%:%
%:%3675=1328%:%
%:%3676=1329%:%
%:%3677=1329%:%
%:%3678=1330%:%
%:%3679=1330%:%
%:%3680=1331%:%
%:%3681=1331%:%
%:%3682=1332%:%
%:%3683=1332%:%
%:%3684=1333%:%
%:%3685=1333%:%
%:%3686=1334%:%
%:%3687=1334%:%
%:%3688=1335%:%
%:%3689=1335%:%
%:%3690=1336%:%
%:%3691=1336%:%
%:%3692=1336%:%
%:%3693=1337%:%
%:%3694=1337%:%
%:%3695=1337%:%
%:%3696=1338%:%
%:%3697=1338%:%
%:%3698=1338%:%
%:%3699=1339%:%
%:%3700=1339%:%
%:%3701=1339%:%
%:%3702=1340%:%
%:%3703=1340%:%
%:%3704=1341%:%
%:%3705=1341%:%
%:%3706=1341%:%
%:%3707=1342%:%
%:%3708=1342%:%
%:%3709=1343%:%
%:%3710=1343%:%
%:%3711=1343%:%
%:%3712=1344%:%
%:%3713=1344%:%
%:%3714=1345%:%
%:%3715=1345%:%
%:%3716=1345%:%
%:%3717=1346%:%
%:%3718=1346%:%
%:%3719=1346%:%
%:%3720=1347%:%
%:%3721=1347%:%
%:%3722=1347%:%
%:%3723=1348%:%
%:%3724=1348%:%
%:%3725=1348%:%
%:%3726=1349%:%
%:%3727=1349%:%
%:%3728=1349%:%
%:%3729=1350%:%
%:%3730=1350%:%
%:%3731=1351%:%
%:%3732=1351%:%
%:%3733=1352%:%
%:%3734=1352%:%
%:%3735=1353%:%
%:%3736=1354%:%
%:%3737=1354%:%
%:%3738=1355%:%
%:%3739=1355%:%
%:%3740=1356%:%
%:%3741=1356%:%
%:%3742=1357%:%
%:%3743=1357%:%
%:%3744=1358%:%
%:%3745=1358%:%
%:%3746=1359%:%
%:%3747=1359%:%
%:%3748=1360%:%
%:%3749=1360%:%
%:%3750=1361%:%
%:%3751=1361%:%
%:%3752=1362%:%
%:%3753=1362%:%
%:%3754=1363%:%
%:%3755=1363%:%
%:%3756=1363%:%
%:%3757=1364%:%
%:%3758=1364%:%
%:%3759=1364%:%
%:%3760=1365%:%
%:%3761=1365%:%
%:%3762=1365%:%
%:%3763=1366%:%
%:%3764=1366%:%
%:%3765=1366%:%
%:%3766=1367%:%
%:%3767=1367%:%
%:%3768=1368%:%
%:%3769=1368%:%
%:%3770=1368%:%
%:%3771=1369%:%
%:%3772=1369%:%
%:%3773=1370%:%
%:%3774=1370%:%
%:%3775=1370%:%
%:%3776=1371%:%
%:%3777=1371%:%
%:%3778=1372%:%
%:%3779=1372%:%
%:%3780=1372%:%
%:%3781=1373%:%
%:%3782=1373%:%
%:%3783=1373%:%
%:%3784=1374%:%
%:%3785=1374%:%
%:%3786=1374%:%
%:%3787=1375%:%
%:%3788=1375%:%
%:%3789=1375%:%
%:%3790=1376%:%
%:%3791=1376%:%
%:%3792=1376%:%
%:%3793=1377%:%
%:%3794=1377%:%
%:%3795=1378%:%
%:%3796=1378%:%
%:%3797=1379%:%
%:%3798=1379%:%
%:%3799=1380%:%
%:%3800=1380%:%
%:%3801=1381%:%
%:%3802=1381%:%
%:%3803=1382%:%
%:%3809=1382%:%
%:%3812=1383%:%
%:%3813=1384%:%
%:%3814=1384%:%
%:%3815=1385%:%
%:%3816=1386%:%
%:%3819=1387%:%
%:%3823=1387%:%
%:%3824=1387%:%
%:%3829=1387%:%
%:%3832=1388%:%
%:%3833=1389%:%
%:%3834=1389%:%
%:%3835=1390%:%
%:%3836=1391%:%
%:%3839=1392%:%
%:%3843=1392%:%
%:%3844=1392%:%
%:%3849=1392%:%
%:%3852=1393%:%
%:%3853=1394%:%
%:%3854=1394%:%
%:%3855=1395%:%
%:%3856=1396%:%
%:%3859=1397%:%
%:%3863=1397%:%
%:%3864=1397%:%
%:%3865=1397%:%
%:%3870=1397%:%
%:%3873=1398%:%
%:%3874=1399%:%
%:%3875=1399%:%
%:%3876=1400%:%
%:%3877=1401%:%
%:%3880=1402%:%
%:%3884=1402%:%
%:%3885=1402%:%
%:%3890=1402%:%
%:%3893=1403%:%
%:%3894=1404%:%
%:%3895=1404%:%
%:%3896=1405%:%
%:%3897=1406%:%
%:%3900=1407%:%
%:%3904=1407%:%
%:%3905=1407%:%
%:%3914=1409%:%
%:%3916=1410%:%
%:%3917=1410%:%
%:%3918=1411%:%
%:%3919=1412%:%
%:%3920=1413%:%
%:%3921=1413%:%
%:%3922=1414%:%
%:%3929=1415%:%
%:%3930=1415%:%
%:%3931=1416%:%
%:%3932=1416%:%
%:%3933=1417%:%
%:%3934=1418%:%
%:%3935=1419%:%
%:%3936=1419%:%
%:%3937=1420%:%
%:%3938=1420%:%
%:%3939=1421%:%
%:%3940=1421%:%
%:%3941=1422%:%
%:%3942=1422%:%
%:%3943=1423%:%
%:%3944=1423%:%
%:%3945=1423%:%
%:%3946=1423%:%
%:%3947=1424%:%
%:%3948=1424%:%
%:%3949=1424%:%
%:%3950=1425%:%
%:%3951=1425%:%
%:%3952=1425%:%
%:%3953=1425%:%
%:%3954=1426%:%
%:%3955=1426%:%
%:%3956=1426%:%
%:%3957=1427%:%
%:%3958=1427%:%
%:%3959=1428%:%
%:%3960=1428%:%
%:%3961=1429%:%
%:%3962=1429%:%
%:%3963=1430%:%
%:%3964=1430%:%
%:%3965=1431%:%
%:%3966=1431%:%
%:%3967=1432%:%
%:%3968=1432%:%
%:%3969=1433%:%
%:%3970=1433%:%
%:%3971=1434%:%
%:%3972=1434%:%
%:%3973=1435%:%
%:%3974=1435%:%
%:%3975=1436%:%
%:%3976=1436%:%
%:%3977=1437%:%
%:%3978=1437%:%
%:%3979=1438%:%
%:%3980=1438%:%
%:%3981=1439%:%
%:%3982=1439%:%
%:%3983=1440%:%
%:%3984=1440%:%
%:%3987=1443%:%
%:%3988=1444%:%
%:%3989=1444%:%
%:%3990=1445%:%
%:%3991=1445%:%
%:%3992=1446%:%
%:%3993=1446%:%
%:%3994=1447%:%
%:%3995=1447%:%
%:%3996=1447%:%
%:%3997=1448%:%
%:%3998=1448%:%
%:%3999=1448%:%
%:%4000=1449%:%
%:%4001=1450%:%
%:%4002=1450%:%
%:%4003=1451%:%
%:%4004=1451%:%
%:%4005=1451%:%
%:%4006=1452%:%
%:%4007=1452%:%
%:%4008=1453%:%
%:%4009=1454%:%
%:%4010=1454%:%
%:%4011=1455%:%
%:%4012=1455%:%
%:%4013=1456%:%
%:%4014=1457%:%
%:%4015=1457%:%
%:%4016=1457%:%
%:%4017=1458%:%
%:%4018=1458%:%
%:%4019=1458%:%
%:%4020=1459%:%
%:%4021=1460%:%
%:%4022=1460%:%
%:%4023=1461%:%
%:%4024=1461%:%
%:%4025=1461%:%
%:%4026=1462%:%
%:%4027=1463%:%
%:%4028=1463%:%
%:%4029=1464%:%
%:%4030=1464%:%
%:%4031=1464%:%
%:%4032=1465%:%
%:%4033=1466%:%
%:%4034=1466%:%
%:%4035=1467%:%
%:%4036=1467%:%
%:%4037=1467%:%
%:%4038=1467%:%
%:%4039=1467%:%
%:%4040=1468%:%
%:%4041=1468%:%
%:%4042=1469%:%
%:%4043=1469%:%
%:%4044=1470%:%
%:%4045=1471%:%
%:%4046=1471%:%
%:%4047=1472%:%
%:%4048=1472%:%
%:%4049=1473%:%
%:%4050=1474%:%
%:%4051=1474%:%
%:%4052=1474%:%
%:%4053=1475%:%
%:%4054=1475%:%
%:%4055=1475%:%
%:%4056=1476%:%
%:%4057=1477%:%
%:%4058=1477%:%
%:%4059=1478%:%
%:%4060=1478%:%
%:%4061=1478%:%
%:%4062=1479%:%
%:%4063=1480%:%
%:%4064=1480%:%
%:%4065=1481%:%
%:%4066=1481%:%
%:%4067=1481%:%
%:%4068=1482%:%
%:%4069=1483%:%
%:%4070=1483%:%
%:%4071=1484%:%
%:%4072=1484%:%
%:%4073=1484%:%
%:%4074=1484%:%
%:%4075=1484%:%
%:%4076=1485%:%
%:%4077=1485%:%
%:%4078=1486%:%
%:%4079=1486%:%
%:%4080=1487%:%
%:%4081=1488%:%
%:%4082=1488%:%
%:%4083=1488%:%
%:%4084=1489%:%
%:%4085=1489%:%
%:%4086=1489%:%
%:%4087=1490%:%
%:%4088=1491%:%
%:%4089=1491%:%
%:%4090=1491%:%
%:%4091=1492%:%
%:%4092=1492%:%
%:%4093=1493%:%
%:%4094=1493%:%
%:%4095=1494%:%
%:%4096=1494%:%
%:%4097=1495%:%
%:%4098=1495%:%
%:%4099=1496%:%
%:%4100=1496%:%
%:%4101=1497%:%
%:%4102=1497%:%
%:%4103=1498%:%
%:%4104=1498%:%
%:%4105=1499%:%
%:%4106=1500%:%
%:%4107=1500%:%
%:%4108=1501%:%
%:%4109=1501%:%
%:%4110=1502%:%
%:%4111=1502%:%
%:%4112=1503%:%
%:%4113=1503%:%
%:%4114=1503%:%
%:%4115=1504%:%
%:%4116=1504%:%
%:%4117=1504%:%
%:%4118=1505%:%
%:%4119=1505%:%
%:%4120=1505%:%
%:%4121=1506%:%
%:%4122=1506%:%
%:%4123=1506%:%
%:%4124=1507%:%
%:%4125=1507%:%
%:%4126=1508%:%
%:%4127=1508%:%
%:%4128=1509%:%
%:%4129=1509%:%
%:%4130=1509%:%
%:%4131=1510%:%
%:%4132=1510%:%
%:%4133=1510%:%
%:%4134=1511%:%
%:%4135=1511%:%
%:%4136=1512%:%
%:%4137=1512%:%
%:%4138=1513%:%
%:%4139=1513%:%
%:%4140=1514%:%
%:%4141=1514%:%
%:%4142=1515%:%
%:%4143=1515%:%
%:%4144=1515%:%
%:%4145=1516%:%
%:%4146=1516%:%
%:%4147=1516%:%
%:%4148=1517%:%
%:%4149=1517%:%
%:%4150=1517%:%
%:%4151=1518%:%
%:%4152=1518%:%
%:%4153=1518%:%
%:%4154=1519%:%
%:%4155=1519%:%
%:%4156=1519%:%
%:%4157=1520%:%
%:%4158=1520%:%
%:%4159=1520%:%
%:%4160=1521%:%
%:%4161=1521%:%
%:%4162=1521%:%
%:%4163=1522%:%
%:%4164=1522%:%
%:%4165=1522%:%
%:%4166=1523%:%
%:%4167=1523%:%
%:%4168=1524%:%
%:%4169=1524%:%
%:%4170=1524%:%
%:%4171=1525%:%
%:%4172=1525%:%
%:%4173=1525%:%
%:%4174=1526%:%
%:%4175=1526%:%
%:%4176=1526%:%
%:%4177=1527%:%
%:%4178=1527%:%
%:%4179=1527%:%
%:%4180=1528%:%
%:%4181=1528%:%
%:%4182=1528%:%
%:%4183=1529%:%
%:%4184=1529%:%
%:%4185=1530%:%
%:%4186=1530%:%
%:%4187=1531%:%
%:%4188=1531%:%
%:%4189=1532%:%
%:%4190=1532%:%
%:%4191=1532%:%
%:%4192=1533%:%
%:%4193=1533%:%
%:%4194=1533%:%
%:%4195=1534%:%
%:%4196=1534%:%
%:%4197=1535%:%
%:%4198=1535%:%
%:%4199=1535%:%
%:%4200=1536%:%
%:%4201=1536%:%
%:%4202=1536%:%
%:%4203=1537%:%
%:%4204=1537%:%
%:%4205=1537%:%
%:%4206=1538%:%
%:%4207=1538%:%
%:%4208=1538%:%
%:%4209=1539%:%
%:%4210=1539%:%
%:%4211=1539%:%
%:%4212=1540%:%
%:%4213=1540%:%
%:%4214=1540%:%
%:%4215=1541%:%
%:%4216=1541%:%
%:%4217=1541%:%
%:%4218=1542%:%
%:%4219=1542%:%
%:%4220=1542%:%
%:%4221=1543%:%
%:%4222=1543%:%
%:%4223=1544%:%
%:%4224=1544%:%
%:%4225=1544%:%
%:%4226=1545%:%
%:%4227=1545%:%
%:%4228=1545%:%
%:%4229=1546%:%
%:%4230=1546%:%
%:%4231=1546%:%
%:%4232=1547%:%
%:%4233=1547%:%
%:%4234=1547%:%
%:%4235=1548%:%
%:%4236=1548%:%
%:%4237=1548%:%
%:%4238=1549%:%
%:%4239=1549%:%
%:%4240=1550%:%
%:%4241=1550%:%
%:%4242=1551%:%
%:%4243=1551%:%
%:%4244=1552%:%
%:%4245=1552%:%
%:%4246=1553%:%
%:%4247=1553%:%
%:%4248=1553%:%
%:%4249=1554%:%
%:%4250=1554%:%
%:%4251=1554%:%
%:%4252=1555%:%
%:%4253=1555%:%
%:%4254=1556%:%
%:%4255=1556%:%
%:%4256=1557%:%
%:%4257=1557%:%
%:%4258=1558%:%
%:%4259=1558%:%
%:%4260=1559%:%
%:%4261=1559%:%
%:%4262=1559%:%
%:%4263=1560%:%
%:%4264=1560%:%
%:%4265=1560%:%
%:%4266=1561%:%
%:%4267=1561%:%
%:%4268=1562%:%
%:%4269=1562%:%
%:%4270=1563%:%
%:%4271=1563%:%
%:%4272=1564%:%
%:%4273=1564%:%
%:%4274=1565%:%
%:%4275=1565%:%
%:%4276=1565%:%
%:%4277=1565%:%
%:%4278=1566%:%
%:%4279=1566%:%
%:%4280=1566%:%
%:%4281=1567%:%
%:%4282=1567%:%
%:%4283=1567%:%
%:%4284=1568%:%
%:%4285=1568%:%
%:%4286=1568%:%
%:%4287=1569%:%
%:%4288=1569%:%
%:%4289=1569%:%
%:%4290=1570%:%
%:%4291=1570%:%
%:%4292=1571%:%
%:%4293=1572%:%
%:%4294=1573%:%
%:%4295=1573%:%
%:%4296=1574%:%
%:%4297=1575%:%
%:%4298=1575%:%
%:%4299=1576%:%
%:%4300=1576%:%
%:%4301=1577%:%
%:%4302=1577%:%
%:%4303=1578%:%
%:%4304=1578%:%
%:%4305=1579%:%
%:%4306=1579%:%
%:%4307=1580%:%
%:%4308=1580%:%
%:%4309=1580%:%
%:%4310=1581%:%
%:%4311=1581%:%
%:%4312=1582%:%
%:%4313=1582%:%
%:%4314=1582%:%
%:%4315=1583%:%
%:%4316=1583%:%
%:%4317=1584%:%
%:%4318=1584%:%
%:%4319=1584%:%
%:%4320=1585%:%
%:%4321=1585%:%
%:%4322=1586%:%
%:%4323=1586%:%
%:%4324=1586%:%
%:%4325=1587%:%
%:%4326=1587%:%
%:%4327=1588%:%
%:%4328=1588%:%
%:%4329=1588%:%
%:%4330=1589%:%
%:%4331=1589%:%
%:%4332=1589%:%
%:%4333=1590%:%
%:%4334=1590%:%
%:%4335=1590%:%
%:%4336=1591%:%
%:%4337=1591%:%
%:%4338=1592%:%
%:%4339=1592%:%
%:%4340=1592%:%
%:%4341=1593%:%
%:%4342=1593%:%
%:%4343=1594%:%
%:%4344=1594%:%
%:%4345=1594%:%
%:%4346=1595%:%
%:%4347=1595%:%
%:%4348=1596%:%
%:%4349=1596%:%
%:%4350=1596%:%
%:%4351=1597%:%
%:%4352=1597%:%
%:%4353=1597%:%
%:%4354=1598%:%
%:%4355=1598%:%
%:%4356=1598%:%
%:%4357=1598%:%
%:%4358=1598%:%
%:%4359=1599%:%
%:%4360=1599%:%
%:%4361=1600%:%
%:%4362=1600%:%
%:%4363=1601%:%
%:%4364=1601%:%
%:%4365=1602%:%
%:%4366=1602%:%
%:%4367=1603%:%
%:%4368=1603%:%
%:%4369=1604%:%
%:%4370=1604%:%
%:%4371=1604%:%
%:%4372=1605%:%
%:%4373=1605%:%
%:%4374=1606%:%
%:%4375=1606%:%
%:%4376=1606%:%
%:%4377=1607%:%
%:%4378=1607%:%
%:%4379=1608%:%
%:%4380=1608%:%
%:%4381=1608%:%
%:%4382=1609%:%
%:%4383=1609%:%
%:%4384=1610%:%
%:%4385=1610%:%
%:%4386=1610%:%
%:%4387=1611%:%
%:%4388=1611%:%
%:%4389=1612%:%
%:%4390=1612%:%
%:%4391=1612%:%
%:%4392=1613%:%
%:%4393=1613%:%
%:%4394=1613%:%
%:%4395=1614%:%
%:%4396=1614%:%
%:%4397=1614%:%
%:%4398=1615%:%
%:%4399=1615%:%
%:%4400=1616%:%
%:%4401=1616%:%
%:%4402=1616%:%
%:%4403=1617%:%
%:%4404=1617%:%
%:%4405=1618%:%
%:%4406=1618%:%
%:%4407=1618%:%
%:%4408=1619%:%
%:%4409=1619%:%
%:%4410=1620%:%
%:%4411=1620%:%
%:%4412=1620%:%
%:%4413=1621%:%
%:%4414=1621%:%
%:%4415=1621%:%
%:%4416=1622%:%
%:%4417=1622%:%
%:%4418=1622%:%
%:%4419=1622%:%
%:%4420=1622%:%
%:%4421=1623%:%
%:%4422=1623%:%
%:%4423=1624%:%
%:%4424=1624%:%
%:%4425=1625%:%
%:%4426=1625%:%
%:%4427=1625%:%
%:%4428=1626%:%
%:%4429=1626%:%
%:%4430=1626%:%
%:%4431=1627%:%
%:%4432=1627%:%
%:%4433=1627%:%
%:%4434=1628%:%
%:%4435=1628%:%
%:%4436=1629%:%
%:%4437=1629%:%
%:%4438=1629%:%
%:%4439=1630%:%
%:%4440=1630%:%
%:%4441=1631%:%
%:%4442=1631%:%
%:%4443=1631%:%
%:%4444=1632%:%
%:%4445=1632%:%
%:%4446=1633%:%
%:%4447=1633%:%
%:%4448=1633%:%
%:%4449=1634%:%
%:%4450=1634%:%
%:%4451=1634%:%
%:%4452=1635%:%
%:%4458=1635%:%
%:%4463=1636%:%
%:%4468=1637%:%
